"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[601],{902566:function(e,t,r){r.d(t,{WXF:function(){return ap},mvs:function(){return l1},sJB:function(){return l2}});var i=r(135944),n=r(459451),o=r(52359),l=r(491266),a=r(165097),s=r(667294),d=r(721023),c=r(587357),u=r(415861),A=r(202734),p=r(493946),h=r(783965),f=r(823795),g=r(207906),m=r(400295),y=r(353816),b=r(53252),Z=r(386886),v=r(288078),x=r(387918),w=r(467720),C=r(483321),B=r(44347),k=r(918972),E=r(48885),S=r(459334),I=r(256815),F=r(394054),R=r(690629),Q=r(933841),D=r(110315),P=r(169368),M=r(266836),T=r(645843),V=r(957922),z=r(550135),Y=r(267358),G=r(938895),O=r(922797),W=r(441796),H=r(587109),U=r(572882),j=r(890089),$=r(465582),L=r(678385),N=r(598456),X=r(614948),_=r(414564),J=r(690948),K=r(398396),q=r(250456),ee=r(537058),et=r(907504),er=r(884808),ei=r(954776),en=r(264666),eo=r(837645),el=r(6514),ea=r(258951),es=r(621737),ed=r(709974),ec=r(744267),eu=r(762023),eA=r(16628),ep=r(78462),eh=r(370891),ef=r(758826),eg=r(110155),em=r(12963),ey=r(569661),eb=r(40044),eZ=r(474815),ev=r(220764),ex=r(466720),ew=r(622430),eC=r(389250),eB=r(779655),ek=r(629496),eE=r(889572),eS=r(348999),eI=r(382191),eF=r(790912),eR=r(368426),eQ=r(534685),eD=r(479568),eP=r(646761),eM=r(395617),eT=r(872428),eV=r(78763),ez=r(469590),eY=r.n(ez),eG=r(450594),eO=r(140705),eW=r.n(eO),eH=r(951776),eU=r(858176),ej=r(709311),e$=r(121839),eL=r(392339),eN=r(215586),eX=r(926130),e_=r(726730),eJ=r(724519),eK=r(32817),eq=r(840984),e0=r(303414),e1=r(180923),e2=r(143800),e4=r(416937),e5=r(810105),e3=r(120842),e8=r(526426),e6=r(53586),e9=r(50891),e7=r(660403),te=r(82175),tt=r(196540),tr=r(428627),ti=r(794895),tn=r(441899),to=r(608280),tl=r(573460),ta=r(402548),ts=r(463343),td=r(440535),tc=r(454048),tu=r(809980),tA=r.n(tu),tp=r(406137),th=r(232912),tf=r(32512),tg=r(513264),tm=r(973935),ty=r(33703),tb=r(574161),tZ=r(39336),tv=r(573546),tx=r(593619),tw=r(943329),tC=r(914957),tB=r(823508),tk=r(941098),tE=r(682171),tS=r(954364),tI=r(726613),tF=r(307447),tR=r(126783),tQ=r(65823),tD=r(37958),tP=r(640328),tM=r(99045),tT=r(245111),tV=r(177610),tz=r(413970),tY=r(447036),tG=r(644745),tO=r(760265),tW=r(474231),tH=r(370917),tU=r(326),tj=r(819572),t$=r(126215),tL=r(851603),tN=r(942761),tX=r(490512),t_=r(76770),tJ=r.n(t_),tK=r(114689),tq=r(177957),t0=r(532141),t1=r(250336),t2=r(417397),t4=r(191259),t5=r(939828),t3=r(386650),t8=r(983977),t6=r(533586),t9=r(521023),t7=r(603023);let re=s.createContext({breadcrumbs:[],set:e=>{}}),rt=({children:e})=>{let[t,r]=(0,s.useState)([]);return(0,i.tZ)(re.Provider,{value:{breadcrumbs:t,set:e=>{r(e.breadcrumbs)}},children:e})},rr=s.createContext({mode:"light",setMode:e=>{},toggleMode:()=>{}}),ri=rr.Provider;function rn(e){var t;return(t=e.endsWith("/")?e.slice(0,-1):e).startsWith("/")?t.slice(1):t}function ro(e,t){let r;let i=rn(e).split("/");if(i.length%2==0)throw Error(`Collection paths must have an odd number of segments: ${e}`);let n=rl(i);for(let i=0;i<n.length;i++){let o=n[i],l=t&&t.sort((e,t)=>(e.alias??"").localeCompare(t.alias??"")).find(e=>e.alias===o||e.path===o);if(l){if(o===e)r=l;else if(l.subcollections){let t=e.replace(o,"").split("/").slice(2).join("/");t.length>0&&(r=ro(t,l.subcollections))}}if(r)break}return r}function rl(e){let t=e.length>0&&e.length%2==0?e.splice(0,e.length-1):e,r=t.length,i=[];for(let e=r;e>0;e-=2)i.push(t.slice(0,e).join("/"));return i}let ra="100vw",rs="55vw",rd="700px",rc=s.createContext({}),ru=()=>(0,s.useContext)(rc),rA=s.createContext({}),rp=()=>(0,s.useContext)(rA),rh=s.createContext({}),rf=()=>(0,s.useContext)(rh),rg=s.createContext({}),rm=()=>(0,s.useContext)(rg),ry=s.createContext({}),rb=()=>(0,s.useContext)(ry),rZ=s.createContext({}),rv=()=>(0,s.useContext)(rZ),rx=()=>{let{enqueueSnackbar:e,closeSnackbar:t}=(0,ek.Ds)();return{open:(0,s.useCallback)(t=>{let{type:r,message:i,autoHideDuration:n}=t;e({message:i,variant:r,autoHideDuration:n})},[]),close:t}},rw=s.createContext(void 0),rC=()=>(0,s.useContext)(rw),rB=(0,s.createContext)({sideDialogsController:{},sideEntityController:{},navigation:{},dataSource:{},storageSource:{},authController:{},snackbarController:{},fields:{}}),rk=()=>{let e=(0,s.useContext)(rB),t=rf(),r=rm(),i=rb(),n=rp(),o=ru(),l=rv(),a=rx(),d=rC();return{...e,authController:t,sideDialogsController:r,sideEntityController:i,navigation:n,dataSource:o,storageSource:l,snackbarController:a,userConfigPersistence:d}},rE={};function rS({path:e,entityId:t,collection:r,useCache:i=!1}){let n=ru(),o=rp().resolveAliasesFrom(e),l=rk(),[a,d]=(0,s.useState)(),[c,u]=(0,s.useState)(!0),[A,p]=(0,s.useState)();return(0,s.useEffect)(()=>{u(!0);let e=async e=>{if(r.callbacks?.onFetch&&e)try{e=await r.callbacks.onFetch({collection:r,path:o,entity:e,context:l})}catch(e){console.error(e)}rE[`${o}/${t}`]=e,d(e),u(!1),p(void 0)},a=e=>{console.error("ERROR fetching entity",e),u(!1),d(void 0),p(e)};return t&&i&&rE[`${o}/${t}`]?(d(rE[`${o}/${t}`]),u(!1),p(void 0),()=>{}):t&&o&&r?n.listenEntity?n.listenEntity({path:o,entityId:t,collection:r,onUpdate:e,onError:a}):(n.fetchEntity({path:o,entityId:t,collection:r}).then(e).catch(a),()=>{}):(e(void 0),()=>{})},[t,o]),{entity:a,dataLoading:c,dataLoadingError:A}}async function rI({collection:e,path:t,entityId:r,values:i,previousValues:n,status:o,dataSource:l,context:a,onSaveSuccess:s,onSaveFailure:d,onPreSaveHookError:c,onSaveSuccessHookError:u}){let A;let p=a.navigation.resolveAliasesFrom(t),h=e.callbacks;if(h?.onPreSave)try{let l=nU({collection:e,path:t,values:n,entityId:r,fields:a.fields});A=await h.onPreSave({collection:l,path:t,resolvedPath:p,entityId:r,values:i,previousValues:n,status:o,context:a})}catch(e){console.error(e),c&&c(e);return}else A=i;return l.saveEntity({collection:e,path:p,entityId:r,values:A,previousValues:n,status:o}).then(i=>{try{if(h?.onSaveSuccess){let l=nU({collection:e,path:t,values:A,entityId:r,fields:a.fields});h.onSaveSuccess({collection:l,path:t,resolvedPath:p,entityId:i.id,values:A,previousValues:n,status:o,context:a})}}catch(e){u&&u(e)}s&&s(i)}).catch(i=>{if(h?.onSaveFailure){let i=nU({collection:e,path:t,values:A,entityId:r,fields:a.fields});h.onSaveFailure({collection:i,path:t,resolvedPath:p,entityId:r,values:A,previousValues:n,status:o,context:a})}d&&d(i)})}async function rF({dataSource:e,entity:t,collection:r,callbacks:i,onDeleteSuccess:n,onDeleteFailure:o,onPreDeleteHookError:l,onDeleteSuccessHookError:a,context:s}){console.debug("Deleting entity",t.path,t.id);let d={entity:t,collection:r,entityId:t.id,path:t.path,context:s};if(i?.onPreDelete)try{await i.onPreDelete(d)}catch(e){return console.error(e),l&&l(t,e),!1}return e.deleteEntity({entity:t}).then(()=>{n&&n(t);try{return i?.onDelete&&i.onDelete(d),!0}catch(e){return a&&a(t,e),!1}}).catch(e=>(o&&o(t,e),!1))}function rR({property:e,value:t,setValue:r}){let i=(0,s.useRef)(null);(0,s.useEffect)(()=>{"object"==typeof e.disabled&&e.disabled.clearOnDisabled?null!=t&&(i.current=t,r(null)):i.current&&(r(i.current),i.current=null)},[e])}let rQ=()=>(0,s.useContext)(rr),rD=e=>{let{onSuccess:t,onError:r,disableClipboardAPI:i=!1,copiedDuration:n}=e||{},o=(0,s.useRef)(null),[l,a]=(0,s.useState)(!1),[d,c]=(0,s.useState)("");(0,s.useEffect)(()=>{n&&setTimeout(()=>a(!1),n)},[l]);let u=()=>void 0!==navigator.clipboard,A=(0,s.useCallback)(e=>{if(r)r(e);else throw Error(e)},[r]),p=(0,s.useCallback)(e=>{t&&t(e),a(!0),c(e)},[t]),h=(0,s.useCallback)(e=>{navigator.clipboard.writeText(e).then(()=>p(e)).catch(e=>{A(e),a(!1)})},[A,p]),f=(0,s.useCallback)((e="copy",t)=>{let r=o.current,n=r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName),l=o.current;u()&&!i&&(t?h(t):r?n?(h(l.value),"cut"===e&&(l.value="")):h(r.innerText):A("Both the ref & text were undefined"))},[i,h,A]);return{ref:o,isCoppied:l,clipboard:d,clearClipboard:()=>{u()&&navigator.clipboard.writeText("")},isSupported:u,copy:e=>f("copy","object"==typeof e?void 0:e),cut:()=>f("cut")}},rP=()=>(0,s.useContext)(re);function rM(e){let t=rp(),r=rm(),n=(0,s.useCallback)(()=>{if(e.path){let n=e.collection;if(n||(n=t.getCollection(e.path)),!n)throw Error("Not able to resolve the collection in useReferenceDialog");r.open({key:`reference_${e.path}`,component:(0,i.tZ)(lv,{...e,collection:n}),width:"90vw",onClose:()=>{e.onClose?.()}})}else throw Error("useReferenceDialog: You are trying to open a reference dialog, but have not declared the `path`")},[t,e,r]),o=(0,s.useCallback)(()=>{r.close()},[r]);return{open:n,close:o}}let rT=`data:image/png;base64,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
`,rV=(0,J.ZP)(({className:e,...t})=>(0,i.tZ)(d.Z,{...t,classes:{popper:e}}))(({theme:e})=>({[`& .${eS.Z.tooltip}`]:{margin:"0 8px",backgroundColor:e.palette.error.light},[`& .${eS.Z.arrow}`]:{color:e.palette.error.light}}));function rz({title:e,error:t,tooltip:r}){let n=t instanceof Error?t.message:t,o=(0,i.BX)(c.Z,{sx:{display:"flex",alignItems:"center",margin:1},children:[(0,i.tZ)(eE.Z,{fontSize:"small",color:"error"}),(0,i.BX)(c.Z,{sx:{paddingLeft:2},children:[e&&(0,i.tZ)(u.Z,{variant:"body2",sx:{fontWeight:"500"},children:e}),(0,i.tZ)(u.Z,{variant:"body2",children:n})]})]});return r?(0,i.tZ)(rV,{title:r,children:o}):o}class rY{id;path;constructor(e,t){this.id=e,this.path=t}get pathWithId(){return`${this.path}/${this.id}`}}class rG{latitude;longitude;constructor(e,t){this.latitude=e,this.longitude=t}}function rO(){return(0,i.tZ)(c.Z,{sx:{borderRadius:"9999px",backgroundColor:"rgba(128,128,128,0.1)",width:"18px",height:"6px",display:"inline-block"}})}function rW(e){if("tiny"===e)return 40;if("small"===e)return 100;if("regular"===e)return 200;throw Error("Thumbnail size not mapped")}function rH(e){switch(e){case"xs":case"s":return"tiny";case"m":return"small";case"l":case"xl":return"regular";default:throw Error("Missing mapping value in getPreviewSizeFrom")}}function rU({size:e,url:t}){let[r,n]=(0,s.useState)(!1),o=(0,s.useMemo)(()=>rW(e),[e]),l=(0,A.Z)();if("tiny"===e)return(0,i.tZ)("img",{src:t,style:{position:"relative",objectFit:"cover",width:o,height:o,borderRadius:l.shape.borderRadius,maxHeight:"100%"}},"tiny_image_preview_"+t);let a={maxWidth:"100%",maxHeight:"100%",borderRadius:l.shape.borderRadius};return(0,i.BX)(c.Z,{sx:{position:"relative",maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",width:o,height:o},onMouseEnter:()=>n(!0),onMouseMove:()=>n(!0),onMouseLeave:()=>n(!1),children:[(0,i.tZ)("img",{src:t,style:a}),r&&(0,i.BX)(i.HY,{children:[navigator&&(0,i.tZ)(d.Z,{title:"Copy url to clipboard",children:(0,i.tZ)(c.Z,{sx:{borderRadius:"9999px",position:"absolute",bottom:-4,right:32,backgroundColor:l.palette.background.default},children:(0,i.tZ)(p.Z,{size:"small",onClick:e=>(e.stopPropagation(),navigator.clipboard.writeText(t)),children:(0,i.tZ)(tn.Z,{htmlColor:"#666",fontSize:"small"})})})}),(0,i.tZ)(d.Z,{title:"Open image in new tab",children:(0,i.tZ)("a",{style:{borderRadius:"9999px",position:"absolute",bottom:-4,right:-4,backgroundColor:l.palette.background.default},href:t,rel:"noopener noreferrer",target:"_blank",children:(0,i.tZ)(p.Z,{size:"small",onClick:e=>e.stopPropagation(),children:(0,i.tZ)(tc.Z,{htmlColor:"#666",fontSize:"small"})})})})]})]},"image_preview_"+t)}function rj({url:e,previewType:t,size:r,hint:n}){return t?"image"===t?(0,i.tZ)(rU,{url:e,size:r}):"audio"===t?(0,i.BX)("audio",{controls:!0,src:e,children:["Your browser does not support the",(0,i.tZ)("code",{children:"audio"})," element."]}):"video"===t?(0,i.tZ)(h.Z,{sx:{maxWidth:"small"===r?300:500},component:"video",controls:!0,image:e}):(0,i.BX)(c.Z,{component:"a",href:e,rel:"noopener noreferrer",target:"_blank",onClick:e=>e.stopPropagation(),sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:rW(r),height:rW(r)},children:[(0,i.tZ)(td.Z,{sx:{flexGrow:1}}),n&&(0,i.tZ)(d.Z,{title:n,children:(0,i.tZ)(u.Z,{sx:{maxWidth:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl",textAlign:"left"},variant:"caption",children:n})})]}):(0,i.BX)(f.Z,{sx:e=>({display:"flex",wordBreak:"break-word",alignItems:"center",fontWeight:e.typography.fontWeightMedium}),href:e,onMouseDown:e=>{e.preventDefault()},target:"_blank",children:[(0,i.tZ)(tc.Z,{style:{marginRight:8},fontSize:"small"}),e]})}function r$({property:e,size:t}){var r;let n,o,l;return e||console.error("No property assigned for skeleton component",e,t),"string"===e.dataType?n=e.url?function(e,t="regular"){return"boolean"==typeof e.url?(0,i.BX)("div",{style:{display:"flex"},children:[r_(),rX()]}):(0,i.tZ)(c.Z,{sx:{width:rW(t),height:rW(t)},children:r_()})}(e,t):e.storage?rN(t):rX():"array"===e.dataType?e.of&&(n=Array.isArray(e.of)?(0,i.BX)(i.HY,{children:[e.of.map((e,t)=>rL(e,t))," "]}):"map"===e.of.dataType&&e.of.properties?(r=e.of.properties,(o=e.of.previewProperties)&&o.length||(o=Object.keys(r),t&&(o=o.slice(0,3))),(0,i.tZ)(g.Z,{size:"small",children:(0,i.tZ)(m.Z,{children:[0,1,2].map((e,t)=>(0,i.tZ)(y.Z,{children:o&&o.map(e=>(0,i.tZ)(b.Z,{component:"th",children:(0,i.tZ)(r$,{property:r[e],size:"small"})},`table-cell-${e}`))},`table_${e}_${t}`))})})):"string"===e.of.dataType?e.of.enumValues?(0,i.tZ)(Z.ZP,{children:[0,1].map((e,t)=>(0,i.tZ)(i.HY,{children:rX(t)}))}):e.of.storage?rL(e.of):(0,i.tZ)(Z.ZP,{children:[0,1].map((e,t)=>rX(t))}):rL(e.of)):"map"===e.dataType?n=e.properties?("regular"===t?l=Object.keys(e.properties):(l=e.previewProperties||Object.keys(e.properties),"small"===t?l=l.slice(0,3):"tiny"===t&&(l=l.slice(0,1))),"regular"!==t?(0,i.tZ)(c.Z,{sx:e=>({width:"100%",display:"flex",flexDirection:"column","& > *":{[e.breakpoints.down("md")]:{marginBottom:`${e.spacing(.5)} !important`},marginBottom:`${e.spacing(1)} !important`}}),children:l.map((t,r)=>(0,i.tZ)("div",{children:e.properties&&e.properties[t]&&(0,i.tZ)(r$,{property:e.properties[t],size:"small"})},`map_${t}`))}):(0,i.tZ)(g.Z,{size:"small",children:(0,i.tZ)(m.Z,{children:l&&l.map((t,r)=>(0,i.BX)(y.Z,{sx:{"&:last-child th, &:last-child td":{borderBottom:0}},children:[(0,i.tZ)(b.Z,{sx:{verticalAlign:"top"},width:"30%",component:"th",children:(0,i.tZ)(u.Z,{variant:"caption",color:"textSecondary",children:e.properties[t].name})},`table-cell-title--${t}`),(0,i.tZ)(b.Z,{width:"70%",component:"th",children:e.properties&&e.properties[t]&&(0,i.tZ)(r$,{property:e.properties[t],size:"small"})},`table-cell-${t}`)]},`map_preview_table__${r}`))})})):(0,i.tZ)(i.HY,{}):"date"===e.dataType?n=rX():"reference"===e.dataType?n=(0,i.tZ)(v.Z,{variant:"rectangular",width:200,height:100}):(e.dataType,n=rX()),n||null}function rL(e,t=0){return(0,i.tZ)(Z.ZP,{children:[0,1].map((t,r)=>(0,i.tZ)(i.HY,{children:(0,i.tZ)(r$,{property:e,size:"small"},`i_${r}`)}))},"array_index")}function rN(e){let t="tiny"===e?40:"small"===e?100:200;return(0,i.tZ)(v.Z,{variant:"rectangular",sx:e=>({borderRadius:`${e.shape.borderRadius}px`}),width:t,height:t})}function rX(e){return(0,i.tZ)(v.Z,{variant:"text"},`skeleton_${e}`)}function r_(){return(0,i.tZ)(v.Z,{variant:"rectangular",width:24,height:24})}let rJ=s.memo(function({storeUrl:e,storagePathOrDownloadUrl:t,size:r}){var n;let o=rv(),[l,a]=s.useState(rK[t]);if((0,s.useEffect)(()=>{if(!t)return;let e=!1;return o.getDownloadURL(t).then(function(r){e||(a(r),rK[t]=r)}),()=>{e=!0}},[t]),!t)return null;let d=l?.metadata?(n=l?.metadata.contentType).startsWith("image")?"image/*":n.startsWith("video")?"video/*":n.startsWith("audio")?"audio/*":n.startsWith("application")?"application/*":n.startsWith("text")?"text/*":n.startsWith("font")?"font/*":n:void 0,c=d?.startsWith("image")?"image":d?.startsWith("video")?"video":d?.startsWith("audio")?"audio":"file";return l?(0,i.tZ)(rj,{previewType:c,url:l.url,size:r,hint:t}):rN(r)},function(e,t){return e.size===t.size&&e.storagePathOrDownloadUrl===t.storagePathOrDownloadUrl&&e.storeUrl===t.storeUrl}),rK={},rq=new(tA())({html:!0}),r0=s.memo(function({source:e}){let t=(0,s.useMemo)(()=>rq.render("string"==typeof e?e:""),[e]);return(0,i.tZ)("div",{dangerouslySetInnerHTML:{__html:t}})},function(e,t){return e.source===t.source});function r1(e){let t=0,r;for(r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return Math.abs(t)}let r2={blueLighter:{color:"#cfdfff",text:"#102046"},cyanLighter:{color:"#d0f0fd",text:"#04283f"},tealLighter:{color:"#c2f5e9",text:"#012524"},greenLighter:{color:"#d1f7c4",text:"#0b1d05"},yellowLighter:{color:"#ffeab6",text:"#3b2501"},orangeLighter:{color:"#fee2d5",text:"#6b2613"},redLighter:{color:"#ffdce5",text:"#4c0c1c"},pinkLighter:{color:"#ffdaf6",text:"#400832"},purpleLighter:{color:"#ede2fe",text:"#280b42"},grayLighter:{color:"#eee",text:"#040404"},blueLight:{color:"#9cc7ff",text:"#102046"},cyanLight:{color:"#77d1f3",text:"#04283f"},tealLight:{color:"#72ddc3",text:"#012524"},greenLight:{color:"#93e088",text:"#0b1d05"},yellowLight:{color:"#ffd66e",text:"#3b2501"},orangeLight:{color:"#ffa981",text:"#6b2613"},redLight:{color:"#ff9eb7",text:"#4c0c1c"},pinkLight:{color:"#f99de2",text:"#400832"},purpleLight:{color:"#cdb0ff",text:"#280b42"},grayLight:{color:"#ccc",text:"#040404"},blueDark:{color:"#2d7ff9",text:"#fff"},cyanDark:{color:"#18bfff",text:"#fff"},tealDark:{color:"#20d9d2",text:"#fff"},greenDark:{color:"#20c933",text:"#fff"},yellowDark:{color:"#fcb400",text:"#fff"},orangeDark:{color:"#ff6f2c",text:"#fff"},redDark:{color:"#f82b60",text:"#fff"},pinkDark:{color:"#ff08c2",text:"#fff"},purpleDark:{color:"#8b46ff",text:"#fff"},grayDark:{color:"#666",text:"#fff"},blueDarker:{color:"#2750ae",text:"#cfdfff"},cyanDarker:{color:"#0b76b7",text:"#d0f0fd"},tealDarker:{color:"#06a09b",text:"#c2f5e9"},greenDarker:{color:"#338a17",text:"#d1f7c4"},yellowDarker:{color:"#b87503",text:"#ffeab6"},orangeDarker:{color:"#d74d26",text:"#fee2d5"},redDarker:{color:"#ba1e45",text:"#ffdce5"},pinkDarker:{color:"#b2158b",text:"#ffdaf6"},purpleDarker:{color:"#6b1cb0",text:"#ede2fe"},grayDarker:{color:"#444",text:"#eee"}};function r4(e){let t=r1(e),r=Object.keys(r2),i=t%r.length;return r2[r[i]]}function r5(e){return Array.isArray(e)?e:Object.entries(e).map(([e,t])=>"string"==typeof t?{id:e,label:t}:{...t,id:e})}function r3(e,t){if(t)return e.find(e=>e.id===t)}function r8(e){return"object"==typeof e&&e.disabled}function r6({enumValues:e,enumKey:t,small:r}){if(!e)return null;let n=r5(e),o=void 0!==t?r3(n,t):void 0,l=function(e){if(void 0!==e)return"object"==typeof e?e.label:e}(o),a=function(e,t){let r=r3(e,t);if(!r?.color)return r4(t.toString());if("object"==typeof r&&"color"in r){if("string"==typeof r.color)return r2[r.color];if("object"==typeof r.color)return r.color}}(n,t);return(0,i.tZ)(r9,{colorScheme:a,label:void 0!==l?l:t,error:!l,outlined:!1,small:r})}function r9({label:e,colorScheme:t,error:r,outlined:n,small:o}){let l=(0,A.Z)(),a=t??r4(e);return(0,i.tZ)(x.Z,{sx:{maxWidth:"100%",backgroundColor:r||!a?"#eee":a.color,color:r||!a?"red":a.text,fontWeight:l.typography.fontWeightRegular},size:o?"small":"medium",variant:n?"outlined":"filled",label:e})}function r7({propertyKey:e,value:t,property:r,size:n}){if(r.enumValues){let e=nN(r);return(0,i.tZ)(r6,{enumKey:t,enumValues:e.enumValues,small:"regular"!==n})}if(r.previewAsTag){let r=r4(e??"");return(0,i.tZ)(i4,{children:(0,i.tZ)(r9,{colorScheme:r,label:t,small:"regular"!==n})})}if(r.url)return(0,i.tZ)(rj,{size:n,url:t,previewType:"string"==typeof r.url?r.url:void 0});{if(!t)return(0,i.tZ)(i.HY,{});let e=t.split(`
`);return t&&t.includes(`
`)?(0,i.tZ)("div",{children:e.map((t,r)=>(0,i.BX)(s.Fragment,{children:[(0,i.tZ)("span",{children:t}),r!==e.length-1&&(0,i.tZ)("br",{})]},`string_preview_${r}`))}):(0,i.tZ)(i.HY,{children:t})}}function ie({propertyKey:e,value:t,property:r,size:n,entity:o}){let l=rk(),a=n$({propertyKey:e,property:r,propertyValue:t,fields:l.fields});if(Array.isArray(a?.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(a?.dataType!=="array"||!a.of||"map"!==a.of.dataType)throw Error("Picked wrong preview component ArrayOfMapsPreview");let s=a.of,d=s.properties;if(!d)throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${e}`);let c=s.previewProperties;if(!t)return null;let u=c;return u&&u.length||(u=Object.keys(d),n&&(u=u.slice(0,3))),(0,i.tZ)(g.Z,{size:"small",children:(0,i.tZ)(m.Z,{children:t&&t.map((e,t)=>(0,i.tZ)(y.Z,{sx:{"&:last-child th, &:last-child td":{borderBottom:0}},children:u&&u.map(t=>(0,i.tZ)(b.Z,{component:"th",children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:t,value:e[t],property:d[t],entity:o,size:"small"})})},`table-cell-${t}`))},`table_${e}_${t}`))})})}function it({propertyKey:e,value:t,property:r,entity:n,size:o}){let l=rk(),a=n$({propertyKey:e,property:r,propertyValue:t,fields:l.fields});if(!a.of)throw Error(`You need to specify an 'of' prop (or specify a custom field) in your array property ${e}`);if("array"!==a.dataType)throw Error("Picked wrong preview component ArrayPreview");if(!t)return null;let d="regular"===o?"small":"tiny";return(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"column"},children:t&&t.map((r,o)=>{let l=a.resolvedProperties[o]??a.resolvedProperties[o]??(Array.isArray(a.of)?a.of[o]:a.of);return l?(0,i.BX)(s.Fragment,{children:[(0,i.tZ)(c.Z,{sx:{margin:1},children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:e,entity:n,value:r,property:l,size:d})})}),o<t.length-1&&(0,i.tZ)(w.Z,{})]},"preview_array_"+r+"_"+o):null})})}let ir=e=>"light"===e.palette.mode?"rgb(238 238 240)":"rgb(39 39 41)",ii=e=>"light"===e.palette.mode?"rgb(232 232 234)":"rgb(49,49,50)",io=e=>"light"===e.palette.mode?"rgb(224 224 226)":"rgb(47 47 49)",il=e=>"light"===e.palette.mode?"rgb(248 248 249)":"rgb(21 21 23)",ia=s.memo(function({disabled:e,reference:t,previewProperties:r,size:n,onHover:o,onClick:l,allowEntityNavigation:a=!0}){let A;let h=rk(),f=rp(),g=rb(),m=f.getCollection(t.path);if(!m)throw Error(`Couldn't find the corresponding collection view for the path: ${t.path}`);let{entity:y,dataLoading:b,dataLoadingError:Z}=rS({path:t.path,entityId:t.id,collection:m,useCache:!0});y&&id.set(t.pathWithId,y);let x=y??id.get(t.pathWithId),w=(0,s.useMemo)(()=>nU({collection:m,path:t.path,values:x?.values,fields:h.fields}),[m]),C=(0,s.useMemo)(()=>oi(w,h.fields,r,"small"===n||"regular"===n?3:1),[r,w,n]);return w?(t?t instanceof rY?A=x&&!x.values?(0,i.tZ)(rz,{error:"Reference does not exist",tooltip:t.path}):(0,i.BX)(i.HY,{children:[(0,i.BX)(c.Z,{sx:{display:"flex",flexDirection:"column",flexGrow:1,width:"100%",maxWidth:"calc(100% - 52px)",margin:1},children:["tiny"!==n&&(t?(0,i.tZ)(c.Z,{sx:{display:"regular"!==n?"block":void 0,whiteSpace:"regular"!==n?"nowrap":void 0,overflow:"regular"!==n?"hidden":void 0,textOverflow:"regular"!==n?"ellipsis":void 0},children:(0,i.tZ)(u.Z,{variant:"caption",className:"mono",children:t.id})}):(0,i.tZ)(v.Z,{variant:"text"})),C&&C.map(e=>{let t=w.properties[e];return t?(0,i.tZ)(c.Z,{sx:{my:C.length>1?.5:0},children:x?(0,i.tZ)(iF,{propertyKey:e,value:iM(x.values,e),property:t,entity:x,size:"tiny"}):(0,i.tZ)(r$,{property:t,size:"tiny"})},"ref_prev_"+e):null})]}),(0,i.tZ)(c.Z,{sx:{my:"tiny"===n?.5:1},children:!e&&x&&a&&(0,i.tZ)(d.Z,{title:`See details for ${x.id}`,children:(0,i.tZ)(p.Z,{color:"inherit",size:"small",onClick:e=>{e.stopPropagation(),h.onAnalyticsEvent?.("entity_click_from_reference",{path:x.path,entityId:x.id}),g.open({entityId:x.id,path:x.path,collection:w,updateUrl:!0})},children:(0,i.tZ)(tp.Z,{fontSize:"small"})})})})]}):(console.error("Reference preview received value of type",typeof t),A=(0,i.tZ)(rz,{error:"Unexpected value",tooltip:JSON.stringify(t)})):A=(0,i.tZ)(rz,{error:"Reference not set"}),(0,i.tZ)(is,{onClick:e?void 0:l,onHover:e?void 0:o,size:n,children:A})):(0,i.tZ)(rz,{error:"Could not find collection with id "+w})},function(e,t){return e.disabled===t.disabled&&e.size===t.size&&e.onHover===t.onHover&&e.reference?.id===t.reference?.id&&e.reference?.path===t.reference?.path&&e.allowEntityNavigation===t.allowEntityNavigation});function is({children:e,onHover:t,size:r,onClick:n}){return(0,i.tZ)(u.Z,{variant:"label",sx:e=>{let i=n?{tabindex:0,backgroundColor:t?ii(e):ir(e),transition:"background-color 300ms ease, box-shadow 300ms ease",boxShadow:t?"0 0 0 2px rgba(128,128,128,0.05)":void 0,cursor:t?"pointer":void 0}:{};return{width:"100%",display:"flex",borderRadius:`${e.shape.borderRadius}px`,overflow:"hidden",padding:"regular"===r?1:0,itemsAlign:"tiny"===r?"center":void 0,...i}},onClick:e=>{n&&(e.preventDefault(),n())},children:e})}let id=new Map;function ic({propertyKey:e,value:t,property:r,size:n}){let o=rk(),l=n$({propertyKey:e,property:r,propertyValue:t,fields:o.fields});if(Array.isArray(l?.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(l?.dataType!=="array"||!l.of||"reference"!==l.of.dataType)throw Error("Picked wrong preview component ArrayOfReferencesPreview");let a="regular"===n?"small":"tiny";return(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:t&&t.map((t,r)=>{let n=l.of;return(0,i.tZ)(c.Z,{sx:{marginTop:.25,marginBottom:.25,width:"100%"},children:(0,i.tZ)(ia,{disabled:!n.path,previewProperties:n.previewProperties,size:a,reference:t})},`preview_array_ref_${e}_${r}`)})})}let iu="ArrayOfStorageComponentsPreview",iA={arrayWrap:`${iu}-arrayWrap`,arrayItem:`${iu}-arrayItem`},ip=(0,J.ZP)("div")(({theme:e})=>({[`&.${iA.arrayWrap}`]:{display:"flex",flexWrap:"wrap"},[`& .${iA.arrayItem}`]:{margin:e.spacing(.5)}}));function ih({propertyKey:e,entity:t,value:r,property:n,size:o}){let l=rk(),a=n$({propertyKey:e,property:n,propertyValue:r,fields:l.fields});if(Array.isArray(a.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if("array"!==a.dataType||!a.of||"string"!==a.of.dataType)throw Error("Picked wrong preview component ArrayOfStorageComponentsPreview");let s="regular"===o?"small":"tiny";return(0,i.tZ)(ip,{className:iA.arrayWrap,children:r&&r.map((r,n)=>(0,i.tZ)("div",{className:iA.arrayItem,children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:e,value:r,entity:t,property:a.of,size:s})})},`preview_array_storage_${e}_${n}`))})}function ig({name:e,value:t,enumValues:r,size:n}){return(0,i.tZ)(c.Z,{sx:e=>({display:"flex",flexWrap:"wrap",gap:e.spacing(.5)}),children:t&&t.map((t,o)=>(0,i.tZ)(i4,{children:(0,i.tZ)(r6,{enumKey:t,enumValues:r,small:"regular"!==n})},`preview_array_ref_${e}_${o}`))})}function im({propertyKey:e,value:t,property:r,size:n}){if("array"!==r.dataType)throw Error("Picked wrong preview component ArrayEnumPreview");let o=r.of;if(!o.enumValues)throw Error("Picked wrong preview component ArrayEnumPreview");return t?(0,i.tZ)(ig,{name:e,value:t,enumValues:o.enumValues,size:n}):null}function iy({propertyKey:e,value:t,property:r,entity:n,size:o}){let l=rk(),a=n$({propertyKey:e,property:r,propertyValue:t,fields:l.fields});if(Array.isArray(a.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(!a.of||"array"!==a.dataType||"string"!==a.of.dataType)throw Error("Picked wrong preview component ArrayOfStringsPreview");if(t&&!Array.isArray(t))return(0,i.tZ)("div",{children:`Unexpected value: ${t}`});let s=a.of;return(0,i.tZ)(c.Z,{sx:{display:"flex",gap:"2px",flexDirection:"column"},children:t&&t.map((t,r)=>(0,i.tZ)("div",{children:(0,i.tZ)(i4,{children:(0,i.tZ)(r7,{propertyKey:e,property:s,value:t,entity:n,size:o})})},`preview_array_strings_${e}_${r}`))})}let ib="type",iZ="value",iv="ArrayOneOfPreview",ix={array:`${iv}-array`,arrayWrap:`${iv}-arrayWrap`,arrayItemBig:`${iv}-arrayItemBig`},iw=(0,J.ZP)("div")(({theme:e})=>({[`&.${ix.array}`]:{display:"flex",flexDirection:"column"},[`& .${ix.arrayWrap}`]:{display:"flex",flexWrap:"wrap"},[`& .${ix.arrayItemBig}`]:{margin:e.spacing(1)}}));function iC({propertyKey:e,value:t,property:r,size:n,entity:o}){let l=rk(),a=n$({propertyKey:e,property:r,propertyValue:t,fields:l.fields});if(a?.dataType!=="array")throw Error("Picked wrong preview component ArrayPreview");if(!a?.oneOf)throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${e}`);if(!t)return null;let d="regular"===n?"small":"tiny",c=a.oneOf.typeField??ib,u=a.oneOf.valueField??iZ,A=a.oneOf.properties;return(0,i.tZ)(iw,{className:ix.array,children:t&&t.map((r,n)=>(0,i.BX)(s.Fragment,{children:[(0,i.tZ)("div",{className:ix.arrayItemBig,children:(0,i.tZ)(i4,{children:r&&(0,i.tZ)(iF,{propertyKey:e,value:r[u],entity:o,property:a.resolvedProperties[n]??A[r[c]],size:d})})}),n<t.length-1&&(0,i.tZ)(w.Z,{})]},"preview_array_"+r+"_"+n))})}function iB({propertyKey:e,value:t,property:r,entity:n,size:o}){let l;if("map"!==r.dataType)throw Error("Picked wrong preview component MapPropertyPreview");return r.properties?t?("regular"===o?l=Object.keys(r.properties):(l=r.previewProperties||Object.keys(r.properties),"small"===o?l=l.slice(0,3):"tiny"===o&&(l=l.slice(0,1))),"regular"!==o?(0,i.tZ)(c.Z,{sx:e=>({width:"100%",display:"flex",flexDirection:"column","& > *":{[e.breakpoints.down("md")]:{marginBottom:`${e.spacing(.5)} !important`},marginBottom:`${e.spacing(1)} !important`}}),children:l.map((e,l)=>(0,i.tZ)("div",{children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:e,value:t[e],property:r.properties[e],entity:n,size:o})},"map_preview_"+r.name+e+l)},`map_${e}`))}):(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:l&&l.map((e,o)=>(0,i.BX)(c.Z,{sx:e=>({display:"flex",flexDirection:"row",pt:.5,"&:not(:last-child)":{borderBottom:`1px solid ${e.palette.divider}`,pb:.5}}),children:[(0,i.tZ)(c.Z,{sx:{width:"25%",verticalAlign:"top",pr:1},children:(0,i.tZ)(u.Z,{variant:"caption",className:"mono",color:"textSecondary",children:r.properties[e].name})},`table-cell-title-${e}-${e}`),(0,i.tZ)(c.Z,{sx:{flexGrow:1},children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:e,value:t[e],property:r.properties[e],entity:n,size:"small"})})})]},`map_preview_table_${e}}`))})):null:(0,i.tZ)(ik,{value:t})}function ik({value:e}){return"object"!=typeof e?null:(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:Object.entries(e).map(([e,t])=>(0,i.BX)(c.Z,{sx:e=>({display:"flex",flexDirection:"row",pt:.5,"&:not(:last-child)":{borderBottom:`1px solid ${e.palette.divider}`,pb:.5}}),children:[(0,i.tZ)(c.Z,{sx:{width:"25%",verticalAlign:"top",pr:1},children:(0,i.tZ)(u.Z,{variant:"caption",className:"mono",color:"textSecondary",children:e})},`table-cell-title-${e}-${e}`),(0,i.tZ)(c.Z,{sx:{flexGrow:1},children:(0,i.tZ)(u.Z,{variant:"caption",className:"mono",children:(0,i.tZ)(i4,{children:JSON.stringify(t)})})})]},`map_preview_table_${e}}`))})}function iE({date:e}){let t=rk(),r=t?.locale?a[t?.locale]:void 0,n=t?.dateTimeFormat??"MMMM dd, yyyy, HH:mm:ss",o=e?(0,th.Z)(e,n,{locale:r}):"";return(0,i.tZ)(i.HY,{children:o})}function iS({value:e}){return e?(0,i.tZ)(eF.Z,{color:"secondary"}):(0,i.tZ)(eR.Z,{color:"disabled"})}function iI({value:e,property:t,size:r}){if(!t.enumValues)return(0,i.tZ)(i.HY,{children:e});{let n=nX(t.enumValues);return n?(0,i.tZ)(r6,{enumKey:e,enumValues:n,small:"regular"!==r}):(0,i.tZ)(i.HY,{children:e})}}function iF(e){let t;let r=rk(),{property:n,propertyKey:o,value:l,size:a,height:d,width:c,entity:u}=e,A=nj({propertyKey:o,propertyOrBuilder:n,propertyValue:l,fields:r.fields});if(void 0===l||null===A)t=(0,i.tZ)(rO,{});else if(A.Preview)t=(0,s.createElement)(A.Preview,{propertyKey:o,value:l,property:A,size:a,height:d,width:c,entity:u,customProps:A.customProps});else if(null===l)t=(0,i.tZ)(rO,{});else if("string"===A.dataType)"string"==typeof l?A.url?"boolean"==typeof A.url?t=(0,i.tZ)(rj,{size:e.size,url:l}):"string"==typeof A.url&&(t=(0,i.tZ)(rj,{size:e.size,url:l,previewType:A.url})):t=A.storage?(0,i.tZ)(rJ,{storeUrl:A.storage?.storeUrl??!1,size:e.size,storagePathOrDownloadUrl:l}):A.markdown?(0,i.tZ)(r0,{source:l}):(0,i.tZ)(r7,{...e,property:A,value:l}):t=iR(o,A.dataType,l);else if("array"===A.dataType){if(l instanceof Array){if(!A.of&&!A.oneOf)throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${o}`);A.of?t=Array.isArray(A.of)?(0,i.tZ)(it,{...e,value:l,property:A}):"map"===A.of.dataType?(0,i.tZ)(ie,{propertyKey:o,property:A,value:l,entity:u,size:a}):"reference"===A.of.dataType?"string"==typeof A.of.path?(0,i.tZ)(ic,{...e,value:l,property:A}):(0,i.tZ)(rO,{}):"string"===A.of.dataType?A.of.enumValues?(0,i.tZ)(im,{...e,value:l,property:A}):A.of.storage?(0,i.tZ)(ih,{...e,value:l,property:A}):(0,i.tZ)(iy,{...e,value:l,property:A}):"number"===A.of.dataType&&A.of.enumValues?(0,i.tZ)(im,{...e,value:l,property:A}):(0,i.tZ)(it,{...e,value:l,property:A}):A.oneOf&&(t=(0,i.tZ)(iC,{...e,value:l,property:A}))}else t=iR(o,A.dataType,l)}else t="map"===A.dataType?"object"==typeof l?(0,i.tZ)(iB,{...e,property:A}):iR(o,A.dataType,l):"date"===A.dataType?l instanceof Date?(0,i.tZ)(iE,{date:l}):iR(o,A.dataType,l):"reference"===A.dataType?"string"==typeof A.path?l instanceof rY?(0,i.tZ)(ia,{disabled:!A.path,previewProperties:A.previewProperties,size:e.size,onClick:e.onClick,reference:l}):iR(o,A.dataType,l):(0,i.tZ)(rO,{}):"boolean"===A.dataType?"boolean"==typeof l?(0,i.tZ)(iS,{value:l}):iR(o,A.dataType,l):"number"===A.dataType?"number"==typeof l?(0,i.tZ)(iI,{...e,value:l,property:A}):iR(o,A.dataType,l):JSON.stringify(l);return t??(0,i.tZ)(rO,{})}function iR(e,t,r){return console.error(`Unexpected value for property ${e}, of type ${t}`,r),(0,i.tZ)(rz,{title:"Unexpected value",error:`${JSON.stringify(r)}`})}s.memo(function({builder:e}){let[t,r]=(0,s.useState)(!0),[n,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let t=!1;return e.then(e=>{t||(r(!1),o(e))}).catch(e=>{r(!1),console.error(e)}),()=>{t=!0}},[e]),t?(0,i.tZ)(v.Z,{variant:"text"}):(0,i.tZ)(s.Fragment,{children:n})});let iQ=(e,...t)=>({...t.reduce((t,r)=>({...t,[r]:e[r]}),{})});function iD(e){return e&&"object"==typeof e&&!Array.isArray(e)}function iP(e,t){let r=iD(e),i=r?{...e}:e;return r&&iD(t)&&Object.keys(t).forEach(r=>{iD(t[r])&&r in e?i[r]=iP(e[r],t[r]):Object.assign(i,{[r]:t[r]})}),i}function iM(e,t){if(e&&"object"==typeof e){if(t in e)return e[t];if(t.includes(".")){let r=t.split(".");return iM(e[r[0]],r.slice(1).join("."))}}}function iT(e){if(!e)return null;if("object"==typeof e){if("id"in e)return e.id;if(e instanceof Date)return e.toLocaleString();if(e instanceof rG)return eW()(e)}return eW()(e,{ignoreUnknown:!0})}function iV(e){return!!e.readOnly||"date"===e.dataType&&!!e.autoValue||"reference"===e.dataType&&!e.path}function iz(e){return"object"==typeof e.disabled&&!!e.disabled.hidden}function iY(e){return"function"==typeof e}function iG(e){return e?Object.entries(e).map(([e,t])=>{let r=iO(t);return void 0===r?{}:{[e]:r}}).reduce((e,t)=>({...e,...t}),{}):{}}function iO(e){if(!iY(e)){if("map"!==e.dataType||!e.properties)return e.defaultValue?e.defaultValue:iW(e.dataType);{let t=iG(e.properties);return 0===Object.keys(t).length?void 0:t}}}function iW(e){return"string"===e?"":"number"===e?null:"boolean"!==e&&("date"===e?null:"array"===e?[]:"map"===e?{}:null)}function iH(e){return new rY(e.id,e.path)}function iU(e,t){if(e)return"string"==typeof e?e:e(t)}function ij(e=5){return Math.random().toString(36).slice(2,2+e)}function i$(e){return 1===e.length?e[0]:e.reduce((e,t)=>`${e}::${t}`)}function iL(e){return e.split("/").filter((e,t)=>t%2==0)}function iN(e,t,r,i=300){let n=s.useRef(!1),o=s.useCallback(()=>{t(),n.current=!1},[t]),l=s.useRef(void 0);s.useEffect(()=>(n.current=!0,clearTimeout(l.current),l.current=setTimeout(o,i),()=>{r&&o()}),[r,e])}function iX({droppableId:e,addLabel:t,value:r,disabled:n=!1,buildEntry:o,small:l,onInternalIdAdded:a,includeAddButton:d,newDefaultEntry:u,onValueChange:A}){let p=r&&Array.isArray(r)&&r.length>0,h=(0,s.useMemo)(()=>p?r.map((e,t)=>e?{[iT(e)+t]:iK()}:{}).reduce((e,t)=>({...e,...t}),{}):{},[r,p]),f=(0,s.useRef)(h),[g,m]=(0,s.useState)(p?Object.values(f.current):[]);(0,s.useEffect)(()=>{if(p&&r&&r.length!==g.length){let e=r.map((e,t)=>{let r=iT(e)+t;if(r in f.current)return f.current[r];{let e=iK();return f.current[r]=e,e}});m(e)}},[p,g.length,r]);let y=()=>{if(n)return;let e=iK(),t=[...g,e];a&&a(e),m(t),A([...r??[],u])},b=e=>{let t=[...g];t.splice(e,1),m(t),A(r.filter((t,r)=>r!==e))},Z=e=>{let t=iK(),i=r[e],n=[...g.splice(0,e+1),t,...g.splice(e+1,g.length-e-1)];a&&a(t),m(n),A([...r.slice(0,e+1),i,...r.slice(e+1)])};return(0,i.tZ)(tr.Z5,{onDragEnd:e=>{if(!e.destination)return;let t=e.source.index,i=e.destination.index,n=[...g],o=n[t];n[t]=n[i],n[i]=o,m(n),A(function(e,t,r){let i=Array.from(e),[n]=i.splice(t,1);return i.splice(r,0,n),i}(r,t,i))},children:(0,i.tZ)(tr.bK,{droppableId:e,renderClone:(e,t,r)=>{let a=r.source.index,s=g[a];return(0,i.tZ)(i_,{provided:e,internalId:s,index:a,small:l,disabled:n,buildEntry:o,remove:b,copy:Z,isDragging:t.isDragging})},children:(e,r)=>(0,i.BX)("div",{...e.droppableProps,ref:e.innerRef,children:[p&&g.map((e,t)=>(0,i.tZ)(tr._l,{draggableId:`array_field_${e}`,isDragDisabled:n,index:t,children:(r,a)=>(0,i.tZ)(i_,{provided:r,internalId:e,index:t,small:l,disabled:n,buildEntry:o,remove:b,copy:Z,isDragging:a.isDragging})},`array_field_${e}`)),e.placeholder,d&&(0,i.tZ)(c.Z,{p:1,justifyContent:"center",textAlign:"left",children:(0,i.tZ)(C.Z,{variant:l?"text":"outlined",size:l?"small":"large",color:"primary",disabled:n,startIcon:(0,i.tZ)(tt.Z,{}),onClick:y,children:t??"Add"})})]})})})}function i_({provided:e,index:t,internalId:r,small:n,disabled:o,buildEntry:l,remove:a,copy:d,isDragging:u}){let[A,p]=(0,tl.Z)(),h=!n&&p.height>0&&p.height<100,[f,g]=s.useState(!1),m=(0,s.useCallback)(()=>g(!0),[]),y=(0,s.useCallback)(()=>g(!1),[]);return(0,i.tZ)(c.Z,{onMouseEnter:m,onMouseMove:m,onMouseLeave:y,ref:e.innerRef,...e.draggableProps,style:e.draggableProps.style,sx:e=>({backgroundColor:u||f?il(e):void 0,marginBottom:1,borderRadius:`${e.shape.borderRadius}px`,opacity:1}),children:(0,i.BX)(c.Z,{display:"flex",alignItems:"start",children:[(0,i.tZ)(c.Z,{ref:A,flexGrow:1,width:"calc(100% - 48px)",children:l(t,r)}),(0,i.tZ)(iJ,{direction:n?"row":"column",disabled:o,remove:a,index:t,provided:e,contentOverflow:h,copy:d})]})})}function iJ({direction:e,disabled:t,remove:r,index:n,provided:o,copy:l,contentOverflow:a}){let[u,A]=s.useState(null),h=(0,s.useCallback)(e=>{A(e.currentTarget),e.stopPropagation()},[A]),f=(0,s.useCallback)(()=>{A(null)},[A]);return(0,i.BX)(c.Z,{display:"flex",flexDirection:"row"===e?"row-reverse":"column",sx:{pl:1,pt:1},alignItems:"center",children:[(0,i.tZ)("div",{...o.dragHandleProps,children:(0,i.tZ)(d.Z,{placement:"column"===e?"left":void 0,title:"Move",children:(0,i.tZ)(p.Z,{size:"small",disabled:t,sx:{cursor:t?"inherit":"move"},children:(0,i.tZ)(to.Z,{fontSize:"small",color:t?"disabled":"inherit"})})})}),!a&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(d.Z,{title:"Remove",placement:"column"===e?"left":void 0,children:(0,i.tZ)(p.Z,{size:"small","aria-label":"remove",disabled:t,onClick:()=>r(n),children:(0,i.tZ)(ti.Z,{fontSize:"small"})})}),(0,i.tZ)(d.Z,{placement:"column"===e?"left":void 0,title:"Copy in this position",children:(0,i.tZ)(p.Z,{size:"small","aria-label":"copy",disabled:t,onClick:()=>l(n),children:(0,i.tZ)(tn.Z,{fontSize:"small"})})})]}),a&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(p.Z,{onClick:h,size:"small",children:(0,i.tZ)(eQ.Z,{})}),(0,i.BX)(B.Z,{anchorEl:u,open:!!u,onClose:f,elevation:3,children:[(0,i.BX)(k.Z,{dense:!0,onClick:()=>r(n),children:[(0,i.tZ)(E.Z,{children:(0,i.tZ)(ti.Z,{})}),(0,i.tZ)(S.Z,{primary:"Remove"})]}),(0,i.BX)(k.Z,{dense:!0,onClick:()=>l(n),children:[(0,i.tZ)(E.Z,{children:(0,i.tZ)(tn.Z,{})}),(0,i.tZ)(S.Z,{primary:"Copy"})]})]})]})]})}function iK(){return Math.floor(Math.random()*Math.floor(Number.MAX_SAFE_INTEGER))}function iq({name:e,addLabel:t,value:r,disabled:n=!1,buildEntry:o,small:l,onInternalIdAdded:a,includeAddButton:d,newDefaultEntry:c=null}){let u=r&&Array.isArray(r)&&r.length>0,A=(0,s.useMemo)(()=>u?r.map((e,t)=>e?{[iT(e)+t]:iK()}:{}).reduce((e,t)=>({...e,...t}),{}):{},[r,u]),p=(0,s.useRef)(A),[h,f]=(0,s.useState)(u?Object.values(p.current):[]);return(0,s.useEffect)(()=>{if(u&&r&&r.length!==h.length){let e=r.map((e,t)=>{let r=iT(e)+t;if(r in p.current)return p.current[r];{let e=iK();return p.current[r]=e,e}});f(e)}},[u,h.length,r]),(0,i.tZ)(te.F2,{name:e,validateOnChange:!0,render:s=>(0,i.tZ)(i0,{disabled:n,internalIds:h,onInternalIdAdded:a,setInternalIds:f,arrayHelpers:s,newDefaultEntry:c,value:r,name:e,small:l,buildEntry:o,hasValue:u,includeAddButton:d,addLabel:t})})}function i0({disabled:e,internalIds:t,onInternalIdAdded:r,setInternalIds:n,arrayHelpers:o,newDefaultEntry:l,value:a,name:d,small:u,buildEntry:A,hasValue:p,includeAddButton:h,addLabel:f}){let g=(0,s.useCallback)(()=>{if(e)return;let i=iK(),a=[...t,i];r&&r(i),n(a),o.push(l)},[o,e,t,l,r,n]),m=(0,s.useCallback)(e=>{let r=[...t];r.splice(e,1),n(r),o.remove(e)},[o,t,n]),y=(0,s.useCallback)(e=>{let i=iK(),l=a[e],s=[...t.splice(0,e+1),i,...t.splice(e+1,t.length-e-1)];r&&r(i),n(s),o.insert(e+1,l)},[o,t,r,n,a]),b=(0,s.useCallback)(e=>{if(!e.destination)return;let r=e.source.index,i=e.destination.index,l=[...t],a=l[r];l[r]=l[i],l[i]=a,n(l),o.move(r,i)},[o,t,n]);return(0,i.tZ)(tr.Z5,{onDragEnd:b,children:(0,i.tZ)(tr.bK,{droppableId:`droppable_${d}`,renderClone:(r,n,o)=>{let l=o.source.index,a=t[l];return(0,i.tZ)(i_,{provided:r,internalId:a,index:l,small:u,disabled:e,buildEntry:A,remove:m,copy:y,isDragging:n.isDragging})},children:(r,n)=>(0,i.BX)("div",{...r.droppableProps,ref:r.innerRef,children:[p&&t.map((t,r)=>(0,i.tZ)(tr._l,{draggableId:`array_field_${d}_${t}`,isDragDisabled:e,index:r,children:(n,o)=>(0,i.tZ)(i_,{provided:n,internalId:t,index:r,small:u,disabled:e,buildEntry:A,remove:m,copy:y,isDragging:o.isDragging})},`array_field_${d}_${t}`)),r.placeholder,h&&(0,i.tZ)(c.Z,{p:1,justifyContent:"center",textAlign:"left",children:(0,i.tZ)(C.Z,{variant:"outlined",size:"large",color:"primary",disabled:e,startIcon:(0,i.tZ)(tt.Z,{}),onClick:g,children:f??"Add"})})]})})})}function i1({property:e}){let t="object"==typeof e.disabled?e.disabled.disabledMessage:void 0;return(0,i.BX)(c.Z,{display:"flex",children:[(0,i.tZ)(c.Z,{flexGrow:1,children:(0,i.tZ)(I.Z,{children:t||e.description})}),e.longDescription&&(0,i.tZ)(d.Z,{title:(0,i.tZ)(u.Z,{variant:"caption",children:e.longDescription}),placement:"bottom-start",arrow:!0,children:(0,i.tZ)(p.Z,{edge:"start",size:"small",sx:{alignSelf:"flex-start"},children:(0,i.tZ)(ta.Z,{color:"disabled",fontSize:"small"})})})]})}function i2({icon:e,title:t,small:r,sx:n,required:o}){return(0,i.BX)(c.Z,{sx:{display:"inline-flex",marginBottom:"2px",alignItems:"center",gap:r?1:1.5,...n},component:"span",children:[e,(0,i.tZ)(u.Z,{component:"span",sx:{fontWeight:500,fontSize:r?"1rem":".85rem",transformOrigin:"left top",transform:r?"translate(8px, 0px) scale(0.75)":void 0},children:(t??"")+(o?" *":"")})]})}class i4 extends s.Component{constructor(e){super(e),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){console.error(e)}render(){return this.state.error?(0,i.BX)(c.Z,{display:"flex",flexDirection:"column",m:.5,children:[(0,i.BX)(c.Z,{display:"flex",alignItems:"center",m:.5,children:[(0,i.tZ)(eE.Z,{color:"error",fontSize:"small"}),(0,i.tZ)(c.Z,{marginLeft:1,children:"Error"})]}),(0,i.tZ)(u.Z,{variant:"caption",children:this.state.error?.message??"See the error in the console"})]}):this.props.children}}function i5({propertyKey:e,value:t,setValue:r,error:n,showError:o,isSubmitting:l,touched:a,tableMode:s,property:d,includeDescription:c,context:u}){if(!u.entityId)throw Error("ReadOnlyFieldBinding: Entity id is null");let A={id:u.entityId,values:u.values,path:u.path};return(0,i.BX)(F.Z,{fullWidth:!0,error:o,children:[!s&&(0,i.tZ)(I.Z,{filled:!0,children:(0,i.tZ)(i2,{icon:n3(d),required:d.validation?.required,title:d.name})}),(0,i.tZ)(R.Z,{sx:e=>({minHeight:"56px",elevation:0,padding:e.spacing(2),[e.breakpoints.up("md")]:{padding:e.spacing(3)}}),variant:"outlined",children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:e,value:t,property:d,entity:A,size:"regular"})})}),o&&"string"==typeof n&&(0,i.tZ)(I.Z,{error:!0,children:n}),c&&(0,i.tZ)(i1,{property:d})]})}let i3=s.memo(function({propertyKey:e,property:t,context:r,includeDescription:n,underlyingValueHasChanged:o,disabled:l,tableMode:a,partOfArray:s,autoFocus:d,context:{values:c,collection:u,path:A,entityId:p}}){let h=rk(),f=i6(t,h.plugins)?te.gN:te.Rt;return(0,i.tZ)(f,{name:e,children:c=>{let u;let A=nj({propertyKey:e,propertyValue:c.field.value,propertyOrBuilder:t,values:c.form.values,path:r.path,entityId:r.entityId,fields:h.fields});if(null===A||iz(A))return(0,i.tZ)(i.HY,{});if(iV(A))u=i5;else if(A.Field)"function"==typeof A.Field&&(u=A.Field);else{let t=n4(A);if(!t)throw Error(`INTERNAL: Could not find field config for property ${e}`);u=t.Field}return u?(0,i.tZ)(i8,{Component:u,componentProps:{propertyKey:e,property:A,includeDescription:n,underlyingValueHasChanged:o,context:r,disabled:l,tableMode:a,partOfArray:s,autoFocus:d},fieldProps:c}):(0,i.tZ)("div",{children:`Currently the field ${A.dataType} is not supported`})}})},(e,t)=>{let r=iY(e.property)||e.property.fromBuilder,i=iY(t.property)||t.property.fromBuilder;return(r===i||eY()(e.property,t.property))&&e.disabled===t.disabled&&i6(t.property),!1});function i8({Component:e,componentProps:{propertyKey:t,property:r,includeDescription:n,underlyingValueHasChanged:o,tableMode:l,partOfArray:a,autoFocus:d,context:c,disabled:u},fieldProps:A}){var p,h;let f;let{plugins:g}=rk(),m=r.customProps,y=A.field.value,b=A.meta.initialValue,Z=(0,te.u9)(A.form.errors,t),v=(0,te.u9)(A.form.touched,t),x=Z&&(A.form.submitCount>0||r.validation?.unique)&&(!Array.isArray(Z)||!!Z.filter(e=>!!e).length),w=(p=c.path,h=c.collection,(0,s.useRef)((f=null,g&&g.forEach(i=>{let n=n5(r);if(n&&i.form?.fieldBuilder){let o={fieldConfigId:n,propertyKey:t,property:r,Field:e,plugin:i,path:p,collection:h},l=i.form?.fieldBuilderEnabled?.(o);(void 0===l||l)&&(f=i.form.fieldBuilder(o)||f)}n||console.warn("INTERNAL: Field id not found for property",r)}),f)).current??e),C=A.form.isSubmitting;return(0,i.BX)(i4,{children:[(0,i.tZ)(w,{propertyKey:t,value:y,initialValue:b,setValue:(e,r)=>{A.form.setFieldTouched(t,!0,!1),A.form.setFieldValue(t,e,r)},setFieldValue:(e,r,i)=>{A.form.setFieldTouched(t,!0,!1),A.form.setFieldValue(e,r,i)},error:Z,touched:v,showError:x,isSubmitting:C,includeDescription:n??!0,property:r,disabled:u??!1,underlyingValueHasChanged:o??!1,tableMode:l??!1,partOfArray:a??!1,autoFocus:d??!1,customProps:m,context:c}),o&&!C&&(0,i.tZ)(I.Z,{children:"This value has been updated elsewhere"})]})}let i6=(e,t)=>{if(t?.some(e=>e.form?.fieldBuilder)||iY(e))return!0;let r=!!e.Field||"fromBuilder"in e&&e.fromBuilder;return"map"===e.dataType&&e.properties?r||Object.values(e.properties).some(e=>i6(e,t)):"array"===e.dataType&&"resolvedProperties"in e?r||e.resolvedProperties?.some(e=>e&&i6(e,t)):r};function i9({propertyKey:e,value:t,setValue:r,error:n,showError:o,disabled:l,autoFocus:a,touched:d,property:c,includeDescription:u}){let A=c.enumValues;rR({property:c,value:t,setValue:r});let h=(0,s.useCallback)(()=>{r(null)},[r]);return(0,i.BX)(F.Z,{fullWidth:!0,error:o,disabled:l,sx:{"& .MuiInputLabel-root":{mt:.5,ml:.5},"& .MuiInputLabel-shrink":{mt:2}},children:[(0,i.tZ)(Q.Z,{id:`${e}-select-label`,children:(0,i.tZ)(i2,{icon:n3(c),required:c.validation?.required,title:c.name})}),(0,i.tZ)(D.Z,{sx:e=>({minHeight:"64px",borderRadius:`${e.shape.borderRadius}px`}),variant:"filled",labelId:`${e}-select-label`,autoFocus:a,value:t??"",disabled:l,disableUnderline:!0,endAdornment:c.clearable&&(0,i.tZ)(p.Z,{sx:{position:"absolute",top:"12px",right:"32px"},onClick:h,children:(0,i.tZ)(ts.Z,{})}),onChange:e=>{let t=e.target.value,i=t?"number"===c.dataType?parseFloat(t):t:null;return r(i)},renderValue:e=>(0,i.tZ)(r6,{enumKey:e,enumValues:A,small:!1}),children:A&&A.map(t=>(0,i.tZ)(k.Z,{value:t.id,disabled:r8(t),children:(0,i.tZ)(r6,{enumKey:t.id,enumValues:A,small:!0})},`select_${e}_${t.id}`))}),u&&(0,i.tZ)(i1,{property:c}),o&&(0,i.tZ)(I.Z,{error:!0,children:n})]})}function i7({propertyKey:e,value:t,setValue:r,error:n,showError:o,disabled:l,property:a,includeDescription:d,autoFocus:c}){let u=a.of;if(!u)throw Error("Using wrong component ArrayEnumSelect");if(Array.isArray(u))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if("string"!==u.dataType&&"number"!==u.dataType)throw Error("Field misconfiguration: array field of type string or number");let A=u.enumValues;if(!A)throw console.error(a),Error("Field misconfiguration: array field of type string or number needs to have enumValues");rR({property:a,value:t,setValue:r});let h=(0,s.useCallback)(()=>{r(null)},[r]);if(A instanceof Error)return(0,i.tZ)(rz,{error:A.message});let f=!!t&&Array.isArray(t);return(0,i.BX)(F.Z,{fullWidth:!0,required:a.validation?.required,error:o,sx:{"& .MuiInputLabel-root":{mt:.5,ml:.5},"& .MuiInputLabel-shrink":{mt:2}},children:[(0,i.tZ)(Q.Z,{id:`${e}-multiselect-label`,children:(0,i.tZ)(i2,{icon:n3(a),required:a.validation?.required,title:a.name})}),(0,i.tZ)(D.Z,{multiple:!0,sx:e=>({minHeight:"64px",borderRadius:`${e.shape.borderRadius}px`}),variant:"filled",labelId:`${e}-multiselect-label`,value:f?t.map(e=>e.toString()):[],autoFocus:c,disabled:l,disableUnderline:!0,endAdornment:u.clearable&&(0,i.tZ)(p.Z,{sx:{position:"absolute",top:"12px",right:"32px"},onClick:h,children:(0,i.tZ)(ts.Z,{})}),onChange:e=>r(u?.dataType==="number"?e.target.value?e.target.value.map(e=>parseFloat(e)):[]:e.target.value),renderValue:t=>(0,i.tZ)(ig,{value:t,name:e,enumValues:A,size:"regular"}),children:r5(A).map(r=>{let n=r.id,o=f&&t.map(e=>e.toString()).includes(n.toString());return(0,i.BX)(k.Z,{value:n,disabled:r8(r),dense:!0,children:[(0,i.tZ)(P.Z,{checked:o}),(0,i.tZ)(S.Z,{primary:(0,i.tZ)(r6,{enumKey:n,enumValues:A,small:!0})})]},`form-select-${e}-${n}`)})}),d&&(0,i.tZ)(i1,{property:a}),o&&(0,i.tZ)(I.Z,{error:!0,children:n})]})}async function ne(e,t,r,i,n,o,l,a){let s;return"function"==typeof e?(s=await e({path:n,entityId:i,values:r,property:o,file:l,storage:t,propertyKey:a}))||console.warn("Storage callback returned empty result. Using default name value"):s=nt(l,e,i,a,n),s||(s=ij()+"_"+l.name),s}function nt(e,t,r,i,n){let o=e.name.split(".").pop(),l=t.replace("{entityId}",r).replace("{propertyKey}",i).replace("{rand}",ij()).replace("{file}",e.name).replace("{file.type}",e.type).replace("{path}",n);if(o){l=l.replace("{file.ext}",o);let t=e.name.replace(`.${o}`,"");l=l.replace("{file.name}",t)}return l||(l=ij()+"_"+e.name),l}function nr({entityId:e,entityValues:t,path:r,value:i,property:n,propertyKey:o,storageSource:l,disabled:a,onChange:d}){let c="string"===n.dataType?n.storage:"array"===n.dataType&&"string"===n.of.dataType?n.of.storage:void 0,u="array"===n.dataType;if(!c)throw Error("Storage meta must be specified");let A=c?.metadata,p=u?"small":"regular",h=c?.imageCompression,f=(u?i??[]:i?[i]:[]).map(e=>({id:nn(),storagePathOrDownloadUrl:e,metadata:A,size:p})),[g,m]=(0,s.useState)(i),[y,b]=(0,s.useState)(f);(0,s.useEffect)(()=>{eY()(g,i)||(m(i),b(f))},[f,i,g]);let Z=(0,s.useCallback)(async i=>{if(c.fileName){let l=await ne(c.fileName,c,t,e,r,n,i,o);if(!l||0===l.length)throw Error("You need to return a valid filename");return l}return ij()+"_"+i.name},[e,t,r,n,o,c]),v=(0,s.useCallback)(i=>{var l;let a;return"function"==typeof(l=c.storagePath)?(a=l({path:r,entityId:e,values:t,property:n,file:i,storage:c,propertyKey:o}))||console.warn("Storage callback returned empty result. Using default name value"):a=nt(i,l,e,o,r),a||(a=ij()+"_"+i.name),a??"/"},[e,t,r,n,o,c]),x=(0,s.useCallback)(async(e,t,r)=>{let i;console.debug("onFileUploadComplete",e,t);let n=e;c.storeUrl&&(n=(await l.getDownloadURL(e)).url),c.postProcess&&(n=await c.postProcess(n)),t.storagePathOrDownloadUrl=n,t.metadata=r,b(i=ni(i=[...y]));let o=i.filter(e=>!!e.storagePathOrDownloadUrl).map(e=>e.storagePathOrDownloadUrl);d(u?o:o?o[0]:null)},[y,u,d,c,l]),w=(0,s.useCallback)(async e=>{let t;if(e.length&&!a){if(u)t=[...y,...await Promise.all(e.map(async e=>(h&&nl(e)&&(e=await na(e,h)),{id:nn(),file:e,fileName:await Z(e),metadata:A,size:p})))];else{let r=e[0];h&&nl(r)&&(r=await na(r,h)),t=[{id:nn(),file:r,fileName:await Z(r),metadata:A,size:p}]}b(t=ni(t))}},[a,Z,y,A,u,p]);return{internalValue:y,setInternalValue:b,storage:c,fileNameBuilder:Z,storagePathBuilder:v,onFileUploadComplete:x,onFilesAdded:w,multipleFilesSupported:u}}function ni(e){return e.filter((t,r)=>(e.map(e=>e.storagePathOrDownloadUrl).indexOf(t.storagePathOrDownloadUrl)===r||!t.storagePathOrDownloadUrl)&&(e.map(e=>e.file).indexOf(t.file)===r||!t.file))}function nn(){return Math.floor(Math.random()*Math.floor(Number.MAX_SAFE_INTEGER))}let no={"image/jpeg":"JPEG","image/png":"PNG","image/webp":"WEBP"},nl=e=>no[e.type]?no[e.type]:null,na=(e,t)=>new Promise(r=>{let i=void 0===t.quality?100:t.quality,n=i>=0&&i<=100?i:100,o=nl(e);if(!o)throw Error("resizeAndCompressImage: Unsupported image format");tJ().imageFileResizer(e,t.maxWidth||Number.MAX_VALUE,t.maxHeight||Number.MAX_VALUE,o,n,0,e=>r(e),"file")});function ns({storagePath:e,entry:t,metadata:r,onFileUploadComplete:n,imageSize:o,simple:l}){let a=rv(),d=rx(),[u,A]=s.useState(),[p,h]=s.useState(!1),f=s.useRef(!1),g=s.useRef(!1),m=(0,s.useCallback)((i,o)=>{g.current||(g.current=!0,A(void 0),h(!0),a.uploadFile({file:i,fileName:o,path:e,metadata:r}).then(async({path:e})=>{console.debug("Upload successful"),await n(e,t,r),f.current&&h(!1)}).catch(e=>{console.error("Upload error",e),f.current&&(A(e),h(!1),d.open({type:"error",message:"Error uploading file: "+e.message}))}).finally(()=>{g.current=!1}))},[t,r,n,a,e]);return s.useEffect(()=>(f.current=!0,t.file&&m(t.file,t.fileName),()=>{f.current=!1}),[t.file,t.fileName,m]),l?(0,i.tZ)(c.Z,{m:1,sx:{width:o,height:o},children:p&&(0,i.tZ)(v.Z,{variant:"rectangular",sx:{width:o,height:o}})}):(0,i.tZ)(c.Z,{m:1,children:(0,i.BX)(R.Z,{elevation:0,sx:{padding:1,boxSizing:"border-box",minWidth:o,minHeight:o},variant:"outlined",children:[p&&(0,i.tZ)(v.Z,{variant:"rectangular",sx:{width:"100%",height:"100%"}}),u&&(0,i.tZ)(rz,{title:"Error uploading file",error:u})]})})}function nd({name:e,property:t,value:r,entity:n,onRemove:o,disabled:l,size:a}){return(0,i.tZ)(c.Z,{m:1,position:"relative",children:(0,i.BX)(R.Z,{elevation:0,sx:{padding:1,boxSizing:"border-box",minWidth:"regular"===a?220:118,minHeight:"regular"===a?220:118},variant:"outlined",children:[!l&&(0,i.tZ)(c.Z,{sx:e=>({position:"absolute",borderRadius:"9999px",top:-8,right:-8,zIndex:1,backgroundColor:e.palette.background.paper}),children:(0,i.tZ)(d.Z,{title:"Remove",children:(0,i.tZ)(p.Z,{size:"small",onClick:e=>{e.stopPropagation(),o(r)},children:(0,i.tZ)(ti.Z,{fontSize:"small"})})})}),r&&(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:e,value:r,property:t,entity:n,size:a})})]})})}let nc="StorageUploadField",nu={dropZone:`${nc}-dropZone`,disabled:`${nc}-disabled`,nonActiveDrop:`${nc}-nonActiveDrop`,activeDrop:`${nc}-activeDrop`,acceptDrop:`${nc}-acceptDrop`,rejectDrop:`${nc}-rejectDrop`},nA=(0,J.ZP)(c.Z)(({theme:e})=>({[`&.${nu.dropZone}`]:{position:"relative",paddingTop:"2px",border:"2px solid transparent",minHeight:"254px",outline:0,borderRadius:`${e.shape.borderRadius}px`,backgroundColor:ir(e),boxSizing:"border-box",transition:"border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:focus":{border:`2px solid ${e.palette.primary.main}`}},[`&.${nu.disabled}`]:{backgroundColor:"rgba(0, 0, 0, 0.12)",color:"light"===e.palette.mode?"rgba(0, 0, 0, 0.38)":"rgba(255, 255, 255, 0.38)",border:`1px dotted ${e.palette.grey[400]}`},[`&.${nu.nonActiveDrop}`]:{"&:hover":{backgroundColor:ii(e)}},[`&.${nu.activeDrop}`]:{paddingTop:"0px",boxSizing:"border-box",border:"2px solid"},[`&.${nu.acceptDrop}`]:{transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms",background:"repeating-linear-gradient( 45deg, rgba(0, 0, 0, 0.09), rgba(0, 0, 0, 0.09) 10px, rgba(0, 0, 0, 0.12) 10px, rgba(0, 0, 0, 0.12) 20px) !important",border:"2px solid",borderColor:e.palette.success.light},[`&.${nu.rejectDrop}`]:{border:"2px solid",borderColor:e.palette.error.light}}));function np({propertyKey:e,value:t,setValue:r,error:n,showError:o,autoFocus:l,tableMode:a,property:s,includeDescription:d,context:c,isSubmitting:u}){if(!c.entityId)throw Error("StorageUploadFieldBinding: Entity id is null");let A=rv(),p=iV(s)||!!s.disabled||u,{internalValue:h,setInternalValue:f,onFilesAdded:g,storage:m,onFileUploadComplete:y,storagePathBuilder:b,multipleFilesSupported:Z}=nr({entityValues:c.values,entityId:c.entityId,path:c.path,property:s,propertyKey:e,value:t,storageSource:A,disabled:p,onChange:r});rR({property:s,value:t,setValue:r});let v={id:c.entityId,values:c.values,path:c.path};return(0,i.BX)(F.Z,{fullWidth:!0,required:s.validation?.required,error:o,children:[!a&&(0,i.tZ)(I.Z,{filled:!0,children:(0,i.tZ)(i2,{icon:n3(s),required:s.validation?.required,title:s.name})}),(0,i.tZ)(nf,{value:h,name:e,disabled:p,autoFocus:l,property:s,onChange:r,setInternalValue:f,onFilesAdded:g,entity:v,onFileUploadComplete:y,storagePathBuilder:b,storage:m,multipleFilesSupported:Z}),d&&(0,i.tZ)(i1,{property:s}),o&&(0,i.tZ)(I.Z,{error:!0,children:n})]})}function nh({storage:e,disabled:t,isDraggingOver:r,onFilesAdded:n,multipleFilesSupported:o,droppableProvided:l,autoFocus:a,internalValue:s,property:d,entity:A,onClear:p,metadata:h,storagePathBuilder:f,onFileUploadComplete:g,size:m,name:y,helpText:b}){let Z=rx(),{getRootProps:v,getInputProps:x,isDragActive:w,isDragAccept:C,isDragReject:B}=(0,tf.uI)({accept:e.acceptedFiles?e.acceptedFiles.map(e=>({[e]:[]})).reduce((e,t)=>({...e,...t}),{}):void 0,disabled:t||r,noDragEventsBubbling:!0,maxSize:e.maxSize,onDrop:n,onDropRejected:(t,r)=>{for(let r of t)for(let t of r.errors)Z.open({type:"error",message:`Error uploading file: File is larger than ${e.maxSize} bytes`})}});return(0,i.BX)(nA,{...v(),className:(0,tX.Z)(nu.dropZone,{[nu.nonActiveDrop]:!w,[nu.activeDrop]:w,[nu.rejectDrop]:B,[nu.acceptDrop]:C,[nu.disabled]:t}),sx:{display:o&&s.length?void 0:"flex",alignItems:"center"},children:[(0,i.BX)(c.Z,{...l.droppableProps,ref:l.innerRef,sx:{display:"flex",alignItems:"center",overflow:o&&s.length?"auto":void 0,minHeight:o&&s.length?180:250,p:1,"&::-webkit-scrollbar":{display:"none"}},children:[(0,i.tZ)("input",{autoFocus:a,...x()}),s.map((e,r)=>{let n;return e.storagePathOrDownloadUrl?n=(0,i.tZ)(nd,{name:`storage_preview_${e.storagePathOrDownloadUrl}`,property:d,disabled:t,entity:A,value:e.storagePathOrDownloadUrl,onRemove:p,size:e.size}):e.file&&(n=(0,i.tZ)(ns,{entry:e,metadata:h,storagePath:f(e.file),onFileUploadComplete:g,imageSize:"regular"===m?220:118,simple:!1})),(0,i.tZ)(tr._l,{draggableId:`array_field_${y}_${e.id}`,index:r,children:(e,t)=>(0,i.tZ)(c.Z,{ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,style:e.draggableProps.style,sx:e=>({borderRadius:`${e.shape.borderRadius}px`}),children:n})},`array_field_${y}_${e.id}`)}),l.placeholder]}),(0,i.tZ)(c.Z,{sx:{flexGrow:1,minHeight:38,boxSizing:"border-box",m:2},children:(0,i.tZ)(u.Z,{align:"center",variant:"label",children:b})})]})}function nf({property:e,name:t,value:r,setInternalValue:n,onChange:o,multipleFilesSupported:l,onFileUploadComplete:a,disabled:d,onFilesAdded:u,autoFocus:A,storage:p,entity:h,storagePathBuilder:f}){if(l){if(e.of){if(Array.isArray(e.of)||"string"!==e.of.dataType)throw Error("Storage field using array must be of data type string")}else throw Error("Storage field using array must be of data type string")}let g=p?.metadata,m=l?"small":"regular",y=(0,s.useCallback)((e,t)=>{if(!l)return;let i=[...r],a=i[e];i.splice(e,1),i.splice(t,0,a),n(i);let s=i.filter(e=>!!e.storagePathOrDownloadUrl).map(e=>e.storagePathOrDownloadUrl);o(s)},[l,o,n,r]),b=(0,s.useCallback)(e=>{e.destination&&y(e.source.index,e.destination.index)},[y]),Z=(0,s.useCallback)(e=>{if(l){let t=r.filter(t=>t.storagePathOrDownloadUrl!==e);o(t.filter(e=>!!e.storagePathOrDownloadUrl).map(e=>e.storagePathOrDownloadUrl)),n(t)}else o(null),n([])},[r,l,o]),v=l?"Drag 'n' drop some files here, or click to select files":"Drag 'n' drop a file here, or click to select one",x=l?e.of:e;return(0,i.tZ)(tr.Z5,{onDragEnd:b,children:(0,i.tZ)(tr.bK,{droppableId:`droppable_${t}`,direction:"horizontal",renderClone:(e,t,n)=>{let o=r[n.source.index];return(0,i.tZ)(c.Z,{ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,style:e.draggableProps.style,sx:e=>({borderRadius:e.shape.borderRadius}),children:(0,i.tZ)(nd,{name:`storage_preview_${o.storagePathOrDownloadUrl}`,property:x,disabled:!0,entity:h,value:o.storagePathOrDownloadUrl,onRemove:Z,size:o.size})})},children:(e,n)=>(0,i.tZ)(nh,{storage:p,disabled:d,isDraggingOver:n.isDraggingOver,droppableProvided:e,onFilesAdded:u,multipleFilesSupported:l,autoFocus:A,internalValue:r,property:x,entity:h,onClear:Z,metadata:g,storagePathBuilder:f,onFileUploadComplete:a,size:m,name:t,helpText:v})})})}function ng(e){return parseInt(e,10)||0}let nm={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function ny(e){return null==e||0===Object.keys(e).length||0===e.outerHeightStyle&&!e.overflow}let nb=s.forwardRef(function(e,t){let{onChange:r,onScroll:n,onResize:o,maxRows:l,minRows:a=1,style:d,value:c,onFocus:u,onBlur:A,sizeRef:p,...h}=e,{current:f}=s.useRef(null!=c),g=s.useRef(null),m=(0,ty.Z)(t,g),y=s.useRef(null),b=s.useRef(0),[Z,v]=s.useState({outerHeightStyle:0}),x=s.useCallback(()=>{let t=g.current,r=(0,tb.Z)(t).getComputedStyle(t);if("0px"===r.width)return{outerHeightStyle:0};let i=p?.current??y.current,n=y.current;i.style.width=r.width,n.value=t.value||e.placeholder||"x",n.value.slice(-1)===`
`&&(n.value+=" ");let o=r.boxSizing,s=ng(r.paddingBottom)+ng(r.paddingTop),d=ng(r.borderBottomWidth)+ng(r.borderTopWidth),c=i.scrollHeight;n.value="x";let u=i.scrollHeight,A=c;a&&(A=Math.max(Number(a)*u,A)),l&&(A=Math.min(Number(l)*u,A)),A=Math.max(A,u);let h=A+("border-box"===o?s+d:0),f=1>=Math.abs(A-c);return{outerHeightStyle:h,overflow:f}},[l,a,e.placeholder]),w=(e,t)=>{let{outerHeightStyle:r,overflow:i}=t;return b.current<20&&(r>0&&Math.abs((e.outerHeightStyle||0)-r)>1||e.overflow!==i)?(b.current+=1,{overflow:i,outerHeightStyle:r}):e},C=s.useCallback(()=>{let e=x();ny(e)||(o&&o(e),v(t=>w(t,e)))},[x,o]),B=()=>{let e=x();ny(e)||tm.flushSync(()=>{v(t=>w(t,e))})};return s.useEffect(()=>{let e;let t=(0,tZ.Z)(()=>{b.current=0,g.current&&B()}),r=g.current,i=(0,tb.Z)(r);return i.addEventListener("resize",t),"u">typeof ResizeObserver&&(e=new ResizeObserver(t)).observe(r),()=>{t.clear(),i.removeEventListener("resize",t),e&&e.disconnect()}}),(0,tv.Z)(()=>{C()}),s.useEffect(()=>{b.current=0},[c]),(0,i.BX)(s.Fragment,{children:[(0,i.tZ)("textarea",{value:c,onChange:e=>{b.current=0,f||C(),r&&r(e)},ref:m,onFocus:u,onBlur:A,rows:a,style:{height:Z.outerHeightStyle,overflow:Z.overflow?"hidden":void 0,...d},onScroll:n,...h}),(0,i.tZ)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:y,tabIndex:-1,style:{...nm.shadow,...d,padding:0}})]})});function nZ({label:e,small:t,value:r}){return(0,i.BX)(c.Z,{sx:e=>({position:"relative",background:io,borderRadius:`${e.shape.borderRadius}px`,maxWidth:"100%",minHeight:t?"48px":"64px",color:e.palette.text.disabled}),children:[(0,i.tZ)(Q.Z,{shrink:!!r,sx:{position:"absolute",color:e=>e.palette.text.disabled,left:0,top:"4px",pointerEvents:"none"},variant:"filled",children:e}),(0,i.tZ)(c.Z,{sx:{padding:e?"32px 12px 8px 12px":t?"12px":"8px 12px 8px 12px",overflow:"auto"},children:(0,i.tZ)(u.Z,{variant:"body1",sx:{fontFamily:"inherit"},children:r})})]})}function nv({value:e,onChange:t,label:r,inputType:n="text",multiline:o=!1,disabled:l,error:a,endAdornment:d,autoFocus:u,placeholder:A,small:p}){let h=(0,s.useRef)(null),[f,g]=s.useState(document.activeElement===h.current),m=(0,s.useCallback)(e=>{e.target.blur(),e.stopPropagation(),setTimeout(()=>{e.target.focus()},0)},[]);if(l)return(0,i.tZ)(nZ,{label:r,small:p,value:e});let y=o?(0,i.tZ)(nw,{ref:h,placeholder:A,autoFocus:u,onFocus:()=>g(!0),onBlur:()=>g(!1),value:e??"",onChange:t}):(0,i.tZ)(nx,{ref:h,onWheel:"number"===n?m:void 0,sx:{padding:r?"32px 12px 8px 12px":"8px 12px 8px 12px"},small:p??!1,placeholder:A,autoFocus:u,onFocus:()=>g(!0),onBlur:()=>g(!1),type:n,value:Number.isNaN(e)?"":e??"",onChange:t});return(0,i.BX)(c.Z,{sx:e=>({position:"relative",background:ir(e),borderRadius:`${e.shape.borderRadius}px`,maxWidth:"100%",minHeight:p?"48px":"64px","&:hover":{backgroundColor:ii(e)}}),children:[(0,i.tZ)(Q.Z,{shrink:null!=e&&""!==e||f,sx:{position:"absolute",left:0,top:"4px",pointerEvents:"none",color:e=>a?e.palette.error.main:f?e.palette.primary.main:void 0},variant:"filled",children:r}),d?(0,i.BX)(c.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y,(0,i.tZ)(c.Z,{sx:{mr:2,my:1},children:d})]}):y]})}let nx=(0,tg.Z)("input")(({small:e})=>({width:"100%",outlineWidth:0,minHeight:e?"48px":"64px",fontSize:"16px",padding:"32px 12px 8px 12px",font:"inherit",letterSpacing:"inherit",color:"currentcolor",border:"0px",background:"none",height:"1.4375em",margin:"0px",WebkitTapHighlightColor:"transparent",display:"block",minWidth:"0px",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-inner-spin-button":{WebkitAppearance:"none",margin:0}})),nw=(0,tg.Z)(nb)({width:"100%",outlineWidth:0,resize:"none",minHeight:"64px",fontSize:"16px",padding:"32px 12px 8px 12px",font:"inherit",letterSpacing:"inherit",color:"currentcolor",border:"0px",background:"none",height:"1.4375em",margin:"0px",WebkitTapHighlightColor:"transparent",display:"block",minWidth:"0px",animationName:"mui-auto-fill-cancel",animationDuration:"10ms"});function nC({propertyKey:e,value:t,setValue:r,error:n,showError:o,disabled:l,autoFocus:a,property:d,includeDescription:A,allowInfinity:h}){let f,g;"string"===d.dataType&&(f=d.multiline,g=d.url),rR({property:d,value:t,setValue:r});let m=(0,s.useCallback)(()=>{r(null)},[r]),y=!!f,b=(t??("string"===d.dataType?"":0===t?0:""))===1/0,Z=b||"number"!==d.dataType?void 0:"number",v=(0,s.useCallback)(e=>{if(e){if("number"===Z){let t=parseFloat(e);r(t)}else r(e)}else r(null)},[Z,r]);return(0,i.BX)(i.HY,{children:[(0,i.tZ)(nv,{value:t,onChange:e=>{if("number"===Z){let t=e.target.value?parseFloat(e.target.value):void 0;t&&isNaN(t)?r(null):null!=t?r(t):r(null)}else r(e.target.value)},autoFocus:a,label:(0,i.tZ)(i2,{icon:n3(d),required:d.validation?.required,title:d.name}),inputType:Z,multiline:y,disabled:l,endAdornment:d.clearable&&(0,i.tZ)(p.Z,{onClick:m,children:(0,i.tZ)(ts.Z,{})}),error:o?n:void 0}),(o&&n||A&&(d.description||d.longDescription)||h)&&(0,i.BX)(c.Z,{display:"flex",sx:{marginLeft:"14px"},children:[(0,i.BX)(c.Z,{flexGrow:1,children:[o&&(0,i.tZ)(I.Z,{error:!0,children:n}),A&&(0,i.tZ)(i1,{property:d})]}),h&&(0,i.tZ)(M.Z,{checked:b,style:{marginRight:0},labelPlacement:"start",control:(0,i.tZ)(T.Z,{size:"small",type:"checkbox",onChange:e=>{v(e.target.checked?1/0:void 0)}}),disabled:l,label:(0,i.tZ)(u.Z,{variant:"caption",children:"Set value to Infinity"})})]}),g&&(0,i.tZ)(V.Z,{sx:{marginTop:1,marginLeft:1},in:!!t,appear:!0,timeout:500,children:(0,i.tZ)(iF,{value:t,property:d,size:"regular"})})]})}let nB=s.forwardRef(function({value:e,position:t="end",onChange:r,error:n,label:o,autoFocus:l,disabled:a,small:d},c){let[u,A]=(0,s.useState)(l??!1);return(0,i.tZ)(i.HY,{children:(0,i.tZ)(F.Z,{fullWidth:!0,children:(0,i.tZ)(M.Z,{sx:e=>({color:n?e.palette.error.main:u?e.palette.primary.main:e.palette.text.secondary,justifyContent:"space-between",margin:0,width:"100%",minHeight:d?"48px":"64px",paddingLeft:d?"8px":"16px",paddingRight:d?"16px":"24px",boxSizing:"border-box",position:"relative",display:"inline-flex",alignItems:"center",flexDirection:"end"===t?"row-reverse":"row",backgroundColor:ir(e),borderRadius:`${e.shape.borderRadius}px`,transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms","&:hover":{backgroundColor:ii(e)}}),onClick:e=>A(!0),labelPlacement:"start",checked:!!e,inputRef:c,control:(0,i.tZ)(T.Z,{size:d?"small":"medium",type:"checkbox",color:"secondary",autoFocus:l,disabled:a,onFocus:e=>A(!0),onBlur:e=>A(!1),onChange:e=>{A(!0),r?.(e)}}),disabled:a,label:o})})})}),nk=s.forwardRef(function({propertyKey:e,value:t,setValue:r,error:n,showError:o,autoFocus:l,disabled:a,touched:s,property:d,includeDescription:u},A){return rR({property:d,value:t,setValue:r}),(0,i.BX)(i.HY,{children:[(0,i.tZ)(nB,{value:t,onChange:e=>r(e.target.checked),error:o,label:(0,i.tZ)(i2,{icon:n3(d),required:d.validation?.required,title:d.name}),disabled:a,autoFocus:l,small:!1}),(o&&n||u&&(d.description||d.longDescription))&&(0,i.BX)(c.Z,{display:"flex",sx:{marginLeft:"14px"},children:[u&&(0,i.tZ)(i1,{property:d}),o&&(0,i.tZ)(I.Z,{error:!0,children:n})]})]})});function nE({name:e,path:t,disabled:r,value:n,setValue:o,previewProperties:l,forceFilter:a}){let A=rk(),h=rp(),f=rb(),g=(0,s.useMemo)(()=>h.getCollection(t),[t,h]);if(!g)throw Error(`Couldn't find the corresponding collection for the path: ${t}`);let m=n&&n instanceof rY,{entity:y,dataLoading:b,dataLoadingError:Z}=rS({path:t,entityId:m?n.id:void 0,collection:g,useCache:!0}),v=(0,s.useCallback)(e=>{r||o(e?iH(e):null)},[r,o]),x=rM({multiselect:!1,path:t,collection:g,onSingleEntitySelected:v,forceFilter:a}),w=(0,s.useCallback)(()=>{x.open()},[x]),B=(0,s.useCallback)(e=>{e.stopPropagation(),o(null)},[o]),k=(0,s.useCallback)(e=>{e.stopPropagation(),y&&(A.onAnalyticsEvent?.("entity_click_from_reference",{path:y.path,entityId:y.id}),f.open({entityId:y.id,path:t,updateUrl:!0}))},[y,t,f]);return(0,i.tZ)(u.Z,{variant:"label",sx:e=>({elevation:0,width:"100%",padding:e.spacing(1),position:"relative",transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms",borderRadius:`${e.shape.borderRadius}px`,backgroundColor:r?"rgba(0, 0, 0, 0.12)":ir(e),"&:hover":{cursor:r?void 0:"pointer",backgroundColor:r?"rgba(0, 0, 0, 0.12)":ii(e)},color:r?"light"===e.palette.mode?"rgba(0, 0, 0, 0.38)":"rgba(255, 255, 255, 0.38)":void 0,fontWeight:e.typography.fontWeightMedium}),children:g&&(t=>{let o;let a=y&&!y.values;if(t){if(a)o=(0,i.tZ)(d.Z,{title:n&&n.path,children:(0,i.BX)(c.Z,{display:"flex",alignItems:"center",p:1,flexGrow:1,children:[(0,i.tZ)(eE.Z,{fontSize:"small",color:"error"}),(0,i.BX)(c.Z,{marginLeft:1,children:["Missing reference ",y&&y.id]})]})});else if(m){let e=oi(t,A.fields,l,3);o=(0,i.tZ)(c.Z,{display:"flex",flexDirection:"column",flexGrow:1,ml:1,mr:1,children:e&&e.map(e=>{let r=t.properties[e];return r?(0,i.tZ)(c.Z,{mt:.25,mb:.25,children:(0,i.tZ)(i4,{children:y?(0,i.tZ)(iF,{propertyKey:e,value:y.values[e],property:r,entity:y,size:"tiny"}):(0,i.tZ)(r$,{property:r,size:"tiny"})})},`reference_previews_${e}`):null})})}else o=(0,i.BX)(c.Z,{p:1,onClick:r?void 0:w,justifyContent:"center",display:"flex",children:[(0,i.tZ)(u.Z,{variant:"label",sx:e=>({flexGrow:1,textAlign:"center"}),children:"No value set"}),!r&&(0,i.tZ)(C.Z,{variant:"outlined",color:"primary",children:"Set"})]})}else o=(0,i.tZ)(rz,{error:"The specified collection does not exist. Check console"});return(0,i.tZ)(c.Z,{onClick:r?void 0:w,display:"flex",children:(0,i.BX)(c.Z,{display:"flex",flexDirection:"column",flexGrow:1,children:[(0,i.BX)(c.Z,{display:"flex",flexDirection:"row",flexGrow:1,children:[(0,i.tZ)(i2,{icon:(0,i.tZ)(e2.Z,{color:"inherit",fontSize:"inherit"}),sx:{flexGrow:1,color:"text.secondary",ml:1},title:e}),y&&(0,i.tZ)(c.Z,{alignSelf:"center",m:1,children:(0,i.tZ)(d.Z,{title:n&&n.path,children:(0,i.tZ)(u.Z,{variant:"caption",className:"mono",children:y.id})})}),!a&&y&&n&&(0,i.tZ)(c.Z,{children:(0,i.tZ)(d.Z,{title:`See details for ${y.id}`,children:(0,i.tZ)("span",{children:(0,i.tZ)(p.Z,{onClick:k,size:"large",children:(0,i.tZ)(tp.Z,{})})})})}),n&&(0,i.tZ)(c.Z,{children:(0,i.tZ)(d.Z,{title:"Clear",children:(0,i.tZ)("span",{children:(0,i.tZ)(p.Z,{disabled:r,onClick:r?void 0:B,size:"large",children:(0,i.tZ)(ts.Z,{})})})})})]}),o]})})})(g)})}function nS({propertyKey:e,value:t,setValue:r,error:n,showError:o,disabled:l,touched:a,autoFocus:s,property:d,includeDescription:c,context:u}){if(!d.path)throw Error("Property path is required for ReferenceFieldBinding");rR({property:d,value:t,setValue:r});let A=t&&t instanceof rY?t.path:d.path;return(0,i.BX)(F.Z,{error:o,fullWidth:!0,children:[(0,i.tZ)(nE,{name:d.name,path:A,forceFilter:d.forceFilter,previewProperties:d.previewProperties,value:t,disabled:!!d.disabled,setValue:r}),c&&(0,i.tZ)(i1,{property:d}),o&&(0,i.tZ)(I.Z,{error:!0,children:n})]})}let nI=(e,t,r,n)=>{let o=Object.keys(t).filter(e=>!n||!(e in n));return o.length?(0,i.tZ)(c.Z,{m:1,children:(0,i.BX)(F.Z,{fullWidth:!0,children:[(0,i.tZ)(Q.Z,{children:"Add property"}),(0,i.tZ)(D.Z,{variant:"standard",value:"",disabled:e,onChange:e=>{r({...n,[e.target.value]:null})},children:o.map(e=>(0,i.tZ)(k.Z,{value:e,children:t[e].name||e},e))})]})}):(0,i.tZ)(i.HY,{})};function nF({rowId:e,fieldKey:t,value:r,onFieldKeyChange:n,onDeleteClick:o,setValue:l,entryValue:a,dataType:d,updateDataType:A,disabled:h}){let[f,g]=s.useState(null),m=()=>{g(null)};function y(t,n,o){return"string"===o||"number"===o?(0,i.tZ)(nv,{value:t,inputType:"number"===o?"number":"text",small:!0,disabled:h||!n,onChange:e=>{if("number"===o){let t=e.target.value?parseFloat(e.target.value):void 0;t&&isNaN(t)?l({...r,[n]:null}):null!=t?l({...r,[n]:t}):l({...r,[n]:null})}else l({...r,[n]:e.target.value})}},o):"date"===o?(0,i.tZ)(o5,{value:t,small:!0,disabled:h||!n,onChange:e=>{l({...r,[n]:e})}}):"boolean"===o?(0,i.tZ)(nB,{value:t,small:!0,position:"start",disabled:h||!n,onChange:e=>{let t=e.target.checked;l({...r,[n]:t})}}):"array"===o?(0,i.tZ)(c.Z,{sx:e=>({ml:1,pl:1,borderLeft:`1px solid ${e.palette.divider}`}),children:(0,i.tZ)(iX,{value:t,newDefaultEntry:"",droppableId:e.toString(),addLabel:n?`Add to ${n}`:"Add",small:!0,disabled:h||!n,includeAddButton:!0,onValueChange:e=>{l({...r,[n]:e})},buildEntry:(e,o)=>(0,i.tZ)(nR,{index:e,id:o,value:t[e],disabled:h||!n,setValue:i=>{let o=[...t];o[e]=i,l({...r,[n]:o})}})})}):"map"===o?(0,i.tZ)(c.Z,{sx:e=>({ml:1,pl:1,borderLeft:`1px solid ${e.palette.divider}`}),children:(0,i.tZ)(nQ,{value:t,fieldName:n,setValue:e=>{l({...r,[n]:e})}})}):(0,i.tZ)(u.Z,{variant:"caption",children:`Data type ${o} not supported yet`})}function b(t){A(e,t),m()}return(0,i.BX)(i.HY,{children:[(0,i.BX)(u.Z,{component:"div",className:"mono",sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,i.tZ)(c.Z,{sx:{width:"200px",maxWidth:"25%"},children:(0,i.tZ)(nv,{value:t,disabled:h||!!a,small:!0,onChange:e=>{n(e.target.value)}})}),(0,i.tZ)(c.Z,{sx:{flexGrow:1},children:"map"!==d&&"array"!==d&&y(a,t,d)}),(0,i.tZ)(p.Z,{size:"small",sx:e=>({background:e.palette.background.default,height:"28px",width:"28px"}),onClick:e=>{g(e.currentTarget)},children:(0,i.tZ)(tT.Z,{})}),(0,i.tZ)(p.Z,{"aria-label":"delete",size:"small",onClick:o,sx:{height:"28px",width:"28px"},children:(0,i.tZ)(ti.Z,{fontSize:"small"})})]},e.toString()),("map"===d||"array"===d)&&y(a,t,d),(0,i.BX)(B.Z,{anchorEl:f,open:!!f,onClose:m,children:[(0,i.tZ)(k.Z,{dense:!0,onClick:()=>b("string"),children:"string"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>b("number"),children:"number"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>b("boolean"),children:"boolean"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>b("date"),children:"date"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>b("map"),children:"map"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>b("array"),children:"array"})]})]})}function nR({id:e,index:t,value:r,setValue:n}){let[o,l]=(0,s.useState)(nP(r)??"string");function a(e){l(e),h()}let[d,A]=s.useState(null),h=()=>{A(null)};function f(e,t){return"string"===t||"number"===t?(0,i.tZ)(nv,{value:e,inputType:"number"===t?"number":"text",small:!0,onChange:e=>{if("number"===t){let t=e.target.value?parseFloat(e.target.value):void 0;t&&isNaN(t)?n(null):null!=t?n(t):n(null)}else n(e.target.value)}}):"date"===t?(0,i.tZ)(o5,{value:e,small:!0,onChange:e=>{n(e)}}):"boolean"===t?(0,i.tZ)(nB,{value:e,small:!0,position:"start",onChange:e=>{n(e.target.checked)}}):"array"===t?(0,i.tZ)(u.Z,{variant:"caption",children:"Arrays of arrays are not supported."}):"map"===t?(0,i.tZ)(c.Z,{sx:e=>({ml:1,pl:1,borderLeft:`1px solid ${e.palette.divider}`}),children:(0,i.tZ)(nQ,{value:e,setValue:e=>{n(e)}})}):(0,i.tZ)(u.Z,{variant:"caption",children:`Data type ${t} not supported yet`})}return(0,i.BX)(i.HY,{children:[(0,i.BX)(u.Z,{component:"div",className:"mono",sx:{display:"flex",minHeight:"48px",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,i.tZ)(c.Z,{sx:{flexGrow:1},children:"map"!==o&&f(r,o)}),(0,i.tZ)(p.Z,{size:"small",sx:e=>({background:e.palette.background.default,height:"28px",width:"28px"}),onClick:e=>{A(e.currentTarget)},children:(0,i.tZ)(tT.Z,{})})]},e.toString()),"map"===o&&f(r,o),(0,i.BX)(B.Z,{anchorEl:d,open:!!d,onClose:h,children:[(0,i.tZ)(k.Z,{dense:!0,onClick:()=>a("string"),children:"string"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>a("number"),children:"number"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>a("boolean"),children:"boolean"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>a("map"),children:"map"}),(0,i.tZ)(k.Z,{dense:!0,onClick:()=>a("date"),children:"date"})]})]})}function nQ({value:e,setValue:t,fieldName:r,disabled:n}){let[o,l]=s.useState(Object.keys(e??{}).map(t=>[nD(),{key:t,dataType:nP(e[t])??"string"}]));(0,s.useEffect)(()=>{let t=o.map(([e,{key:t}])=>t),r=Object.entries(e??{}).filter(([e,t])=>void 0!==t).map(([e])=>e),i=r.filter(e=>!t.includes(e)),n=t.filter(e=>!r.includes(e)),a=[...o];i.forEach(t=>{a.push([nD(),{key:t,dataType:nP(e[t])??"string"}])}),n.forEach(e=>{let t=a.findIndex(([t,{key:r}])=>r===e);a.splice(t,1)}),l(a)},[e]);let a=s.useRef(e),d=(r,i)=>{if(!r){console.warn("No key selected for data type update");return}l(o.map(e=>e[0]===r?[e[0],{key:e[1].key,dataType:i}]:e)),t({...e,[o.find(e=>e[0]===r)?.[1].key??""]:iW(i)})};return(0,i.BX)(c.Z,{sx:{py:1,display:"flex",flexDirection:"column",gap:1},children:[o.map(([r,{key:s,dataType:c}],u)=>{let A=s?e[s]:"";return(0,i.tZ)(nF,{rowId:r,fieldKey:s,value:e,onDeleteClick:()=>{let i={...e};a.current&&s in a.current?i[s]=void 0:delete i[s],l(o.filter(e=>e[0]!==r)),t({...i})},onFieldKeyChange:i=>{if(l(o.map(e=>e[0]===r?[r,{key:i??"",dataType:e[1].dataType}]:e)),"object"==typeof e&&i in e)return;let n={...e};a.current&&s in a.current?n[s]=void 0:delete n[s],t({...n,[i??""]:A})},setValue:t,entryValue:A,dataType:c,disabled:n,updateDataType:d},r)}),(0,i.tZ)(c.Z,{p:1,justifyContent:"center",textAlign:"left",children:(0,i.tZ)(C.Z,{variant:"text",size:"small",color:"primary",fullWidth:!1,disabled:n,startIcon:(0,i.tZ)(tt.Z,{}),onClick:()=>{t({...e,"":null}),l([...o,[nD(),{key:"",dataType:"string"}]])},children:r?`Add to ${r}`:"Add"})})]})}function nD(){return Math.floor(Math.random()*Math.floor(Number.MAX_SAFE_INTEGER))}function nP(e){return"string"==typeof e?"string":"number"==typeof e?"number":"boolean"==typeof e?"boolean":Array.isArray(e)?"array":e instanceof Date?"date":e instanceof rY?"reference":e instanceof rG?"geopoint":"object"==typeof e?"map":void 0}function nM({title:e,children:t,invisible:r=!1,initiallyExpanded:n=!0,highlightOnHover:o=!1,padding:l=1,dark:a=!0,onExpandedChange:d}){let[c,u]=s.useState(!1),A=(0,s.useCallback)(()=>u(!0),[]),p=(0,s.useCallback)(()=>u(!1),[]),[h,f]=(0,s.useState)(n);return(0,i.BX)(Y.Z,{variant:"outlined",onMouseEnter:A,onMouseMove:A,onMouseLeave:p,disableGutters:!0,expanded:h,sx:e=>({backgroundColor:r?"transparent":a?c&&o?il(e):"transparent":"inherit",borderRadius:r?0:`${e.shape.borderRadius}px`,border:r?"none":void 0,"&::before":{display:"none"}}),TransitionProps:{unmountOnExit:!0},onChange:(0,s.useCallback)((e,t)=>{d?.(t),f(t)},[d]),children:[(0,i.tZ)(G.Z,{expandIcon:(0,i.tZ)(tB.Z,{}),sx:e=>({color:e.palette.text.secondary,padding:r?0:void 0,minHeight:"56px",alignItems:"center",borderTopLeftRadius:`${e.shape.borderRadius}px`,borderTopRightRadius:`${e.shape.borderRadius}px`,borderBottomLeftRadius:h||r?void 0:`${e.shape.borderRadius}px`,borderBottomRightRadius:h||r?void 0:`${e.shape.borderRadius}px`,border:r?"none":void 0,borderBottom:r?`1px solid ${e.palette.divider}`:void 0,"&.Mui-expanded":{borderBottom:`1px solid ${e.palette.divider}`}}),children:e}),(0,i.tZ)(O.Z,{sx:e=>({padding:r?0:"string"==typeof l?l:e.spacing(l),py:e.spacing(2),border:r?"none":void 0,color:"inherit"}),children:t})]})}function nT({name:e,index:t,value:r,typeField:n,valueField:o,properties:l,autoFocus:a,context:d}){let c=r&&r[n],[u,A]=(0,s.useState)(c??void 0),p=(0,te.u6)();(0,s.useEffect)(()=>{c||b(Object.keys(l)[0])},[]),(0,s.useEffect)(()=>{c!==u&&A(c)},[c]);let h=u?l[u]:void 0,f=Object.entries(l).map(([e,t])=>({id:e,label:t.name??e})),g=`${e}.${n}`,m=`${e}.${o}`,y=h?{propertyKey:m,property:h,context:d,autoFocus:a,tableMode:!1}:void 0,b=(0,s.useCallback)(e=>{A(e),p.setFieldTouched(g),p.setFieldValue(g,e),p.setFieldValue(m,h?iO(h):null)},[g,m]);return(0,i.BX)(R.Z,{sx:e=>({background:"transparent",padding:e.spacing(1),my:1,py:2}),elevation:0,children:[(0,i.tZ)(te.Rt,{required:!0,name:g,children:r=>(0,i.BX)(F.Z,{fullWidth:!0,size:"small",children:[(0,i.tZ)(Q.Z,{id:`${e}_${t}_select_label`,children:(0,i.tZ)("span",{children:"Type"})}),(0,i.tZ)(D.Z,{fullWidth:!0,sx:{marginBottom:2},labelId:`${e}_${t}_select_label`,label:"Type",value:void 0!==r.field.value&&null!==r.field.value?r.field.value:"",onChange:e=>{let t=e.target.value;b(t)},renderValue:e=>(0,i.tZ)(r6,{enumKey:e,enumValues:f,small:!0}),children:f.map(r=>{let n=r.id;return(0,i.tZ)(k.Z,{value:n,children:(0,i.tZ)(r6,{enumKey:n,enumValues:f,small:!0})},`select_${e}_${t}_${n}`)})})]})}),y&&(0,i.tZ)(F.Z,{fullWidth:!0,children:(0,i.tZ)(i3,{...y})},`form_control_${e}_${u}`)]})}let nV=new(tA());tV.ZP.use(tV.Vn.AutoResize,{min:100}),tV.ZP.unuse(tV.Vn.FontUnderline),tV.ZP.unuse(tV.Vn.Clear);let nz=(0,J.ZP)(F.Z)(({theme:e})=>`
  @font-face {
    font-family: rmel-iconfont;
    src: url(data:application/vnd.ms-fontobject;base64,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NS4BJyMOAd0VGwEBGxWRFRsbFWEcFBQcYRUbGxWRFRsBARsCK2EVGxsVkRUbAQEbKRySARsVYRwpGwEBGxWRFRsBHwEbFZEVGwEBGykcYRUbwwEbFWEcKRsBARsVkRUb/qscKRsBARsVkRUbGxUBtRQcYRUbGxWRFRsBARsAAAAAAAASAN4AAQAAAAAAAAAVAAAAAQAAAAAAAQANABUAAQAAAAAAAgAHACIAAQAAAAAAAwANACkAAQAAAAAABAANADYAAQAAAAAABQALAEMAAQAAAAAABgANAE4AAQAAAAAACgArAFsAAQAAAAAACwATAIYAAwABBAkAAAAqAJkAAwABBAkAAQAaAMMAAwABBAkAAgAOAN0AAwABBAkAAwAaAOsAAwABBAkABAAaAQUAAwABBAkABQAWAR8AAwABBAkABgAaATUAAwABBAkACgBWAU8AAwABBAkACwAmAaUKQ3JlYXRlZCBieSBpY29uZm9udApybWVsLWljb25mb250UmVndWxhcnJtZWwtaWNvbmZvbnRybWVsLWljb25mb250VmVyc2lvbiAxLjBybWVsLWljb25mb250R2VuZXJhdGVkIGJ5IHN2ZzJ0dGYgZnJvbSBGb250ZWxsbyBwcm9qZWN0Lmh0dHA6Ly9mb250ZWxsby5jb20ACgBDAHIAZQBhAHQAZQBkACAAYgB5ACAAaQBjAG8AbgBmAG8AbgB0AAoAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABSAGUAZwB1AGwAYQByAHIAbQBlAGwALQBpAGMAbwBuAGYAbwBuAHQAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABWAGUAcgBzAGkAbwBuACAAMQAuADAAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABHAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAHMAdgBnADIAdAB0AGYAIABmAHIAbwBtACAARgBvAG4AdABlAGwAbABvACAAcAByAG8AagBlAGMAdAAuAGgAdAB0AHAAOgAvAC8AZgBvAG4AdABlAGwAbABvAC4AYwBvAG0AAAAAAgAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwADdGFiCGtleWJvYXJkBmRlbGV0ZQpjb2RlLWJsb2NrBGNvZGUKdmlzaWJpbGl0eQp2aWV3LXNwbGl0BGxpbmsEcmVkbwR1bmRvBGJvbGQGaXRhbGljDGxpc3Qtb3JkZXJlZA5saXN0LXVub3JkZXJlZAVxdW90ZQ1zdHJpa2V0aHJvdWdoCXVuZGVybGluZQR3cmFwCWZvbnQtc2l6ZQRncmlkBWltYWdlC2V4cGFuZC1sZXNzC2V4cGFuZC1tb3JlD2Z1bGxzY3JlZW4tZXhpdApmdWxsc2NyZWVuAAAAAAA=);
    src: url(data:font/ttf;base64,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) format("truetype")
  }

  .rmel-iconfont {
    font-family: rmel-iconfont !important;
    font-size: 16px;
    font-style: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale
  }

  .rmel-icon-tab:before {
    content: "\\e76d"
  }

  .rmel-icon-keyboard:before {
    content: "\\ed80"
  }

  .rmel-icon-delete:before {
    content: "\\ed3c"
  }

  .rmel-icon-code-block:before {
    content: "\\e941"
  }

  .rmel-icon-code:before {
    content: "\\ed3b"
  }

  .rmel-icon-visibility:before {
    content: "\\ed44"
  }

  .rmel-icon-view-split:before {
    content: "\\ed45"
  }

  .rmel-icon-link:before {
    content: "\\ed5f"
  }

  .rmel-icon-redo:before {
    content: "\\ed60"
  }

  .rmel-icon-undo:before {
    content: "\\ed61"
  }

  .rmel-icon-bold:before {
    content: "\\ed6f"
  }

  .rmel-icon-italic:before {
    content: "\\ed70"
  }

  .rmel-icon-list-ordered:before {
    content: "\\ed71"
  }

  .rmel-icon-list-unordered:before {
    content: "\\ed72"
  }

  .rmel-icon-quote:before {
    content: "\\ed73"
  }

  .rmel-icon-strikethrough:before {
    content: "\\ed74"
  }

  .rmel-icon-underline:before {
    content: "\\ed75"
  }

  .rmel-icon-wrap:before {
    content: "\\ed77"
  }

  .rmel-icon-font-size:before {
    content: "\\ed78"
  }

  .rmel-icon-grid:before {
    content: "\\ed8c"
  }

  .rmel-icon-image:before {
    content: "\\ed8d"
  }

  .rmel-icon-expand-less:before {
    content: "\\ed9f"
  }

  .rmel-icon-expand-more:before {
    content: "\\eda0"
  }

  .rmel-icon-fullscreen-exit:before {
    content: "\\eda1"
  }

  .rmel-icon-fullscreen:before {
    content: "\\eda2"
  }

  .rc-md-editor {
    padding-bottom: 1px;
    position: relative;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    overflow: hidden;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -webkit-flex-direction: column;
    -ms-flex-direction: column;
    flex-direction: column;
            border-radius: 6px;
            background-color: ${ir(e)};
  }

  .rc-md-editor.full {
    width: 100%;
    height: 100% !important;
    position: fixed;
    left: 0;
    top: 0;
    z-index: 1000
  }

  .rc-md-editor .editor-container {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    width: 100%;
    min-height: 0;
    position: relative;
                background-color: ${ir(e)};

  }

  .rc-md-editor .editor-container > .section {
    -webkit-box-flex: 1;
    -webkit-flex-grow: 1;
    -ms-flex-positive: 1;
    flex-grow: 1;
    -webkit-flex-shrink: 1;
    -ms-flex-negative: 1;
    flex-shrink: 1;
    -webkit-flex-basis: 1px;
    -ms-flex-preferred-size: 1px;
    flex-basis: 1px;
    padding: 4px;
    
            border: none
  }

  .rc-md-editor .editor-container > .section.in-visible {
    display: none
  }

  .rc-md-editor .editor-container > .section > .section-container {
    padding: 8x 16px 16px
  }
  
  .rc-md-editor .editor-container > .section:last-child {
    border-radius: unset
  }

  .rc-md-editor .editor-container .sec-md {
    min-height: 0;
    min-width: 0
  }

  .rc-md-editor .editor-container .sec-md .input {
    display: block;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    overflow-y: scroll;
    border: none;
    resize: none;
    outline: none;
    min-height: 0;
    color: inherit;
    font-size: 14px;
    line-height: 1.7;   
             background-color: ${ir(e)};

  }

  .rc-md-editor .editor-container .sec-html {
    min-height: 0;
    min-width: 0;         
       background-color: ${ir(e)};

  }

  .rc-md-editor .editor-container .sec-html .html-wrap {
    height: 100%;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    overflow: auto
  }

  .custom-html-style {
    color: inherit
  }

  .custom-html-style h1 {
    font-size: 32px;
    padding: 0;
    border: none;
    font-weight: 700;
    margin: 32px 0;
    line-height: 1.2
  }

  .custom-html-style h2 {
    font-size: 24px;
    padding: 0;
    border: none;
    font-weight: 700;
    margin: 24px 0;
    line-height: 1.7
  }

  .custom-html-style h3 {
    font-size: 18px;
    margin: 18px 0;
    padding: 0;
    line-height: 1.7;
    border: none
  }

  .custom-html-style p {
    font-size: 14px;
    line-height: 1.7;
    margin: 8px 0
  }

  .custom-html-style a {
    color: ${(0,W._j)(e.palette.text.secondary,0)}
  }

  .custom-html-style a:hover {
    text-decoration: none
  }

  .custom-html-style strong {
    font-weight: 700
  }

  .custom-html-style ol, .custom-html-style ul {
    font-size: 14px;
    line-height: 28px;
    padding-left: 36px
  }

  .custom-html-style li {
    margin-bottom: 8px;
    line-height: 1.7
  }

  .custom-html-style hr {
    margin-top: 20px;
    margin-bottom: 20px;
    border: 0;
    border-top: 1px solid ${e.palette.divider}
  }

  .custom-html-style pre {
    display: block;
    padding: 20px;
    line-height: 28px;
    word-break: break-word
  }

  .custom-html-style code, .custom-html-style pre {
    background-color: ${(0,W._j)(e.palette.background.default,.1)};
    font-size: 14px;
    border-radius: 0;
    overflow-x: auto
  }

  .custom-html-style code {
    padding: 3px 0;
    margin: 0;
    word-break: normal
  }

  .custom-html-style code:after, .custom-html-style code:before {
    letter-spacing: 0
  }

  .custom-html-style blockquote {
    position: relative;
    margin: 16px 0;
    padding: 5px 8px 5px 30px;
    background: none repeat scroll 0 0 rgb(39 39 41);
    color: inherit;
    border: none;
    border-left: 10px solid #d6dbdf
  }

  .custom-html-style img, .custom-html-style video {
    max-width: 100%
  }

  .custom-html-style table {
    font-size: 14px;
    line-height: 1.7;
    max-width: 100%;
    overflow: auto;
    border: 1px solid ${e.palette.divider};
    border-collapse: collapse;
    border-spacing: 0;
    -webkit-box-sizing: border-box;
    box-sizing: border-box
  }

  .custom-html-style table td, .custom-html-style table th {
    word-break: break-all;
    word-wrap: break-word;
    white-space: normal
  }

  .custom-html-style table tr {
    border: 1px solid ${e.palette.divider}
  }

  .custom-html-style table tr:nth-of-type(2n) {
    background-color: transparent
  }

  .custom-html-style table th {
    text-align: center;
    font-weight: 700;
    border: 1px solid ${e.palette.divider};
    padding: 10px 6px;
    background-color: #f5f7fa;
    word-break: break-word
  }

  .custom-html-style table td {
    border: 1px solid ${e.palette.divider};
    text-align: left;
    padding: 10px 15px;
    word-break: break-word;
    min-width: 60px
  }

  .rc-md-editor .drop-wrap {
    display: block;
    position: absolute;
    left: 0;
    top: 28px;
    z-index: 2;
    min-width: 20px;
    padding: 10px 0;
    text-align: center;
    background-color: ${(0,W._j)(e.palette.background.default,0)};
    border-color: ${e.palette.divider};
    border-style: solid;
    border-width: 1px
  }

  .rc-md-editor .drop-wrap.hidden {
    display: none !important
  }

  .rc-md-editor .rc-md-navigation {
    min-height: 38px;
    padding: 0 8px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    border-bottom: 1px solid ${e.palette.divider};
    font-size: 16px;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -webkit-flex-direction: row;
    -ms-flex-direction: row;
    flex-direction: row;
    -webkit-box-pack: justify;
    -webkit-justify-content: space-between;
    -ms-flex-pack: justify;
    justify-content: space-between;
    
            color: "inherit",
            background-color: ${e.palette.mode,"rgb(39 39 41)"};
        
  }

  .rc-md-editor .rc-md-navigation.in-visible {
    display: none
  }

  .rc-md-editor .rc-md-navigation .navigation-nav {
    -webkit-box-align: center;
    -webkit-align-items: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: center;
    -webkit-justify-content: center;
    -ms-flex-pack: center;
    justify-content: center;
    font-size: 14px;
    color: ${(0,W._j)(e.palette.text.secondary,0)};
  }

  .rc-md-editor .rc-md-navigation .button-wrap, .rc-md-editor .rc-md-navigation .navigation-nav {
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -webkit-flex-direction: row;
    -ms-flex-direction: row;
    flex-direction: row
  }

  .rc-md-editor .rc-md-navigation .button-wrap {
    -webkit-flex-wrap: wrap;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button {
    position: relative;
    min-width: 22px;
    height: 28px;
    margin-left: 3px;
    margin-right: -2px;
    display: inline-block;
    cursor: pointer;
    line-height: 28px;
    text-align: center;
    color: ${e.palette.text.secondary};
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button:hover {
    color: ${(0,W._j)(e.palette.text.secondary,.2)};
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button.disabled {
    color: ${(0,W._j)(e.palette.text.disabled,0)};
    cursor: not-allowed
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button:first-of-type {
    margin-left: 0
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button:last-child {
    margin-right: 0
  }

  .rc-md-editor .rc-md-navigation .button-wrap .rmel-iconfont {
    font-size: 18px
  }

  .rc-md-editor .rc-md-navigation li, .rc-md-editor .rc-md-navigation ul {
    list-style: none;
    margin: 0;
    padding: 0
  }

  .rc-md-editor .rc-md-navigation .h1, .rc-md-editor .rc-md-navigation .h2, .rc-md-editor .rc-md-navigation .h3, .rc-md-editor .rc-md-navigation .h4, .rc-md-editor .rc-md-navigation .h5, .rc-md-editor .rc-md-navigation .h6, .rc-md-editor .rc-md-navigation h1, .rc-md-editor .rc-md-navigation h2, .rc-md-editor .rc-md-navigation h3, .rc-md-editor .rc-md-navigation h4, .rc-md-editor .rc-md-navigation h5, .rc-md-editor .rc-md-navigation h6 {
    font-family: inherit;
    font-weight: 500;
    color: inherit;
    padding: 0;
    margin: 0;
    line-height: 1.1
  }

  .rc-md-editor .rc-md-navigation h1 {
    font-size: 34px
  }

  .rc-md-editor .rc-md-navigation h2 {
    font-size: 30px
  }

  .rc-md-editor .rc-md-navigation h3 {
    font-size: 24px
  }

  .rc-md-editor .rc-md-navigation h4 {
    font-size: 18px
  }

  .rc-md-editor .rc-md-navigation h5 {
    font-size: 14px
  }

  .rc-md-editor .rc-md-navigation h6 {
    font-size: 12px
  }

  .rc-md-editor .tool-bar {
    position: absolute;
    z-index: 1;
    right: 8px;
    top: 8px
  }

  .rc-md-editor .tool-bar .button {
    min-width: 24px;
    height: 28px;
    margin-right: 5px;
    display: inline-block;
    cursor: pointer;
    font-size: 14px;
    line-height: 28px;
    text-align: center;
    color: #999
  }

  .rc-md-editor .tool-bar .button:hover {
    color: inherit
  }

  .rc-md-editor .rc-md-divider {
    display: block;
    width: 1px;
    background-color: ${(0,W._j)(e.palette.background.paper,0)}
  }

  .rc-md-editor .table-list.wrap {
    position: relative;
    margin: 0 10px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box
  }

  .rc-md-editor .table-list.wrap .list-item {
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    width: 20px;
    height: 20px;
    background-color: ${(0,W._j)(e.palette.background.paper,.05)};
    border-radius: 4px
  }

  .rc-md-editor .table-list.wrap .list-item.active {
    background: ${(0,W.$n)(e.palette.background.paper,.2)}
  }

  .rc-md-editor .tab-map-list .list-item {
    width: 120px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box
  }

  .rc-md-editor .tab-map-list .list-item:hover {
    background: ${(0,W._j)(e.palette.background.default,.1)}
  }

  .rc-md-editor .tab-map-list .list-item.active {
    font-weight: 700
  }

  .rc-md-editor .header-list .list-item {
    width: 100px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    padding: 8px 0
  }

  .rc-md-editor .header-list .list-item:hover {
    background: ${(0,W._j)(e.palette.background.default,.1)}
  }

`);function nY(e,t,r){let i={};return Object.entries(t).forEach(([t,n])=>{i[t]=nG({property:n,customFieldValidator:r,name:t,entityId:e})}),tW.Ry().shape(i)}function nG(e){let t=e.property;if(iY(t))throw console.error("Error in property",e),Error("Trying to create a yup mapping from a property builder. Please use resolved properties only");if("string"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){let o=tW.Z_(),l=e.validation;if(e.enumValues&&(l?.required&&(o=o.required(l?.requiredMessage?l.requiredMessage:"Required")),o=o.oneOf(r5(e.enumValues).map(e=>e.id)).nullable(!0)),l){if(o=l.required?o.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):o.notRequired().nullable(!0),l.unique&&r&&i&&(o=o.test("unique","This value already exists and should be unique",(o,l)=>r({name:i,property:e,parentProperty:t,value:o,entityId:n}))),(l.min||0===l.min)&&(o=o.min(l.min,`${e.name} must be min ${l.min} characters long`)),(l.max||0===l.max)&&(o=o.max(l.max,`${e.name} must be max ${l.max} characters long`)),l.matches){let e="string"==typeof l.matches?function(e){if(!e)return;let t=e.match(/\/(.*?)\/([a-z]*)?$/i);return t?new RegExp(t[1],t[2]||""):RegExp(e,"")}(l.matches):l.matches;e&&(o=o.matches(e,l.matchesMessage?{message:l.matchesMessage}:void 0))}l.trim&&(o=o.trim()),l.lowercase&&(o=o.lowercase()),l.uppercase&&(o=o.uppercase()),e.email&&(o=o.email(`${e.name} must be an email`)),e.url&&(o=o.url(`${e.name} must be a url`))}else o=o.notRequired().nullable(!0);return o}(e);if("number"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){let o=e.validation,l=tW.Rx().typeError("Must be a number");return o?(l=o.required?l.required(o.requiredMessage?o.requiredMessage:"Required").nullable(!0):l.notRequired().nullable(!0),o.unique&&r&&i&&(l=l.test("unique","This value already exists and should be unique",o=>r({name:i,property:e,parentProperty:t,value:o,entityId:n}))),(o.min||0===o.min)&&(l=l.min(o.min,`${e.name} must be higher or equal to ${o.min}`)),(o.max||0===o.max)&&(l=l.max(o.max,`${e.name} must be lower or equal to ${o.max}`)),(o.lessThan||0===o.lessThan)&&(l=l.lessThan(o.lessThan,`${e.name} must be higher than ${o.lessThan}`)),(o.moreThan||0===o.moreThan)&&(l=l.moreThan(o.moreThan,`${e.name} must be lower than ${o.moreThan}`)),o.positive&&(l=l.positive(`${e.name} must be positive`)),o.negative&&(l=l.negative(`${e.name} must be negative`)),o.integer&&(l=l.integer(`${e.name} must be an integer`))):l=l.notRequired().nullable(!0),l}(e);if("boolean"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){let o=tW.O7(),l=e.validation;return l?(o=l.required?o.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):o.notRequired().nullable(!0),l.unique&&r&&i&&(o=o.test("unique","This value already exists and should be unique",o=>r({name:i,property:e,parentProperty:t,value:o,entityId:n})))):o=o.notRequired().nullable(!0),o}(e);if("map"===t.dataType)return function({property:e,entityId:t,customFieldValidator:r,name:i}){let n={};return e.validation,e.properties&&Object.entries(e.properties).forEach(([o,l])=>{n[o]=nG({property:l,parentProperty:e,customFieldValidator:r,name:`${i}[${o}]`,entityId:t})}),tW.Ry().shape(n)}(e);if("array"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){let o=tW.IX();if(e.of){if(Array.isArray(e.of)){let t=e.of.map((t,r)=>({[`${i}[${r}]`]:nG({property:t,parentProperty:e,entityId:n})})).reduce((e,t)=>({...e,...t}),{});return tW.IX().of(tW.nK().test("Dynamic object validation","Dynamic object validation error",(e,r)=>iM(t,r.path).validate(e)))}{var l;o=o.of(nG({property:e.of,parentProperty:e,entityId:n}));let t=(l=e.of,!!l.validation?.uniqueInArray||"map"===l.dataType&&!!l.properties&&Object.entries(l.properties).filter(([e,t])=>t.validation?.uniqueInArray));t&&("boolean"==typeof t?o=o.uniqueInArray(e=>e,`${e.name} should have unique values within the array`):Array.isArray(t)&&t.forEach(([t,r])=>{o=o.uniqueInArray(e=>e&&e[t],`${e.name} → ${r.name??t}: should have unique values within the array`)}))}}let a=e.validation;return a?(o=a.required?o.required(a?.requiredMessage?a.requiredMessage:"Required").nullable(!0):o.notRequired().nullable(!0),(a.min||0===a.min)&&(o=o.min(a.min,`${e.name} should be min ${a.min} entries long`)),a.max&&(o=o.max(a.max,`${e.name} should be max ${a.max} entries long`))):o=o.notRequired().nullable(!0),o}(e);if("date"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){if(e.autoValue)return tW.Ry().nullable();let o=tW.hT(),l=e.validation;return l?(o=l.required?o.required(l?.requiredMessage?l.requiredMessage:"Required"):o.notRequired(),l.unique&&r&&i&&(o=o.test("unique","This value already exists and should be unique",o=>r({name:i,property:e,parentProperty:t,value:o,entityId:n}))),l.min&&(o=o.min(l.min,`${e.name} must be after ${l.min}`)),l.max&&(o=o.max(l.max,`${e.name} must be before ${l.min}`))):o=o.notRequired(),o.transform(e=>e instanceof Date?e:null).nullable()}(e);if("geopoint"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){let o=tW.Ry(),l=e.validation;return l?.unique&&r&&i&&(o=o.test("unique","This value already exists and should be unique",o=>r({name:i,property:e,parentProperty:t,value:o,entityId:n}))),o=l?.required?o.required(l.requiredMessage).nullable(!0):o.notRequired().nullable(!0)}(e);if("reference"===t.dataType)return function({property:e,parentProperty:t,customFieldValidator:r,name:i,entityId:n}){let o=tW.Ry(),l=e.validation;return l?(o=l.required?o.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):o.notRequired().nullable(!0),l.unique&&r&&i&&(o=o.test("unique","This value already exists and should be unique",o=>r({name:i,property:e,parentProperty:t,value:o,entityId:n})))):o=o.notRequired().nullable(!0),o}(e);throw console.error("Unsupported data type in yup mapping",t),Error("Unsupported data type in yup mapping")}tW.kM(tW.IX,"uniqueInArray",function(e=e=>e,t){return this.test("uniqueInArray",t,t=>!t||t.length===new Set(t.map(e)).size)});let nO=({containerRef:e})=>{let{isSubmitting:t,isValidating:r,errors:i}=(0,te.u6)();return(0,s.useEffect)(()=>{let n=Object.keys(i);if(n.length>0&&t&&!r){let t=e?.current?.querySelector(`#form_field_${n[0]}`);if(t&&e?.current){let r=nH(e.current);if(r){let e=t.getBoundingClientRect().top;r.scrollTo({top:r.scrollTop+e-64,behavior:"smooth"})}let i=t.querySelector("input");i&&i.focus()}}},[t,r,i,e]),null},nW=e=>{let t=e&&e.scrollHeight>e.clientHeight,r=e?window.getComputedStyle(e).overflowY:null,i=r&&-1!==r.indexOf("hidden");return t&&!i},nH=e=>e&&e!==document.body?nW(e)?e:nH(e.parentNode):document.body,nU=({collection:e,path:t,entityId:r,values:i,previousValues:n,userConfigPersistence:o,fields:l})=>{let a=o?.getCollectionConfig(t),s=iM(a,"properties"),d=iG(e.properties),c=i??d,u=n??i??d,A=Object.entries(e.properties).map(([e,i])=>{let n=c?(0,te.u9)(c,e):void 0;return{[e]:nj({propertyKey:e,propertyOrBuilder:i,values:c,previousValues:u,path:t,propertyValue:n,entityId:r,fields:l})}}).filter(e=>null!==e).reduce((e,t)=>({...e,...t}),{}),p=iP(A,s),h=Object.entries(p).filter(([e,t])=>!!t?.dataType).map(([e,t])=>({[e]:t})).reduce((e,t)=>({...e,...t}),{});return{...e,properties:h,originalCollection:e}};function nj({propertyOrBuilder:e,propertyValue:t,fromBuilder:r=!1,...i}){if("object"==typeof e&&"resolved"in e)return e;let n=null;if(!e)return null;if(iY(e)){let r=i.path;if(!r)throw Error("Trying to resolve a property builder without specifying the entity path");let o=e({...i,path:r,propertyValue:t,values:i.values??{},previousValues:i.previousValues??i.values??{}});if(!o)return console.debug("Property builder not returning `Property` so it is not rendered",r,i.entityId,e),null;n=nj({...i,propertyValue:t,propertyOrBuilder:o,fromBuilder:!0})}else if("map"===e.dataType&&e.properties){let o=nL({...i,properties:e.properties,propertyValue:t});n={...e,resolved:!0,fromBuilder:r,properties:o}}else"array"===e.dataType?n=n$({property:e,propertyValue:t,fromBuilder:r,...i}):("string"===e.dataType||"number"===e.dataType)&&e.enumValues&&(n=nN(e,r));if(n||(n={...e,resolved:!0,fromBuilder:r}),n.fieldConfig){let e=i.fields;if(!e)throw Error(`Trying to resolve a property with key ${n.fieldConfig} that inherits from a custom field but no custom fields were provided. Use the property 'fields' in your top level component to provide them`);let r=e[n.fieldConfig];if(!r)throw Error(`Trying to resolve a property that inherits from a custom field but no custom field with id ${n.fieldConfig} was found. Check the \`fields\` in your top level component`);if(r.defaultProperty){let e=nj({propertyOrBuilder:r.defaultProperty,propertyValue:t,...i});e&&(n=iP(e,n))}r.Field&&(n.Field=r.Field)}return n?{...n,resolved:!0}:null}function n$({propertyKey:e,property:t,propertyValue:r,...i}){if(t.of){if(Array.isArray(t.of))return{...t,resolved:!0,fromBuilder:i.fromBuilder,resolvedProperties:t.of.map((t,n)=>nj({propertyKey:`${e}.${n}`,propertyOrBuilder:t,propertyValue:Array.isArray(r)?r[n]:void 0,...i,index:n}))};{let n=t.of,o=Array.isArray(r)?r.map((t,r)=>nj({propertyKey:`${e}.${r}`,propertyOrBuilder:n,propertyValue:t,...i,index:r})).filter(e=>!!e):[],l=nj({propertyKey:`${e}`,propertyOrBuilder:n,propertyValue:void 0,...i});if(!l)throw Error("When using a property builder as the 'of' prop of an ArrayProperty, you must return a valid child property");return{...t,resolved:!0,fromBuilder:i.fromBuilder,of:l,resolvedProperties:o}}}if(t.oneOf){let n=t.oneOf?.typeField??ib,o=Array.isArray(r)?r.map((o,l)=>{let a=o&&o[n],s=t.oneOf?.properties[a];return a&&s?nj({propertyKey:`${e}.${l}`,propertyOrBuilder:s,propertyValue:r,...i}):null}).filter(e=>!!e):[],l=nL({properties:t.oneOf.properties,propertyValue:void 0,...i});return{...t,resolved:!0,oneOf:{...t.oneOf,properties:l},fromBuilder:i.fromBuilder,resolvedProperties:o}}if(t.Field)return{...t,resolved:!0,fromBuilder:i.fromBuilder};throw Error("The array property needs to declare an 'of' or a 'oneOf' property, or provide a custom `Field`")}function nL({properties:e,propertyValue:t,...r}){return Object.entries(e).map(([e,i])=>({[e]:nj({propertyKey:e,propertyOrBuilder:i,propertyValue:t&&"object"==typeof t?iM(t,e):void 0,...r})})).filter(e=>null!==e).reduce((e,t)=>({...e,...t}),{})}function nN(e,t){return"object"==typeof e.enumValues?{...e,resolved:!0,enumValues:nX(e.enumValues)?.filter(e=>e&&e.id&&e.label)??[],fromBuilder:t??!1}:e}function nX(e){return"object"==typeof e?Object.entries(e).map(([e,t])=>"string"==typeof t?{id:e,label:t}:t):Array.isArray(e)?e:void 0}let n_="CustomIdField",nJ={input:`${n_}-input`,select:`${n_}-select`},nK=(0,J.ZP)(F.Z)(({theme:e})=>({marginBottom:"16px",[`& .${nJ.input}`]:{minHeight:"64px"},[`& .${nJ.select}`]:{paddingTop:e.spacing(.5)}}));function nq({customId:e,entityId:t,status:r,onChange:n,error:o,entity:l}){let a="existing"===r||!e,c="existing"!==r&&!e,u=(0,s.useMemo)(()=>{if(!(!e||"boolean"==typeof e||"optional"===e))return nX(e)},[e]),A=rx(),{copy:h}=rD({onSuccess:e=>A.open({type:"success",message:`Copied ${e}`})}),f=rk(),g={sx:e=>({minHeight:"64px",borderRadius:`${e.shape.borderRadius}px`}),disableUnderline:!0,endAdornment:l?(0,i.BX)(H.Z,{position:"end",children:[(0,i.tZ)(p.Z,{onClick:e=>h(l.id),"aria-label":"copy-id",size:"large",children:(0,i.tZ)(d.Z,{title:"Copy",children:(0,i.tZ)("svg",{className:"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall",fill:"currentColor",width:"20",height:"20",viewBox:"0 0 24 24",children:(0,i.tZ)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})})})}),f?.entityLinkBuilder&&(0,i.tZ)("a",{href:f.entityLinkBuilder({entity:l}),rel:"noopener noreferrer",target:"_blank",children:(0,i.tZ)(p.Z,{onClick:e=>e.stopPropagation(),"aria-label":"go-to-datasource",size:"large",children:(0,i.tZ)(d.Z,{title:"Open in the console",children:(0,i.tZ)(tc.Z,{fontSize:"small"})})})})]}):void 0},m={label:c?"ID is set automatically":"ID",disabled:a,name:"id",type:null,value:(l&&"existing"===r?l.id:t)??"",variant:"filled",sx:e=>({minHeight:"64px",borderRadius:`${e.shape.borderRadius}px`})};return(0,tH.az)(nK,{fullWidth:!0,error:o,...m,key:"custom-id-field"},u&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(Q.Z,{id:"id-label",children:m.label}),(0,i.tZ)(D.Z,{labelId:"id-label",fullWidth:!0,className:nJ.select,disableUnderline:!0,error:o,...m,onChange:e=>n(e.target.value),children:u.map(e=>(0,i.tZ)(k.Z,{value:e.id,children:`${e.id} - ${e.label}`},`custom-id-item-${e.id}`))})]}),!u&&(0,i.tZ)(z.Z,{...m,error:o,InputProps:g,helperText:"optional"===e?"Autogenerated ID, it can be manually changed":"new"===r||"copy"===r?"ID of the new document":"ID of the document",onChange:e=>{let t=e.target.value;return t&&(t=t.trim()),n(t.length?t:void 0)}}),(0,i.tZ)(te.Bc,{name:"id",component:"div",children:e=>"You need to specify an ID"}))}let n0=s.memo(function({status:e,path:t,collection:r,entity:n,onEntitySave:o,onDiscard:l,onModified:a,onValuesChanged:d,onIdChange:A,onFormContextChange:p,hideId:h}){let f=rk(),g=ru(),m=f.plugins,y=(0,s.useMemo)(()=>nU({collection:r,path:t,values:n?.values,fields:f.fields}),[n?.values,t]),b=("new"===e||"copy"===e)&&!!y.customId&&"optional"!==y.customId,Z=(0,s.useMemo)(()=>"new"===e||"copy"===e?b?void 0:g.generateEntityId(t):n?.id,[]),v=(0,s.useRef)(!1),x=(0,s.useMemo)(()=>{let t=y.properties;if(("existing"===e||"copy"===e)&&n)return n.values??iG(t);if("new"===e)return iG(t);throw console.error({status:e,entity:n}),Error("Form has not been initialised with the correct parameters")},[e,y,n]),[w,C]=s.useState(Z),[B,k]=s.useState(!1),[E,S]=s.useState(),[I,F]=(0,s.useState)(n?.values??x),[R,Q]=(0,s.useState)(I),D=(0,s.useCallback)(e=>{Q(e),d&&d(e)},[d]);(0,s.useEffect)(()=>{w&&A&&A(w)},[w,A]);let P=(0,s.useMemo)(()=>nU({collection:r,path:t,entityId:w,values:R,previousValues:I,fields:f.fields}),[r,t,w,R,I]),M=P.callbacks?.onIdUpdate;(0,s.useEffect)(()=>{if(M&&R&&("new"===e||"copy"===e))try{C(M({collection:P,path:t,entityId:w,values:R,context:f}))}catch(e){console.error(e)}},[P,f,w,R,t,e]);let T=(0,s.useMemo)(()=>I&&"existing"===e?Object.entries(P.properties).map(([e,t])=>{if(iz(t))return{};let r=I[e],i=x[e];return eY()(r,i)?{}:{[e]:i}}).reduce((e,t)=>({...e,...t}),{}):{},[x,P.properties,I,e]),V=(0,s.useCallback)((r,i)=>{if(b&&!w){console.error("Missing custom Id"),k(!0),i.setSubmitting(!1);return}if(S(void 0),k(!1),"existing"===e){if(!n?.id)throw Error("Form misconfiguration when saving, no id for existing entity")}else if("new"===e||"copy"===e){if(P.customId&&"optional"!==P.customId&&!w)throw Error("Form misconfiguration when saving, entityId should be set")}else throw Error("New FormType added, check EntityForm");o?.({collection:P,path:t,entityId:w,values:r,previousValues:n?.values,closeAfterSave:v.current}).then(n=>{let o="new"===e?"new_entity_saved":"copy"===e?"entity_copied":"existing"===e?"entity_edited":"unmapped_event";f.onAnalyticsEvent?.(o,{path:t}),F(r),i.resetForm({values:r,submitCount:0,touched:{}})}).catch(e=>{console.error(e),S(e)}).finally(()=>{v.current=!1,i.setSubmitting(!1)})},[e,t,P,n,o,b,w]),z=(0,s.useCallback)(({name:e,value:r,property:i})=>g.checkUniqueField(t,e,r,i,w),[g,t,w]),Y=(0,s.useMemo)(()=>w?nY(w,P.properties,z):void 0,[w,P.properties]);return(0,i.tZ)(te.J9,{initialValues:x,onSubmit:V,validationSchema:Y,validate:e=>console.debug("Validating",e),onReset:()=>l&&l(),children:o=>{let l=[],d={setFieldValue:o.setFieldValue,values:o.values,collection:nU({collection:P,path:t,fields:f.fields}),entityId:w,path:t};if((0,s.useEffect)(()=>{p&&p(d)},[p,d]),m&&P){let n={entityId:w,path:t,status:e,collection:r,context:f,currentEntityId:w,formContext:d};l.push(...m.map((e,t)=>e.form?.Actions?(0,i.tZ)(e.form.Actions,{...n},`actions_${e.name}`):null).filter(Boolean))}return(0,i.tZ)(i.HY,{children:(0,i.BX)(c.Z,{sx:e=>({paddingLeft:e.spacing(4),paddingRight:e.spacing(4),paddingTop:e.spacing(3),paddingBottom:e.spacing(4),marginBottom:e.spacing(2),[e.breakpoints.down("lg")]:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingTop:e.spacing(2),paddingBottom:e.spacing(3)},[e.breakpoints.down("md")]:{padding:e.spacing(2)}}),children:[l.length>0&&(0,i.tZ)(c.Z,{sx:e=>({width:"100%",display:"flex",justifyContent:"flex-end",background:"light"===e.palette.mode?"rgba(255,255,255,0.6)":(0,W.Fq)(e.palette.background.paper,.1),backdropFilter:"blur(8px)",borderBottom:`1px solid ${e.palette.divider}`,flexDirection:"row",alignItems:"center",position:"absolute",top:0,right:0,left:0,textAlign:"right",zIndex:2,"& > *:not(:last-child)":{[e.breakpoints.down("md")]:{mr:e.spacing(1)},mr:e.spacing(2)}}),children:l}),(0,i.tZ)(c.Z,{sx:e=>({width:"100%",marginTop:e.spacing(4+(l?4:0)),paddingY:2,display:"flex",alignItems:"center",[e.breakpoints.down("lg")]:{marginTop:e.spacing(3+(l?4:0))},[e.breakpoints.down("md")]:{marginTop:e.spacing(2+(l?4:0))}}),children:(0,i.tZ)(u.Z,{sx:{marginTop:4,marginBottom:P.hideIdFromForm?0:4,flexGrow:1},variant:"h4",children:P.singularName??P.name+" entry"})}),!h&&(0,i.tZ)(nq,{customId:P.customId,entityId:w,status:e,onChange:C,error:B,entity:n}),w&&(0,i.tZ)(n1,{...o,initialValues:I,onModified:a,onValuesChanged:D,underlyingChanges:T,path:t,entity:n,entityId:w,collection:P,formContext:d,status:e,savingError:E,closeAfterSaveRef:v})]})})}})},(e,t)=>e.status===t.status&&e.path===t.path&&eY()(e.entity?.values,t.entity?.values));function n1(e){let{initialValues:t,values:r,onModified:n,onValuesChanged:o,underlyingChanges:l,entityId:a,formContext:d,entity:A,touched:p,setFieldValue:h,collection:f,path:g,isSubmitting:m,status:y,handleSubmit:b,savingError:v,dirty:x,errors:w,closeAfterSaveRef:B}=e;(0,s.useEffect)(()=>{n&&n(x),o&&o(r)},[x,r]),(0,s.useEffect)(()=>{l&&A&&Object.entries(l).forEach(([e,t])=>{let i=r[e];eY()(t,i)||p[e]||(console.debug("Updated value from the datasource:",e,t),h(e,void 0!==t?t:null))})},[l,A,r,p,h]);let k=(0,i.tZ)(Z.ZP,{container:!0,spacing:6,children:Object.entries(f.properties).map(([e,t])=>{let r=!!l&&Object.keys(l).includes(e)&&!!p[e],n=m||iV(t)||!!t.disabled;return iz(t)?null:(0,i.tZ)(Z.ZP,{item:!0,xs:12,id:`form_field_${e}`,children:(0,i.tZ)(i3,{propertyKey:e,disabled:n,property:t,includeDescription:!0,underlyingValueHasChanged:r,context:d,tableMode:!1,partOfArray:!1,autoFocus:!1})},`field_${f.name}_${e}`)}).filter(Boolean)}),E=m||!x&&"existing"===y,S=s.createRef();return(0,i.BX)(te.l0,{onSubmit:b,noValidate:!0,children:[(0,i.BX)(c.Z,{sx:{mt:4},ref:S,children:[k,(0,i.tZ)(nO,{containerRef:S})]}),(0,i.tZ)(c.Z,{sx:{height:56}}),(0,i.BX)(oS,{position:"absolute",children:[v&&(0,i.tZ)(c.Z,{textAlign:"right",children:(0,i.tZ)(u.Z,{color:"error",children:v.message})}),(0,i.tZ)(C.Z,{variant:"text",color:"primary",disabled:E,type:"reset",children:"existing"===y?"Discard":"Clear"}),(0,i.BX)(C.Z,{variant:"text",color:"primary",type:"submit",disabled:E,onClick:()=>{B.current=!1},children:["existing"===y&&"Save","copy"===y&&"Create copy","new"===y&&"Create"]}),(0,i.BX)(C.Z,{variant:"contained",color:"primary",type:"submit",disabled:E,onClick:()=>{B.current=!0},children:["existing"===y&&"Save and close","copy"===y&&"Create copy and close","new"===y&&"Create and close"]})]})]})}let n2={text_field:{name:"Text field",description:"Simple short text",dataType:"string",Icon:e$.Z,color:"#2d7ff9",Field:nC},multiline:{name:"Multiline",description:"Text with multiple lines",dataType:"string",Icon:eL.Z,color:"#2d7ff9",Field:nC},markdown:{name:"Markdown",description:"Text with advanced markdown syntax",dataType:"string",Icon:e6.Z,color:"#2d7ff9",Field:function({propertyKey:e,value:t,setValue:r,error:n,showError:o,disabled:l,autoFocus:a,touched:d,property:u,tableMode:A,includeDescription:p,context:h}){let[f,g]=s.useState(t),m=(0,s.useRef)(t),y=(0,s.useDeferredValue)({internalValue:f,value:t});return(0,s.useEffect)(()=>{m.current=t,g(t)},[t]),(0,s.useEffect)(()=>{y.internalValue!==m.current&&r(y.internalValue)},[y]),(0,i.BX)(nz,{required:u.validation?.required,error:o,fullWidth:!0,children:[!A&&(0,i.tZ)(I.Z,{filled:!0,children:(0,i.tZ)(i2,{icon:n3(u),required:u.validation?.required,title:u.name})}),(0,i.tZ)(tV.ZP,{value:f??"",readOnly:l,renderHTML:e=>nV.render(e),view:{menu:!0,md:!0,html:!1},onChange:({html:e,text:t})=>{g(t??null)}}),(0,i.tZ)(c.Z,{display:"flex",children:(0,i.BX)(c.Z,{flexGrow:1,children:[o&&"string"==typeof n&&(0,i.tZ)(I.Z,{error:!0,children:n}),p&&(0,i.tZ)(i1,{property:u})]})})]})}},url:{name:"Url",description:"Text with URL validation",dataType:"string",Icon:e4.Z,color:"#154fb3",Field:nC},email:{name:"Email",description:"Text with email validation",dataType:"string",Icon:e9.Z,color:"#154fb3",Field:nC},select:{name:"Select/enum",description:"Select one text value from within an enumeration",dataType:"string",Icon:eX.Z,color:"#4223c9",Field:i9},multi_select:{name:"Multi select",description:"Select multiple text values from within an enumeration",dataType:"array",Icon:e1.Z,color:"#4223c9",Field:i7},number_input:{name:"Number input",description:"Simple number field with validation",dataType:"number",Icon:e3.Z,color:"#bec920",Field:nC},number_select:{name:"Number select",description:"Select a number value from within an enumeration",dataType:"number",Icon:e8.Z,color:"#bec920",Field:i9},multi_number_select:{name:"Multiple number select",description:"Select multiple number values from within an enumeration",dataType:"array",Icon:e8.Z,color:"#bec920",Field:i7},file_upload:{name:"File upload",description:"Input for uploading single files",dataType:"string",Icon:eJ.Z,color:"#f92d9a",Field:np},multi_file_upload:{name:"Multiple file upload",description:"Input for uploading multiple files",dataType:"array",Icon:eK.Z,color:"#f92d9a",Field:np},reference:{name:"Reference",description:"The value refers to a different collection",dataType:"reference",Icon:e2.Z,color:"#ff0042",Field:function(e){return"string"!=typeof e.property.path?(0,i.tZ)(i5,{...e}):(0,i.tZ)(nS,{...e})}},multi_references:{name:"Multiple references",description:"Multiple values that refer to a different collection",dataType:"array",Icon:eN.Z,color:"#ff0042",Field:function({propertyKey:e,value:t,error:r,showError:n,isSubmitting:o,tableMode:l,property:a,includeDescription:d,setValue:u}){let A=a.of;if("reference"!==A.dataType)throw Error("ArrayOfReferencesField expected a property containing references");let p=void 0===a.expanded||a.expanded,[h,f]=s.useState(!1),g=t&&Array.isArray(t)?t.map(e=>e.id):[];rR({property:a,value:t,setValue:u});let m=rp(),y=(0,s.useMemo)(()=>A.path?m.getCollection(A.path):void 0,[A.path]);if(!y)throw Error(`Couldn't find the corresponding collection for the path: ${A.path}`);let b=(0,s.useCallback)(e=>{u(e.map(e=>iH(e)))},[u]),Z=rM({multiselect:!0,path:A.path,collection:y,onMultipleEntitiesSelected:b,selectedEntityIds:g,forceFilter:A.forceFilter}),v=(0,s.useCallback)(()=>{Z.open()},[Z]),x=(0,s.useCallback)((e,r)=>{let n=t&&t.length>e?t[e]:void 0;return n?(0,i.tZ)("div",{onMouseEnter:()=>f(!0),onMouseMove:()=>f(!0),onMouseLeave:()=>f(!1),children:(0,i.tZ)(ia,{disabled:!A.path,previewProperties:A.previewProperties,size:"regular",onClick:v,reference:n,onHover:h})}):(0,i.tZ)("div",{children:"Internal ERROR"})},[A.path,A.previewProperties,h,t]),w=(0,i.tZ)(i2,{icon:n3(a),required:a.validation?.required,title:a.name}),B=(0,i.BX)(i.HY,{children:[!y&&(0,i.tZ)(rz,{error:"The specified collection does not exist. Check console"}),y&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(iq,{value:t,addLabel:a.name?"Add reference to "+a.name:"Add reference",name:e,buildEntry:x,disabled:o,newDefaultEntry:a.of.defaultValue}),(0,i.tZ)(c.Z,{p:1,justifyContent:"center",textAlign:"left",children:(0,i.BX)(C.Z,{variant:"outlined",color:"primary",disabled:o,onClick:v,children:["Edit ",a.name]})})]})]});return(0,i.tZ)(i.HY,{children:(0,i.BX)(F.Z,{fullWidth:!0,error:n,children:[!l&&(0,i.tZ)(nM,{initiallyExpanded:p,title:w,children:B}),l&&B,d&&(0,i.tZ)(i1,{property:a}),n&&"string"==typeof r&&(0,i.tZ)(I.Z,{error:!0,children:r})]})})}},switch:{name:"Switch",description:"True or false field (or yes or no, 0 or 1...)",dataType:"boolean",Icon:e5.Z,color:"#20d9d2",Field:nk},date_time:{name:"Date/time",description:"A date time select field",dataType:"date",Icon:e_.Z,color:"#8b46ff",Field:function({propertyKey:e,value:t,setValue:r,autoFocus:n,error:o,showError:l,disabled:a,touched:d,property:u,includeDescription:A}){rR({property:u,value:t,setValue:r});let h=(0,s.useCallback)(()=>{r(null)},[r]),f=void 0===u.mode||"date_time"===u.mode?tM.x:tP.M;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(f,{autoFocus:n,value:t||null,renderInput:e=>(0,i.tZ)(z.Z,{...e,fullWidth:!0,sx:e=>({minHeight:"64px",borderRadius:`${e.shape.borderRadius}px`,backgroundColor:ir(e),"&:hover":{backgroundColor:ii(e)}}),label:(0,i.tZ)(i2,{icon:n3(u),required:u.validation?.required,title:u.name}),InputProps:{...e.InputProps,sx:e=>({minHeight:"64px",borderRadius:`${e.shape.borderRadius}px`,backgroundColor:ir(e),"&:hover":{backgroundColor:ii(e)}}),disableUnderline:!0,endAdornment:(0,i.BX)(c.Z,{sx:{pr:2,gap:2},children:[u.clearable&&(0,i.tZ)(p.Z,{sx:{position:"absolute",right:"56px",top:"12px"},onClick:h,children:(0,i.tZ)(ts.Z,{})}),e.InputProps?.endAdornment]})},error:l,variant:"filled",helperText:l?o:null}),disabled:a,onChange:e=>r(e)}),A&&(0,i.tZ)(i1,{property:u})]})}},group:{name:"Group",description:"Group of multiple fields",dataType:"map",Icon:e7.Z,color:"#ff9408",Field:function({propertyKey:e,value:t,showError:r,disabled:n,property:o,setValue:l,tableMode:a,includeDescription:s,underlyingValueHasChanged:d,autoFocus:u,context:A}){let p;let h=o.pickOnlySomeKeys||!1,f=void 0===o.expanded||o.expanded||u;if(!o.properties)throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${e}`);p=h?t?iQ(o.properties,...Object.keys(t).filter(e=>e in o.properties)):{}:o.properties,rR({property:o,value:t,setValue:l});let g=(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.Z,{sx:{py:1,display:"flex",flexDirection:"column",gap:2},children:Object.entries(p).filter(([e,t])=>!iz(t)).map(([t,r],o)=>{let l={propertyKey:`${e}.${t}`,disabled:n,property:r,includeDescription:s,underlyingValueHasChanged:d,context:A,tableMode:!1,partOfArray:!1,autoFocus:u&&0===o};return(0,i.tZ)("div",{children:(0,i.tZ)(i3,{...l})},`map-${e}-${o}`)})}),h&&nI(n,o.properties,l,t)]}),m=(0,i.tZ)(i2,{icon:n3(o),required:o.validation?.required,title:o.name});return(0,i.BX)(F.Z,{fullWidth:!0,error:r,children:[!a&&(0,i.tZ)(nM,{initiallyExpanded:f,title:m,children:g}),a&&g,s&&(0,i.tZ)(i1,{property:o})]})}},key_value:{name:"Key-value",description:"Flexible field that allows the user to add multiple key-value pairs",dataType:"map",Icon:e7.Z,color:"#ff9408",Field:function({propertyKey:e,value:t,showError:r,disabled:n,property:o,setValue:l,tableMode:a,includeDescription:s,underlyingValueHasChanged:d,autoFocus:c,context:u}){let A=void 0===o.expanded||o.expanded||c;if(!o.keyValue)throw Error(`Your property ${e} needs to have the 'keyValue' prop in order to use this field binding`);let p=(0,i.tZ)(nQ,{value:t,setValue:l,disabled:n,fieldName:o.name??e}),h=(0,i.tZ)(i2,{icon:n3(o),required:o.validation?.required,title:o.name});return(0,i.BX)(F.Z,{fullWidth:!0,error:r,children:[!a&&(0,i.tZ)(nM,{initiallyExpanded:A,title:h,children:p}),a&&p,s&&(0,i.tZ)(i1,{property:o})]})}},repeat:{name:"Repeat/list",description:"A field that gets repeated multiple times (e.g. multiple text fields)",dataType:"array",Icon:eq.Z,color:"#ff9408",Field:function({propertyKey:e,value:t,error:r,showError:n,isSubmitting:o,setValue:l,tableMode:a,property:d,includeDescription:c,underlyingValueHasChanged:u,context:A,disabled:p}){if(!d.of)throw Error("RepeatFieldBinding misconfiguration. Property `of` not set");if(!d.resolvedProperties||!Array.isArray(d.resolvedProperties))throw Error("RepeatFieldBinding - Internal error: Expected array in 'property.resolvedProperties'");let h=void 0===d.expanded||d.expanded,f=d.of,[g,m]=(0,s.useState)();rR({property:d,value:t,setValue:l});let y=(0,s.useCallback)((t,r)=>{let n=d.resolvedProperties[t]??f,o={propertyKey:`${e}.${t}`,disabled:p,property:n,includeDescription:c,underlyingValueHasChanged:u,context:A,tableMode:!1,partOfArray:!0,autoFocus:r===g};return(0,i.tZ)(i3,{...o})},[A,p,c,g,f,d.resolvedProperties,e,u]),b=(0,i.tZ)(iq,{value:t,addLabel:d.name?"Add entry to "+d.name:"Add entry",name:e,buildEntry:y,onInternalIdAdded:m,disabled:o||!!d.disabled,includeAddButton:!d.disabled,newDefaultEntry:d.of.defaultValue}),Z=(0,i.tZ)(i2,{icon:n3(d),required:d.validation?.required,title:d.name});return(0,i.BX)(F.Z,{fullWidth:!0,error:n,children:[!a&&(0,i.tZ)(nM,{initiallyExpanded:h,title:Z,children:b}),a&&b,c&&(0,i.tZ)(i1,{property:d}),n&&"string"==typeof r&&(0,i.tZ)(I.Z,{error:!0,children:r})]})}},custom_array:{name:"Custom array",description:"A field that saved its value as an array of custom objects",dataType:"array",Icon:eq.Z,color:"#ff9408",Field:function({propertyKey:e,value:t,error:r,showError:n,isSubmitting:o,setValue:l,tableMode:a,property:s,includeDescription:d,underlyingValueHasChanged:u,context:A,disabled:p}){if(!Array.isArray(s.resolvedProperties))throw Error("ArrayCustomShapedFieldBinding misconfiguration. Property `of` not set");let h=void 0===s.expanded||s.expanded;rR({property:s,value:t,setValue:l});let f=(0,i.tZ)(i2,{icon:n3(s),required:s.validation?.required,title:s.name}),g=s.resolvedProperties.map((t,r)=>{let n={propertyKey:`${e}[${r}]`,disabled:p,property:t,includeDescription:d,underlyingValueHasChanged:u,context:A,tableMode:!1,partOfArray:!0,autoFocus:!1};return(0,i.tZ)(c.Z,{pb:1,children:(0,i.tZ)(i3,{...n})},`custom_shaped_array_${r}`)});return(0,i.BX)(F.Z,{fullWidth:!0,error:n,children:[!a&&(0,i.tZ)(nM,{initiallyExpanded:h,title:f,children:g}),a&&g,d&&(0,i.tZ)(i1,{property:s}),n&&"string"==typeof r&&(0,i.tZ)(I.Z,{error:!0,children:r})]})}},block:{name:"Block",description:"A complex field that allows the user to compose different fields together, with a key->value format",dataType:"array",Icon:e0.Z,color:"#ff9408",Field:function({propertyKey:e,value:t,error:r,showError:n,isSubmitting:o,setValue:l,tableMode:a,property:d,includeDescription:c,underlyingValueHasChanged:u,context:A,disabled:p}){if(!d.oneOf)throw Error("ArrayOneOfField misconfiguration. Property `oneOf` not set");let h=void 0===d.expanded||d.expanded;rR({property:d,value:t,setValue:l});let[f,g]=(0,s.useState)(),m=(0,s.useCallback)((r,n)=>(0,i.tZ)(nT,{name:`${e}.${r}`,index:r,value:t[r],typeField:d.oneOf.typeField??ib,valueField:d.oneOf.valueField??iZ,properties:d.oneOf.properties,autoFocus:n===f,context:A},`array_one_of_${r}`),[A,f,d.oneOf,e,t]),y=(0,i.tZ)(i2,{icon:n3(d),required:d.validation?.required,title:d.name}),b=Object.keys(d.oneOf.properties)[0],Z=(0,i.tZ)(iq,{value:t,name:e,addLabel:d.name?"Add entry to "+d.name:"Add entry",buildEntry:m,onInternalIdAdded:g,disabled:o||!!d.disabled,includeAddButton:!d.disabled,newDefaultEntry:{[d.oneOf.typeField??ib]:b,[d.oneOf.valueField??iZ]:iO(d.oneOf.properties[b])}});return(0,i.BX)(F.Z,{fullWidth:!0,error:n,children:[!a&&(0,i.tZ)(nM,{initiallyExpanded:h,title:y,children:Z}),a&&Z,c&&(0,i.tZ)(i1,{property:d}),n&&"string"==typeof r&&(0,i.tZ)(I.Z,{error:!0,children:r})]})}}};function n4(e){let t=n5(e);return t?n2[t]:void 0}function n5(e){if("string"===e.dataType)return e.multiline?"multiline":e.markdown?"markdown":e.storage?"file_upload":e.url?"url":e.email?"email":e.enumValues?"select":"text_field";if("number"===e.dataType)return e.enumValues?"number_select":"number_input";if("map"===e.dataType){if(e.keyValue)return"key_value";if(e.properties)return"group"}else if("array"===e.dataType){let t=e.of,r=e.oneOf;return Array.isArray(t)?"custom_array":iY(t)?"repeat":t?.dataType==="string"&&t.enumValues?"multi_select":t?.dataType==="number"&&t.enumValues?"multi_number_select":t?.dataType==="string"&&t.storage?"multi_file_upload":t?.dataType==="reference"?"multi_references":r?"block":"repeat"}else{if("boolean"===e.dataType)return"switch";if("date"===e.dataType)return"date_time";if("reference"===e.dataType)return"reference"}console.error("Unsupported field config mapping",e)}function n3(e,t="inherit",r="inherit"){if(iY(e))return(0,i.tZ)(eU.Z,{color:t,fontSize:r});{let n=n4(e);return function(e,t,r){let n=e?.Icon??ej.Z;return(0,i.tZ)(n,{color:t,fontSize:r})}(n,t,r)}}let n8={read:!0,edit:!0,create:!0,delete:!0};function n6(e,t,r,i){let n=e.permissions;if(void 0===n)return n8;if("object"==typeof n)return n;if("function"==typeof n)return n({entity:i,user:t.user,authController:t,collection:e,pathSegments:r});throw console.error("Permissions:",n),Error("New type of permission added and not mapped")}function n9(e,t,r,i){return n6(e,t,r,i).edit??n8.edit}function n7(e,t,r,i){return n6(e,t,r,i).create??n8.create}function oe(e,t,r,i){return n6(e,t,r,i).delete??n8.delete}function ot(e){let t=function(e){if(e)return e in eI?eI[e]:void 0}(e.icon);if(e?.icon&&t)return t;let r=or.length,i=or[r1(e.path)%r];return eI[i]}let or=["AcUnit","Adjust","AlignHorizontalCenter","Album","AllInclusive","AllOut","Animation","Assistant","Attractions","Audiotrack","AutoAwesome","AutoAwesomeMosaic","BeachAccess","Bolt","Brightness1","BreakfastDining","BrokenImage","Brightness5","Cable","CalendarViewMonth","CatchingPokemon","Casino","Category","Cloud","ColorLens","CreditCard","Coronavirus","Earbuds","EggAlt","FiberSmartRecord","Flag","Healing","HeatPump","Hive","Hub","LocalFireDepartment","LocalPizza","Memory","Outlet","Pages","PanoramaPhotosphere","SignalCellular0Bar","SportsBaseball","Storm","Stairs"];function oi(e,t,r,i=3){let n=Object.keys(e.properties),o=r?.filter(e=>n.includes(e));return o&&o.length>0?o:(o=n).filter(r=>{let i=e.properties[r];return i&&!iY(i)&&!function(e,t){let r=nj({propertyKey:"ignore",propertyOrBuilder:e,fields:t});return r?"reference"===r.dataType||"array"===r.dataType&&!Array.isArray(r.of)&&r.of?.dataType==="reference":null}(i,t)}).slice(0,i)}let on="EntityPreview",oo={property:`${on}-property`,valuePreview:`${on}-valuePreview`,iconCell:`${on}-iconCell`,titleCell:`${on}-titleCell`},ol=(0,J.ZP)(U.Z)(({theme:e})=>({[`& .${oo.property}`]:{display:"flex"},[`& .${oo.valuePreview}`]:{height:"72px",padding:e.spacing(2,3)},[`& .${oo.iconCell}`]:{paddingTop:e.spacing(1)},[`& .${oo.titleCell}`]:{width:"25%",padding:e.spacing(1)}}));function oa({entity:e,collection:t,path:r}){let n=rk(),o=s.useMemo(()=>nU({collection:t,path:r,entityId:e.id,values:e.values,fields:n.fields}),[t,r,e]),l=rk(),a=o.properties;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.Z,{sx:e=>({width:"100%",marginTop:e.spacing(3),paddingLeft:e.spacing(4),paddingRight:e.spacing(4),paddingTop:e.spacing(3),[e.breakpoints.down("lg")]:{marginTop:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingTop:e.spacing(2)},[e.breakpoints.down("md")]:{marginTop:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingTop:e.spacing(2)}}),children:(0,i.tZ)(u.Z,{sx:{marginTop:4,marginBottom:4},variant:"h4",children:t.singularName??t.name+" entry"})}),(0,i.tZ)(ol,{children:(0,i.tZ)(g.Z,{"aria-label":"entity table",children:(0,i.BX)(m.Z,{children:[(0,i.BX)(y.Z,{children:[(0,i.tZ)(b.Z,{align:"right",component:"td",scope:"row",className:oo.titleCell,children:(0,i.tZ)(u.Z,{variant:"caption",color:"textSecondary",children:"Id"})}),(0,i.tZ)(b.Z,{padding:"none",className:oo.iconCell,children:function(e="inherit",t="inherit"){return(0,i.tZ)(eH.Z,{color:e,fontSize:t})}("disabled","small")}),(0,i.tZ)(b.Z,{className:oo.valuePreview,children:(0,i.BX)(c.Z,{display:"flex",alignItems:"center",children:[e.id,l?.entityLinkBuilder&&(0,i.tZ)("a",{href:l.entityLinkBuilder({entity:e}),rel:"noopener noreferrer",target:"_blank",children:(0,i.tZ)(p.Z,{"aria-label":"go-to-entity-datasource",size:"large",children:(0,i.tZ)(tc.Z,{fontSize:"small"})})})]})})]}),t&&Object.entries(a).map(([t,r])=>{let n=e.values[t];return(0,i.BX)(y.Z,{children:[(0,i.tZ)(b.Z,{align:"right",component:"td",scope:"row",className:oo.titleCell,children:(0,i.tZ)(u.Z,{sx:{paddingLeft:2},variant:"caption",color:"textSecondary",children:r.name})}),(0,i.tZ)(b.Z,{padding:"none",className:oo.iconCell,children:n3(r,"disabled","small")}),(0,i.tZ)(b.Z,{className:oo.valuePreview,children:(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:t,value:n,entity:e,property:r,size:"regular"})})})]},"entity_prev"+r.name+t)})]})})})]})}function os(e){return`subcollection:${e.alias??e.path}`}function od(e){let t=s.createRef(),{disabled:r,value:n,multiline:o,updateValue:l,focused:a}=e,d=(0,s.useRef)(n),[c,u]=(0,s.useState)(n),A=(0,s.useRef)(!1);(0,s.useEffect)(()=>{d.current!==n&&n!==c&&u(n),d.current=n},[n]);let p=s.useCallback(()=>{(n||c)&&c!==n&&(d.current=c,l(c))},[c,n]);return iN(c,p,!a,2e3),(0,s.useEffect)(()=>{t.current&&a&&!A.current?(A.current=!0,t.current.focus({preventScroll:!0}),t.current.selectionStart=t.current.value.length,t.current.selectionEnd=t.current.value.length):A.current=a},[a,t]),(0,i.tZ)(nb,{ref:t,style:{padding:0,margin:0,width:"100%",color:"unset",fontWeight:"unset",lineHeight:"unset",fontSize:"unset",fontFamily:"unset",background:"unset",border:"unset",resize:"none",outline:"none"},value:c??"",onChange:e=>{let t=e.target.value;(o||!t.endsWith(`
`))&&u(t)},onFocus:()=>{A.current=!0,e.setFocused(!0)},onBlur:()=>{A.current=!1,p(),e.setFocused(!1)}})}function oc(e){let{name:t,enumValues:r,error:n,internalValue:o,disabled:l,small:a,focused:d,updateValue:c,multiple:u,valueType:A}=e,[p,h]=(0,s.useState)(!1),f=(0,s.useCallback)(()=>{h(!0)},[]),g=(0,s.useCallback)(()=>{h(!1)},[]),m=Array.isArray(o)&&u||!Array.isArray(o)&&!u,y=s.createRef();(0,s.useEffect)(()=>{y.current&&d&&y.current?.focus({preventScroll:!0})},[d,y]);let b=(0,s.useCallback)(e=>{if("number"===A){if(u){let t=e.target.value.map(e=>parseFloat(e));c(t)}else c(parseFloat(e.target.value))}else if("string"===A)e.target.value?c(e.target.value):c(null);else throw Error("Missing mapping in TableSelect")},[u,c,A]);return(0,i.tZ)(D.Z,{variant:"standard",inputRef:y,sx:{height:"100%"},open:p,disabled:l,multiple:u,onClose:g,onOpen:f,fullWidth:!0,inputProps:{sx:{height:"100% !important",display:"flex",alignItems:"center",padding:"0px 0 0px",background:"transparent !important"}},disableUnderline:!0,error:!!n,value:m?u?o.map(e=>e.toString()):o:u?[]:"",onChange:b,renderValue:e=>u&&Array.isArray(e)?(0,i.tZ)(ig,{value:e,name:t,enumValues:r,size:a?"small":"regular"}):(0,i.tZ)(r6,{enumKey:e,enumValues:r,small:a}),children:r5(r).map(e=>{let n=e.id,l=(0,i.tZ)(r6,{enumKey:n,enumValues:r,small:!0});return u?(0,i.BX)(k.Z,{value:n,disabled:r8(e),dense:!0,children:[(0,i.tZ)(P.Z,{checked:Array.isArray(o)&&o.map(e=>e.toString()).includes(n.toString())}),(0,i.tZ)(S.Z,{primary:l})]},`select-${t}-${n}`):(0,i.tZ)(k.Z,{value:n,disabled:r8(e),dense:!0,children:l},`select-${t}-${n}`)})},`table_select_${t}`)}function ou(e){let{align:t,value:r,updateValue:n,focused:o,disabled:l}=e,a=r&&"number"==typeof r?r.toString():"",[d,c]=(0,s.useState)(a),u=(0,s.useRef)(r);(0,s.useEffect)(()=>{u.current!==r&&String(r)!==d&&c(r?r.toString():null),u.current=r},[r]);let A=s.useCallback(()=>{if(d!==a){if(null!=d){let e=parseFloat(d);isNaN(e)||null==e||n(e)}else n(null)}},[d,r]);iN(d,A,!o,2e3),(0,s.useEffect)(()=>{o||a===d||c(null!=r?r.toString():null)},[r,o]);let p=s.createRef();(0,s.useEffect)(()=>{p.current&&o&&p.current.focus({preventScroll:!0})},[o,p]);let h=/^-?[0-9]+[,.]?[0-9]*$/;return(0,i.tZ)(j.Z,{inputRef:p,sx:{width:"100%",fontSize:"unset",fontFamily:"unset",background:"unset",border:"unset",resize:"none",outline:"none",padding:0,margin:0,color:"unset",fontWeight:"unset",lineHeight:"unset",textAlign:"right"},inputProps:{style:{textAlign:t}},disabled:l,disableUnderline:!0,value:d??"",onFocus:()=>{e.setFocused(!0)},onBlur:()=>{A(),e.setFocused(!1)},onChange:e=>{let t=e.target.value.replace(",",".");0===t.length&&c(null),(h.test(t)||t.startsWith("-"))&&c(t)}})}function oA(e){let{disabled:t,internalValue:r,updateValue:n,focused:o}=e,l=s.createRef();return(0,s.useEffect)(()=>{l.current&&o&&l.current.focus({preventScroll:!0})},[o,l]),(0,i.tZ)(T.Z,{inputRef:l,color:"secondary",checked:!!r,disabled:t,onChange:e=>{let t=e.target.checked;n(t)}})}function op(e){let{disabled:t,error:r,mode:n,internalValue:o,updateValue:l}=e;return(0,i.tZ)(void 0===n||"date_time"===n?tM.x:tP.M,{value:o??null,disabled:t,onChange:e=>{l(e)},renderInput:e=>(0,i.tZ)(z.Z,{...e,fullWidth:!0,variant:"standard",error:!!r,style:{height:"100%"},InputProps:{...e.InputProps,style:{fontSize:14},disableUnderline:!0,endAdornment:(0,i.tZ)(c.Z,{sx:{pr:1},children:e.InputProps?.endAdornment})}}),InputAdornmentProps:{style:{fontSize:"small",height:26}}})}function oh(e){let{name:t,internalValue:r,updateValue:n,multiselect:o,path:l,size:a,previewProperties:d,title:u,disabled:A,forceFilter:p}=e,[h,f]=(0,s.useState)(!1),g=(0,s.useCallback)(()=>f(!0),[]),m=(0,s.useCallback)(()=>f(!1),[]),y=rp().getCollection(l);if(!y)throw Error(`Couldn't find the corresponding collection view for the path: ${l}`);let b=(0,s.useCallback)(e=>{n(e?iH(e):null)},[n]),Z=(0,s.useCallback)(e=>{n(e.map(e=>iH(e)))},[n]),v=r?Array.isArray(r)?r.map(e=>e.id):r.id?[r.id]:[]:[],x=rM({multiselect:o,path:l,collection:y,onMultipleEntitiesSelected:Z,onSingleEntitySelected:b,selectedEntityIds:v,forceFilter:p}),w=(0,s.useCallback)(()=>{A||x.open()},[A,x]),B=!r||Array.isArray(r)&&0===r.length;return y?(0,i.BX)(c.Z,{sx:{width:"100%"},onMouseEnter:g,onMouseMove:g,onMouseLeave:m,children:[r&&!o&&(r instanceof rY?(0,i.tZ)(ia,{onClick:A?void 0:w,size:rH(a),reference:r,onHover:h,disabled:!l,previewProperties:d}):(0,i.tZ)(rz,{error:"Data is not a reference"})),r&&o&&(Array.isArray(r)?(0,i.tZ)(i.HY,{children:r.map((e,r)=>(0,i.tZ)(c.Z,{sx:{m:.5,width:"100%"},children:(0,i.tZ)(ia,{onClick:A?void 0:w,size:"tiny",reference:e,onHover:h,disabled:!l,previewProperties:d})},`preview_array_ref_${t}_${r}`))}):(0,i.tZ)(rz,{error:"Data is not an array of references"})),B&&(0,i.BX)(C.Z,{onClick:w,size:"small",variant:"outlined",color:"primary",children:["Edit ",u]})]}):(0,i.tZ)(rz,{error:"The specified collection does not exist"})}let of=e=>({transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms",position:"relative",height:"100%",width:"100%",outline:0,display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:e?"start":"center",alignItems:"center",border:"2px solid",borderColor:"transparent"}),og=e=>({background:(e.palette.mode,"repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important"),borderRadius:`${e.shape.borderRadius}px`,border:"2px solid",borderColor:"transparent"}),om=e=>({background:"repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important",borderColor:e.palette.success.light,border:"2px solid"}),oy=e=>({borderColor:e.palette.error.light,border:"2px solid"});function ob(e){let{propertyKey:t,error:r,value:n,disabled:o,property:l,entity:a,path:s,previewSize:d,updateValue:c}=e,u=rv(),{internalValue:A,setInternalValue:p,onFilesAdded:h,storage:f,onFileUploadComplete:g,storagePathBuilder:m,multipleFilesSupported:y}=nr({entityValues:a.values,entityId:a.id,path:s,property:l,propertyKey:t,storageSource:u,onChange:c,value:n,disabled:o});return(0,i.tZ)(oZ,{internalValue:A,setInternalValue:p,name:t,disabled:o,autoFocus:!1,property:l,onChange:c,entity:a,storagePathBuilder:m,storage:f,multipleFilesSupported:y,onFilesAdded:h,onFileUploadComplete:g,previewSize:d})}function oZ({property:e,name:t,internalValue:r,setInternalValue:n,entity:o,onChange:l,multipleFilesSupported:a,previewSize:d,disabled:h,autoFocus:f,storage:g,onFilesAdded:m,onFileUploadComplete:y,storagePathBuilder:b}){let[Z,v]=(0,s.useState)(!1),x=a&&"regular"===d?"small":d;if(a){if(Array.isArray(e.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(e.of){if("string"!==e.of.dataType)throw Error("Storage field using array must be of data type string")}else throw Error("Storage field using array must be of data type string")}let w=g?.metadata,C=rx(),{open:B,getRootProps:k,getInputProps:E,isDragActive:S,isDragAccept:I,isDragReject:F}=(0,tf.uI)({accept:g.acceptedFiles?g.acceptedFiles.map(e=>({[e]:[]})).reduce((e,t)=>({...e,...t}),{}):void 0,disabled:h,maxSize:g.maxSize,noClick:!0,noKeyboard:!0,onDrop:m,onDropRejected:(e,t)=>{for(let t of e)for(let e of t.errors)C.open({type:"error",message:`Error uploading file: File is larger than ${g.maxSize} bytes`})}}),{...R}=k(),Q=a?"Drag 'n' drop some files here, or click here to edit":"Drag 'n' drop a file here, or click here edit",D=a?e.of:e,P=(0,s.useMemo)(()=>rW(x),[x]),M=(0,A.Z)();return(0,i.BX)(c.Z,{...R,onMouseEnter:()=>v(!0),onMouseMove:()=>v(!0),onMouseLeave:()=>v(!1),sx:{...of(!!r),...S?og(M):{},...I?om(M):{},...F?oy(M):{}},children:[(0,i.tZ)("input",{autoFocus:f,...E()}),r.map((e,t)=>{let r;return e.storagePathOrDownloadUrl?r=(0,i.tZ)(ov,{property:D,value:e.storagePathOrDownloadUrl,entity:o,size:x},`storage_preview_${t}`):e.file&&(r=(0,i.tZ)(ns,{entry:e,metadata:w,storagePath:b(e.file),onFileUploadComplete:y,imageSize:P,simple:!0},`storage_progress_${t}`)),r}),!r&&(0,i.tZ)(c.Z,{sx:{flexGrow:1,m:2,maxWidth:200},onClick:B,children:(0,i.tZ)(u.Z,{sx:{color:e=>"light"===e.palette.mode?"#999":"#444"},variant:"body2",align:"center",children:Q})}),Z&&(0,i.tZ)(p.Z,{color:"inherit",size:"small",onClick:B,sx:{position:"absolute",bottom:2,right:2},children:(0,i.tZ)(tq.Z,{sx:{width:16,height:16,fill:"#888"}})})]})}function ov({property:e,value:t,size:r,entity:n}){return(0,i.tZ)(c.Z,{m:1,position:"relative",children:t&&(0,i.tZ)(i4,{children:(0,i.tZ)(iF,{propertyKey:"ignore",value:t,property:e,entity:n,size:r})})})}function ox(e){switch(e){case"xl":return 400;case"l":return 280;case"m":return 140;case"s":return 80;case"xs":return 54;default:throw Error("Missing mapping for collection size -> height")}}let ow=(0,tg.Z)("div",{})(({theme:e,justifyContent:t,padding:r,border:i,alignItems:n,backgroundColor:o})=>({alignItems:n,backgroundColor:o,padding:r,border:i,justifyContent:t,display:"flex",position:"relative",height:"100%",borderRadius:"4px",overflow:"hidden",contain:"content",transition:"border-color 200ms ease-in-out, background-color 500ms ease"})),oC=(0,tg.Z)("div",{})(({theme:e,justifyContent:t,scrollable:r,faded:i,fullHeight:n})=>({display:"flex",maxHeight:"100%",width:"100%",flexDirection:"column",height:n?"100%":void 0,justifyContent:t,overflow:r?"auto":void 0,WebkitMaskImage:i?"linear-gradient(to bottom, black 60%, transparent 100%)":void 0,maskImage:i?"linear-gradient(to bottom, black 60%, transparent 100%)":void 0,alignItems:i||r?"start":void 0})),oB=s.memo(function({children:e,focused:t,size:r,selected:n,disabled:o,disabledTooltip:l,saved:a,selectedRow:u,error:h,align:f,allowScroll:g,openPopup:m,removePadding:y,fullHeight:b,onSelect:Z,width:v,showExpandIcon:x=!0}){let w,C;let[B,k]=(0,tl.Z)(),E=(0,A.Z)(),S=s.createRef(),[I,F]=(0,s.useState)(!1),R=(0,s.useMemo)(()=>ox(r),[r]),[Q,D]=(0,s.useState)(!1),[P,M]=(0,s.useState)(a),T=!o&&h,V=s.createRef();(0,s.useEffect)(()=>{V.current&&t&&V.current.focus({preventScroll:!0})},[t]),(0,s.useEffect)(()=>{a&&M(!0);let e=setTimeout(()=>{M(!1)},800);return()=>{clearTimeout(e)}},[a]);let z=E.spacing(0);if(!y)switch(r){case"l":case"xl":z=E.spacing(2);break;case"m":z=E.spacing(1);break;case"s":z=E.spacing(.5);break;default:z=E.spacing(.25)}switch(f){case"right":w="flex-end";break;case"center":w="center";break;default:w="flex-start"}let Y=(0,s.useCallback)(()=>{if(m){let e=S&&S?.current?.getBoundingClientRect();m(e)}},[S]),G=(0,s.useCallback)(e=>{3===e.detail&&Y()},[Y]),O=(0,s.useCallback)(()=>{if(!Z)return;let e=S&&S?.current?.getBoundingClientRect();o?Z(void 0):!n&&e&&Z(e)},[S,Z,n,o]),H=(0,s.useCallback)(e=>{O(),e.stopPropagation()},[O]);(0,s.useEffect)(()=>{if(k){let e=k.height>R;I!==e&&F(e)}},[k,I,R]);let U=!T&&n;C=P?`2px solid ${E.palette.success.light}`:U?"2px solid #5E9ED6":T?`2px solid ${E.palette.error.light} !important`:"2px solid transparent";let j=!o&&g&&I,$=!o&&!g&&I,L=(0,s.useCallback)(()=>D(!0),[]),N=(0,s.useCallback)(()=>D(!1),[]);return(0,i.BX)(ow,{style:{width:v??"100%"},tabIndex:n||o?void 0:0,ref:S,onFocus:H,onClick:G,onMouseEnter:L,onMouseMove:L,onMouseLeave:N,padding:z,contain:j?"content":"size",border:C,justifyContent:w,alignItems:o||!I?"center":void 0,backgroundColor:Q&&!o?"dark"===E.palette.mode?(0,W.$n)(E.palette.background.paper,.03):(0,W._j)(E.palette.background.default,.02):U?"dark"===E.palette.mode?(0,W.$n)(E.palette.background.paper,.035):(0,W._j)(E.palette.background.default,.025):u||P?"dark"===E.palette.mode?(0,W.$n)(E.palette.background.paper,.022):(0,W._j)(E.palette.background.default,.008):void 0,children:[(0,i.BX)(i4,{children:[b&&!$&&e,(!b||$)&&(0,i.tZ)(oC,{fullHeight:b??!1,justifyContent:w,scrollable:j??!1,faded:$,children:!b&&(0,i.tZ)("div",{ref:B,style:{display:"flex",width:"100%",justifyContent:w,height:b?"100%":void 0},children:e})})]}),o&&Q&&l&&(0,i.tZ)(c.Z,{sx:{position:"absolute",top:4,right:4,fontSize:"14px"},children:(0,i.tZ)(d.Z,{title:l,children:(0,i.tZ)(t1.Z,{color:"disabled",fontSize:"inherit"})})}),(T||x)&&(0,i.BX)(c.Z,{sx:{position:"absolute",top:"2px",right:"2px"},children:[n&&!o&&x&&(0,i.tZ)(p.Z,{ref:V,color:"inherit",size:"small",onClick:Y,children:(0,i.BX)("svg",{className:"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall",fill:"#888",width:"20",height:"20",viewBox:"0 0 24 24",children:[(0,i.tZ)("path",{className:"cls-2",d:"M20,5a1,1,0,0,0-1-1L14,4h0a1,1,0,0,0,0,2h2.57L13.29,9.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L18,7.42V10a1,1,0,0,0,1,1h0a1,1,0,0,0,1-1Z"}),(0,i.tZ)("path",{className:"cls-2",d:"M10.71,13.29a1,1,0,0,0-1.42,0L6,16.57V14a1,1,0,0,0-1-1H5a1,1,0,0,0-1,1l0,5a1,1,0,0,0,1,1h5a1,1,0,0,0,0-2H7.42l3.29-3.29A1,1,0,0,0,10.71,13.29Z"})]})}),T&&(0,i.tZ)(rV,{arrow:!0,placement:"left",title:T.message,children:(0,i.tZ)(t0.Z,{fontSize:"inherit",color:"error"})})]})]})},(e,t)=>e.error===t.error&&e.value===t.value&&e.disabled===t.disabled&&e.saved===t.saved&&e.allowScroll===t.allowScroll&&e.align===t.align&&e.size===t.size&&e.disabledTooltip===t.disabledTooltip&&e.width===t.width&&e.focused===t.focused&&e.showExpandIcon===t.showExpandIcon&&e.removePadding===t.removePadding&&e.fullHeight===t.fullHeight&&e.selected===t.selected&&e.selectedRow===t.selectedRow),ok=s.memo(function({propertyKey:e,columnIndex:t,customFieldValidator:r,value:n,property:o,align:l,width:a,height:d,collection:c,path:u,entity:A,readonly:p}){let h=ru(),f=rk(),{onValueChange:g,size:m,selectedCell:y,focused:b,setFocused:Z,select:v,setPopupCell:x,selectedEntityIds:w}=o7(),C=w?.includes(A.id)??!1,B=y?.columnIndex===t&&y?.entity.path===A.path&&y?.entity.id===A.id,[k,E]=(0,s.useState)(n),S=(0,s.useRef)(n),[I,F]=(0,s.useState)(),[R,Q]=(0,s.useState)(!1),D=(0,s.useCallback)(()=>{Q(!0),setTimeout(()=>{Q(!1)},100)},[]),P=!!o.Field,M=!!o.Preview,T=iV(o),V="object"==typeof o.disabled?o.disabled.disabledMessage:void 0,z=!!o.disabled,Y=(0,s.useMemo)(()=>nG({property:o,entityId:A.id,customFieldValidator:r,name:e}),[A.id,o,e]);(0,s.useEffect)(()=>{eY()(n,S.current)||(F(void 0),E(n),S.current=n,D())},[D,n]);let G=(0,s.useCallback)(t=>{Q(!1),Y.validate(t).then(()=>{F(void 0),g&&g({value:t,propertyKey:e,setError:F,onValueUpdated:D,entity:A,fullPath:u,collection:c,dataSource:h,context:f})}).catch(e=>{F(e)})},[A,g,e,Y]);(0,s.useEffect)(()=>{Y.validate(k).then(()=>F(void 0)).catch(e=>{F(e)})},[k,Y]);let O=(0,s.useCallback)(e=>{let t;t=void 0===e?null:e,S.current=t,E(t),G(t)},[G]);rR({property:o,value:k,setValue:O});let W=(0,s.useCallback)(r=>{v(r?{columnIndex:t,width:a,height:d,entity:A,cellRect:r,propertyKey:e,collection:c}:void 0)},[c,t,A,d,e,v,a]),H=(0,s.useCallback)(r=>{x(r?{columnIndex:t,width:a,height:d,entity:A,cellRect:r,propertyKey:e,collection:c}:void 0)},[c,t,A,d,e,a]),U,j=!1,$=!1,L=!1,N=!1;if(p||T)return(0,i.tZ)(oB,{size:m,width:a,focused:b,saved:R,selectedRow:C,value:k,align:l??"left",fullHeight:!0,disabledTooltip:V??(T?"Read only":void 0),disabled:!0,children:(0,i.tZ)(iF,{width:a,height:ox(m),propertyKey:e,property:o,entity:A,value:n,size:rH(m)})},`${e}_${A.path}_${A.id}`);if(!P&&(!M||B)){if("string"===o.dataType&&o.storage||"array"===o.dataType&&!Array.isArray(o.of)&&o.of?.dataType==="string"&&o.of?.storage)U=(0,i.tZ)(ob,{error:I,disabled:z,focused:b,property:o,entity:A,path:u,value:k,previewSize:rH(m),updateValue:O,propertyKey:e}),$=!0,N=!0,L=!0;else if(B&&"number"===o.dataType)o.enumValues?(U=(0,i.tZ)(oc,{name:e,multiple:!1,disabled:z,focused:b,valueType:"number",small:"regular"!==rH(m),enumValues:o.enumValues,error:I,internalValue:k,updateValue:O}),N=!0):(U=(0,i.tZ)(ou,{align:l,error:I,focused:b,setFocused:Z,disabled:z,value:k,updateValue:O}),j=!0);else if(B&&"string"===o.dataType){if(o.enumValues)U=(0,i.tZ)(oc,{name:e,multiple:!1,focused:b,disabled:z,valueType:"string",small:"regular"!==rH(m),enumValues:o.enumValues,error:I,internalValue:k,updateValue:O}),N=!0;else if(!o.storage){let e=!!o.multiline||!!o.markdown;U=(0,i.tZ)(od,{error:I,disabled:z,multiline:e,setFocused:Z,focused:b,value:k,updateValue:O}),j=!0}}else if("boolean"===o.dataType)U=(0,i.tZ)(oA,{error:I,disabled:z,focused:b&&B,internalValue:k,updateValue:O});else if("date"===o.dataType)U=(0,i.tZ)(op,{name:e,error:I,disabled:z,mode:o.mode,focused:b,internalValue:k,updateValue:O}),j=!0;else if("reference"===o.dataType)"string"==typeof o.path&&(U=(0,i.tZ)(oh,{name:e,internalValue:k,updateValue:O,disabled:z,size:m,path:o.path,multiselect:!1,previewProperties:o.previewProperties,title:o.name,forceFilter:o.forceFilter})),j=!1;else if("array"===o.dataType){if(!o.of&&!o.oneOf)throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${e}`);o.of&&!Array.isArray(o.of)&&("string"===o.of.dataType||"number"===o.of.dataType?B&&o.of.enumValues&&(U=(0,i.tZ)(oc,{name:e,multiple:!0,disabled:z,focused:b,small:"regular"!==rH(m),valueType:o.of.dataType,enumValues:o.of.enumValues,error:I,internalValue:k,updateValue:O}),j=!0,N=!0):"reference"===o.of.dataType&&("string"==typeof o.of.path&&(U=(0,i.tZ)(oh,{name:e,disabled:z,internalValue:k,updateValue:O,size:m,multiselect:!0,path:o.of.path,previewProperties:o.of.previewProperties,title:o.of.name,forceFilter:o.of.forceFilter})),j=!1))}}return U||(j=!1,$=B&&!U&&!z&&!T,U=(0,i.tZ)(iF,{width:a,height:d,entity:A,propertyKey:e,value:k,property:o,size:rH(m)})),(0,i.tZ)(oB,{size:m,width:a,focused:b,onSelect:W,selected:B,selectedRow:C,disabled:z||T,disabledTooltip:V??"Disabled",removePadding:L,fullHeight:N,saved:R,error:I,align:l,allowScroll:j,showExpandIcon:$,openPopup:z?void 0:H,value:k,children:U},`cell_${e}_${A.path}_${A.id}`)},function(e,t){return e.height===t.height&&e.propertyKey===t.propertyKey&&e.align===t.align&&e.width===t.width&&eY()(e.property,t.property)&&eY()(e.value,t.value)&&eY()(e.entity.values,t.entity.values)}),oE=({onResize:e})=>{let t=(0,s.useRef)(0),r=(0,s.useRef)(null),n=(0,s.useRef)(e);n.current=e;let o=(0,s.useCallback)(e=>{t.current&&cancelAnimationFrame(t.current),t.current=requestAnimationFrame(()=>{n.current(e)})},[]),l=(0,s.useCallback)(()=>{let e=r.current;e&&e.contentDocument&&e.contentDocument.defaultView&&e.contentDocument.defaultView.addEventListener("resize",o)},[o]);return(0,s.useEffect)(()=>{let e=r.current;return()=>{e&&e.contentDocument&&e.contentDocument.defaultView&&e.contentDocument.defaultView.removeEventListener("resize",o)}},[o]),(0,i.tZ)("object",{onLoad:l,ref:r,tabIndex:-1,type:"text/html",data:"about:blank",title:"",style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none",zIndex:-1,opacity:0}})};function oS({children:e,position:t="sticky",maxWidth:r,translucent:n=!0}){return(0,i.tZ)(c.Z,{sx:e=>({background:n?"light"===e.palette.mode?"rgba(255,255,255,0.6)":(0,W.Fq)(e.palette.background.paper,.1):void 0,backdropFilter:n?"blur(8px)":void 0,borderTop:`1px solid ${e.palette.divider}`,py:1,px:2,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",position:t,bottom:0,right:0,left:0,textAlign:"right",zIndex:2,"& > *:not(:last-child)":{[e.breakpoints.down("md")]:{mr:e.spacing(1)},mr:e.spacing(2)}}),children:r?(0,i.tZ)($.Z,{maxWidth:r,children:e}):e})}function oI(e){return e.open?(0,i.tZ)(oF,{...e}):null}function oF({tableKey:e,entity:t,customFieldValidator:r,propertyKey:n,collection:o,path:l,cellRect:a,open:d,onClose:A,columnIndex:h,onCellValueChange:f}){let g=ru(),m=rk(),[y,b]=s.useState(),[Z,v]=(0,s.useState)(),[x,w]=(0,s.useState)(t?.values),B=o?nU({collection:o,path:l,values:x,entityId:t?.id,fields:m.fields}):void 0,k=function(){let[e,t]=(0,s.useState)({width:0,height:0});return(0,s.useLayoutEffect)(()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}(),E=s.useRef(null),S=s.useRef(null),I=s.useRef(!1);(function({containerRef:e,innerRef:t,x:r,y:i,onMove:n}){let o=0,l=0,a=s.useRef(!1),d=t=>{if(0!==t.button||!e.current||t.defaultPrevented||t.innerClicked)return;let{x:r,y:i}=e.current.getBoundingClientRect();o=t.screenX-r,l=t.screenY-i,document.addEventListener("mousemove",p),document.addEventListener("mouseup",A),document.addEventListener("selectstart",u),a.current=!0},c=e=>{e.innerClicked=!0},u=e=>{e.preventDefault(),e.stopPropagation()},A=e=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",A),document.removeEventListener("selectstart",u),e.stopPropagation(),a.current=!1},p=e=>{"input"!==e.target.localName&&a.current&&(n(e.screenX-o,e.screenY-l),e.stopPropagation())},h=()=>{e.current&&(e.current.style.top=`${i}px`,e.current.style.left=`${r}px`)};(0,s.useEffect)(()=>{let r=e.current,i=t.current;if(!(!r||!i))return i&&i.addEventListener("mousedown",c),r&&r.addEventListener("mousedown",d),h(),()=>{r&&r.removeEventListener("mousedown",d),i&&i.removeEventListener("mousedown",c)}})})({containerRef:E,innerRef:S,x:Z?.x,y:Z?.y,onMove:(e,t)=>M({x:e,y:t})}),(0,s.useEffect)(()=>{I.current=!1},[n,t]);let F=(0,s.useCallback)(()=>{if(!a)throw Error("getInitialLocation error");return{x:a.left<k.width-a.right?a.x+a.width/2:a.x-a.width/2,y:a.top<k.height-a.bottom?a.y+a.height/2:a.y-a.height/2}},[a,k.height,k.width]),R=(0,s.useCallback)(({x:e,y:t})=>{let r=E.current?.getBoundingClientRect();if(!r)throw Error("normalizePosition called before draggableBoundingRect is set");return{x:Math.max(0,Math.min(e,k.width-r.width)),y:Math.max(0,Math.min(t,k.height-r.height))}},[k]),Q=(0,s.useCallback)(e=>{let t=E.current?.getBoundingClientRect();if(!a||!t)return;let r=R(e??F());Z&&r.x===Z.x&&r.y===Z.y||v(r)},[a,F,R,Z]);(0,s.useEffect)(()=>{I.current=!1},[n]),(0,s.useLayoutEffect)(()=>{let e=E.current?.getBoundingClientRect();a&&e&&!I.current&&(Q(),I.current=!0)},[a,Q,I.current]),(0,s.useLayoutEffect)(()=>{Q(Z)},[k,a]);let D=(0,s.useMemo)(()=>{if(!(!B||!t))return nY(t.id,n&&B.properties[n]?{[n]:B.properties[n]}:{},r)},[l,n,B,t]),P=(0,s.useCallback)(()=>Q(Z),[Z,Q]),M=(0,s.useCallback)(e=>Q(e),[Q]),T=async e=>(b(null),o&&t&&f&&n?f({value:e[n],propertyKey:n,entity:t,setError:b,onValueUpdated:()=>{},fullPath:l,collection:o,dataSource:g,context:m}):Promise.resolve());if(!t)return(0,i.tZ)(i.HY,{});let V=t&&(0,i.BX)(c.Z,{sx:e=>({overflow:"auto",borderRadius:`${e.shape.borderRadius}px`,backgroundColor:e.palette.background.paper,visibility:d?void 0:"hidden",cursor:"grab"}),children:[(0,i.tZ)(te.J9,{initialValues:t?.values??{},validationSchema:D,validateOnMount:!0,validate:e=>console.debug("Validating",e),onSubmit:(e,t)=>{T(e).then(()=>A()).finally(()=>t.setSubmitting(!1))},children:({handleChange:r,values:o,errors:a,touched:u,dirty:A,setFieldValue:p,setFieldTouched:f,handleSubmit:g,isSubmitting:y})=>{if((0,s.useEffect)(()=>{eY()(o,x)||w(o)},[o]),!t)return(0,i.tZ)(rz,{error:"PopupFormField misconfiguration"});if(!B)return(0,i.tZ)(i.HY,{});let b={collection:B,entityId:t.id,values:o,path:l,setFieldValue:p},Z=n&&B.properties[n],v=n&&Z?{propertyKey:n,disabled:y||iV(Z)||!!Z.disabled,property:Z,includeDescription:!1,underlyingValueHasChanged:!1,context:b,tableMode:!0,partOfArray:!1,autoFocus:d}:void 0,k=(0,i.tZ)(i.HY,{children:(0,i.tZ)(c.Z,{sx:{width:520,maxWidth:"100vw",maxHeight:"85vh"},children:(0,i.BX)(te.l0,{onSubmit:g,noValidate:!0,children:[(0,i.tZ)(c.Z,{sx:{mb:1,padding:2,display:"flex",flexDirection:"column",position:"relative"},children:(0,i.tZ)(c.Z,{ref:S,sx:{cursor:"auto !important"},children:v&&(0,i.tZ)(i3,{...v})})}),(0,i.tZ)(oS,{children:(0,i.tZ)(C.Z,{variant:"contained",color:"primary",type:"submit",disabled:y,children:"Save"})})]})},`popup_form_${e}_${t.id}_${h}`)}),E=m.plugins;return E&&E.forEach(e=>{e.form?.provider&&(k=(0,i.tZ)(e.form.provider.Component,{status:"existing",path:l,collection:B,entity:t,context:m,currentEntityId:t.id,formContext:b,...e.form.provider.props,children:k}))}),k}}),y&&(0,i.tZ)(u.Z,{color:"error",children:y.message})]}),z=(0,i.BX)(c.Z,{sx:e=>({display:"inline-block",position:"fixed",zIndex:1300,boxShadow:"0 0 0 2px rgba(128,128,128,0.2)",backgroundColor:e.palette.background.paper,borderRadius:`${e.shape.borderRadius}px`,visibility:d?void 0:"hidden",cursor:"grab"}),ref:E,children:[(0,i.tZ)(oE,{onResize:P}),(0,i.BX)(c.Z,{sx:{overflow:"hidden"},children:[V,(0,i.tZ)(c.Z,{sx:{position:"absolute",top:-14,right:-14,backgroundColor:"#888",borderRadius:"32px"},children:(0,i.tZ)(p.Z,{size:"small",onClick:e=>{e.stopPropagation(),A()},children:(0,i.tZ)(ts.Z,{sx:{color:"white"},fontSize:"small"})})})]})]},`draggable_${n}_${t.id}_${d}`);return(0,i.tZ)(L.Z,{container:document.body,children:z})}function oR(e){return(0,i.tZ)(c.Z,{sx:{display:"flex",width:"100vw",maxHeight:"100%",maxWidth:"100%",height:"100vh","@supports (height: 100dvh)":{height:"100dvh"}},children:(0,i.tZ)(c.Z,{m:"auto",children:(0,i.tZ)(N.Z,{...e})})})}let oQ=s.memo(function({resizeHandleRef:e,columnIndex:t,isResizingIndex:r,sort:n,onColumnSort:o,onFilterUpdate:l,filter:a,column:d,onClickResizeColumn:u,createFilterField:A}){let h=(0,s.useRef)(null),[f,g]=(0,s.useState)(!1),[m,y]=s.useState(!1),b=(0,s.useCallback)(e=>{y(!0)},[]);(0,s.useCallback)(()=>{y(!1)},[]);let v=(0,s.useCallback)((e,t)=>{l(d,e),void 0!==t&&y(t)},[d,l]),x=r===t,w=!(r!==t&&r>0)&&(f||x);return(0,i.BX)(i4,{children:[(0,i.BX)(Z.ZP,{sx:e=>({width:d.width,padding:"0px 12px",color:w?e.palette.text.primary:e.palette.text.secondary,backgroundColor:w?(0,W._j)(e.palette.background.default,.05):e.palette.background.default,transition:"color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",height:"100%",fontSize:"0.750rem",textTransform:"uppercase",fontWeight:600,position:d.frozen?"sticky":"relative",left:d.frozen?0:void 0,zIndex:d.frozen?1:0,userSelect:"none"}),ref:h,wrap:"nowrap",alignItems:"center",onMouseEnter:()=>g(!0),onMouseMove:()=>g(!0),onMouseLeave:()=>g(!1),container:!0,children:[(0,i.tZ)(Z.ZP,{item:!0,xs:!0,sx:{overflow:"hidden",flexShrink:1},children:(0,i.BX)(c.Z,{sx:{display:"flex",justifyContent:d.headerAlign,alignItems:"center",flexDirection:"row"},children:[(0,i.tZ)(c.Z,{sx:{paddingTop:"4px"},children:d.icon&&d.icon(f||m)}),(0,i.tZ)(c.Z,{sx:{display:"-webkit-box",margin:"0px 4px",overflow:"hidden",justifyContent:d.align,WebkitLineClamp:2,WebkitBoxOrient:"vertical",textOverflow:"ellipsis"},children:d.title})]})}),d.sortable&&(n||w||m)&&(0,i.tZ)(Z.ZP,{item:!0,children:(0,i.tZ)(X.Z,{color:"secondary",variant:"dot",overlap:"circular",invisible:!n,children:(0,i.BX)(p.Z,{size:"small",sx:e=>({backgroundColor:"light"===e.palette.mode?"#f5f5f5":e.palette.background.default}),onClick:()=>{o(d.key)},children:[!n&&(0,i.tZ)(tS.Z,{fontSize:"small"}),"asc"===n&&(0,i.tZ)(tS.Z,{fontSize:"small"}),"desc"===n&&(0,i.tZ)(tI.Z,{fontSize:"small"})]})})}),d.filter&&(0,i.tZ)(Z.ZP,{item:!0,children:(0,i.tZ)(X.Z,{color:"secondary",variant:"dot",overlap:"circular",invisible:!a,children:(0,i.tZ)(p.Z,{sx:e=>({backgroundColor:"light"===e.palette.mode?"#f5f5f5":e.palette.background.default}),size:"small",onClick:b,children:(0,i.tZ)(tF.Z,{fontSize:"small",color:f||m?void 0:"disabled"})})})}),d.resizable&&(0,i.tZ)(c.Z,{ref:e,sx:e=>({position:"absolute",height:"100%",width:"4px",top:0,right:0,cursor:"col-resize",backgroundColor:w?"dark"===e.palette.mode?(0,W.$n)(e.palette.background.default,.1):(0,W._j)(e.palette.background.default,.15):void 0}),onMouseDown:u?()=>u(t,d):void 0})]}),d.filter&&A&&(0,i.tZ)(oD,{column:d,filter:a,onHover:f,onFilterUpdate:v,createFilterField:A,popupOpen:m,setPopupOpen:y,anchorEl:h})]})},eY());function oD({column:e,onFilterUpdate:t,filter:r,onHover:n,createFilterField:o,popupOpen:l,setPopupOpen:a,anchorEl:d}){let u=e.key,[A,p]=(0,s.useState)(r);if((0,s.useEffect)(()=>{p(r)},[r]),!e.filter)return null;let h=!!r,f=o({id:u,filterValue:A,setFilterValue:p,column:e,popupOpen:l,setPopupOpen:a});return f?(0,i.tZ)(_.ZP,{id:`popover_${e.key}`,open:l,elevation:3,anchorEl:d.current,onClose:()=>a(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,i.BX)(c.Z,{sx:e=>({}),children:[(0,i.tZ)(c.Z,{sx:e=>({p:2,fontSize:"0.750rem",fontWeight:600,textTransform:"uppercase"}),children:e.title??u}),(0,i.tZ)(w.Z,{}),f&&(0,i.tZ)(c.Z,{p:2,children:f}),(0,i.BX)(c.Z,{display:"flex",justifyContent:"flex-end",m:2,children:[(0,i.tZ)(c.Z,{mr:1,children:(0,i.tZ)(C.Z,{disabled:!h,color:"primary",type:"reset","aria-label":"filter clear",onClick:e=>{t(void 0,!1)},children:"Clear"})}),(0,i.tZ)(C.Z,{variant:"outlined",color:"primary",onClick:()=>{t(A,!1)},children:"Filter"})]})]})}):null}let oP=({columns:e,currentSort:t,onColumnSort:r,onFilterUpdate:n,sortByProperty:o,filter:l,onColumnResize:a,onColumnResizeEnd:d,createFilterField:u})=>{let A=e.map(()=>(0,s.createRef)()),[p,h]=(0,s.useState)(-1),f=(0,s.useCallback)((t,r,i)=>{let n=e[t],o=r>800?800:r<100?100:r,l={width:o,key:n.key,column:{...n,width:o}};i?d(l):a(l)},[e,a,d]),g=(0,s.useCallback)(e=>{if(p>=0){let t=A[p].current?.parentElement?.getBoundingClientRect().left;return t?e.clientX-t:void 0}},[A,p]),m=(0,s.useCallback)(e=>{document.body.style.cursor=e?"col-resize":"auto"},[]),y=(0,s.useCallback)(e=>{e.stopPropagation(),e.preventDefault();let t=g(e);t&&f(p,t,!1)},[f,g,p]),b=(0,s.useCallback)(e=>{e.stopPropagation(),e.preventDefault();let t=g(e);t&&f(p,t,!0),h(-1),m(!1)},[f,g,p,m]),Z=(0,s.useCallback)(()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b)},[y,b]),v=(0,s.useCallback)(()=>{document.addEventListener("mousemove",y),document.addEventListener("mouseup",b)},[y,b]);(0,s.useEffect)(()=>(p>=0?v():Z(),()=>{Z()}),[v,p,Z]);let x=(0,s.useCallback)(e=>{h(e),m(!0)},[m]);return(0,i.tZ)(c.Z,{sx:e=>({position:"sticky",minWidth:"100%",backgroundColor:e.palette.background.default,display:"flex",width:"fit-content",flexDirection:"row",top:0,left:0,zIndex:2,height:50,borderBottom:`1px solid ${e.palette.divider}`}),children:e.map((a,s)=>{let d=e[s],c=d&&l&&l[d.key]?l[d.key]:void 0;return(0,i.tZ)(i4,{children:(0,i.tZ)(oQ,{resizeHandleRef:A[s],columnIndex:s,isResizingIndex:p,onFilterUpdate:n,filter:c,sort:o===d.key?t:void 0,onColumnSort:r,onClickResizeColumn:x,column:d,createFilterField:u})},"header_"+d.key)})})},oM=(0,J.ZP)("div",{})(({theme:e,size:t,cursor:r,hovered:i})=>({display:"flex",minWidth:"100%",height:ox(t),cursor:r,flexDirection:"row",fontSize:"0.875rem",borderBottom:`1px solid ${e.palette.divider}`,backgroundColor:i?"dark"===e.palette.mode?(0,W.$n)(e.palette.background.paper,.01):"rgb(252, 252, 253)":void 0})),oT=s.memo(function({rowData:e,rowIndex:t,children:r,onRowClick:n,size:o,style:l,hoverRow:a}){let[d,c]=(0,s.useState)(!1),u=(0,s.useCallback)(r=>n?n({rowData:e,rowIndex:t,event:r}):void 0,[n,e,t]),A=(0,s.useCallback)(()=>c(!0),[]),p=(0,s.useCallback)(()=>c(!1),[]);return(0,i.tZ)(oM,{onClick:u,size:o,cursor:n?"pointer":void 0,hovered:a&&d,style:{...l,width:"fit-content"},onMouseEnter:A,onMouseMove:A,onMouseLeave:p,children:r})},eY()),oV=s.memo(function(e){return e.rowData&&e.cellRenderer({cellData:e.cellData,rowData:e.rowData,rowIndex:e.rowIndex,isScrolling:!1,column:e.column,columns:e.columns,columnIndex:e.columnIndex,width:e.column.width})},(e,t)=>eY()(e,t)),oz=(0,s.createContext)({});oz.displayName="VirtualListContext";let oY=(0,s.forwardRef)(({children:e,...t},r)=>(0,i.tZ)(oz.Consumer,{children:n=>{let o=n.customView;return(0,i.BX)(i.HY,{children:[(0,i.tZ)("div",{style:{position:"relative",height:"100%"},children:(0,i.BX)("div",{ref:r,...t,style:{...t?.style,minHeight:"100%",position:"relative"},children:[(0,i.tZ)(oP,{...n}),!o&&e]})}),o&&(0,i.tZ)("div",{style:{position:"sticky",top:"56px",flexGrow:1,height:"calc(100% - 56px)",marginTop:"calc(56px - 100vh)",left:0},children:o})]})}})),oG=s.memo(function({data:e,onResetPagination:t,onEndReached:r,size:n="m",columns:o,onRowClick:l,onColumnResize:a,filter:d,checkFilterCombination:A,onFilterUpdate:p,sortBy:h,error:f,emptyMessage:g,onSortByUpdate:m,loading:y,cellRenderer:b,hoverRow:Z,createFilterField:v}){let x=h?h[0]:void 0,w=h?h[1]:void 0,[C,B]=(0,s.useState)(o),k=(0,s.useRef)(null),E=(0,s.useRef)(0);(0,s.useEffect)(()=>{B(o)},[o]);let[S,I]=(0,tl.Z)(),F=(0,s.useCallback)(e=>{B(C.map(t=>t.key===e.column.key?e.column:t))},[C]),R=(0,s.useCallback)(e=>{B(C.map(t=>t.key===e.column.key?e.column:t)),a&&a(e)},[C,a]),Q=(0,s.useRef)();(0,s.useEffect)(()=>{Q.current=d},[d]);let D=(0,s.useCallback)(()=>{E.current=0,k.current&&k.current.scrollTo(k.current?.scrollLeft,0)},[]),P=(0,s.useCallback)(e=>{let r=x===e&&"desc"===w,i=x===e&&"asc"===w?"desc":r?void 0:"asc",n=r?void 0:e,o=Q.current,l=i&&n?[n,i]:void 0;o&&A&&!A(o,l)&&p&&p(void 0),t&&t(),m&&m(l),D()},[A,w,p,t,m,D,x]),M=(0,s.useCallback)(()=>{E.current=0,m&&m(void 0)},[m]),T=Math.max((e?.length??0)*ox(n)-I.height,0),V=(0,s.useCallback)(t=>{r&&(e?.length??0)>0&&t>E.current+500&&(E.current=t,r())},[e,r]),z=(0,s.useCallback)(({scrollOffset:e,scrollUpdateWasRequested:t})=>{!t&&e>=T-500&&V(e)},[T,V]),Y=(0,s.useCallback)((e,t)=>{E.current=0;let r=Q.current,i=r?{...r}:{};t?i[e.key]=t:delete i[e.key],!A||A(i,x&&w?[x,w]:void 0)||(i=t?{[e.key]:t}:{}),p&&p(i),e.key!==x&&M()},[A,w,p,M,x]),G=(0,s.useCallback)(()=>(0,i.BX)(c.Z,{sx:{height:"calc(100% - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"sticky",left:0},children:[(0,i.tZ)(u.Z,{variant:"h6",children:"Error fetching data from the data source"}),f?.message&&(0,i.tZ)(u.Z,{children:f?.message})]}),[f?.message]),O=(0,s.useCallback)(()=>y?(0,i.tZ)(oR,{}):(0,i.BX)(c.Z,{sx:{display:"flex",overflow:"auto",alignItems:"center",justifyContent:"center",p:2,gap:2,height:"100%"},children:[(0,i.tZ)(tk.Z,{}),(0,i.tZ)(u.Z,{children:g})]}),[g,y]),W=!y&&(e?.length??0)===0,H=f?G():W?O():void 0;return(0,i.tZ)(c.Z,{ref:S,sx:{height:"100%",width:"100%"},children:(0,i.tZ)(oz.Provider,{value:{data:e,size:n,cellRenderer:b,columns:C,currentSort:w,onRowClick:l,customView:H,onColumnResize:F,onColumnResizeEnd:R,filter:Q.current,onColumnSort:P,onFilterUpdate:Y,sortByProperty:x,hoverRow:Z??!1,createFilterField:v},children:(0,i.tZ)(oO,{outerRef:k,width:I.width,height:I.height,itemCount:e?.length??0,onScroll:z,itemSize:ox(n)},n)})})},eY());function oO({outerRef:e,width:t,height:r,itemCount:n,onScroll:o,itemSize:l}){let a=(0,s.useCallback)(({index:e,style:t})=>(0,i.tZ)(oz.Consumer,{children:({onRowClick:r,data:n,columns:o,size:l="m",cellRenderer:a,hoverRow:s})=>{let d=n&&n[e];return(0,i.tZ)(oT,{rowData:d,rowIndex:e,onRowClick:r,columns:o,hoverRow:s,style:{...t,top:`calc(${t.top}px + 50px)`},size:l,children:o.map((t,r)=>{let n=d&&d[t.key];return(0,i.tZ)(oV,{dataKey:t.key,cellRenderer:a,column:t,columns:o,rowData:d,cellData:n,rowIndex:e,columnIndex:r},`cell_${t.key}`)})},`row_${e}`)}}),[]);return(0,i.tZ)(tE.t7,{outerRef:e,innerElementType:oY,width:t,height:r,overscanCount:4,itemCount:n,onScroll:o,itemSize:l,children:a})}function oW({entity:e,width:t,frozen:r,isSelected:n,selectionEnabled:o,size:l,toggleEntitySelection:a,onCopyClicked:h,onEditClicked:f,onDeleteClicked:g,hideId:m}){let y=(0,A.Z)(),b=(0,K.Z)(y.breakpoints.up("md")),Z=!!f,x=!!h,w=!!g,[C,I]=s.useState(null),F=(0,s.useCallback)(e=>{I(e.currentTarget),e.stopPropagation()},[I]),R=(0,s.useCallback)(()=>{I(null)},[I]),Q=(0,s.useCallback)(t=>{a&&a(e),t.preventDefault(),t.stopPropagation()},[e,a]),D=(0,s.useCallback)(t=>{t.stopPropagation(),g&&g(e),I(null)},[e,g,I]),M=(0,s.useCallback)(t=>{t.stopPropagation(),h&&h(e),I(null)},[e,h,I]),T=(0,s.useCallback)(t=>{t.stopPropagation(),a&&a(e)},[e,a]);return(0,i.BX)(c.Z,{style:{width:t},onClick:T,sx:e=>({height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",position:r?"sticky":"initial",left:r?0:"initial",background:(e.palette.mode,(0,W.Fq)(e.palette.background.default,.96)),contain:"strict",zIndex:1}),children:[(Z||w||o)&&(0,i.BX)(c.Z,{sx:{minWidth:138,display:"flex",justifyContent:"center"},children:[Z&&(0,i.tZ)(d.Z,{title:`Edit ${e.id}`,children:(0,i.tZ)(p.Z,{onClick:t=>{t.stopPropagation(),f&&f(e)},size:b?"medium":"small",children:(0,i.tZ)(eD.Z,{})})}),o&&(0,i.tZ)(d.Z,{title:`Select ${e.id}`,children:(0,i.tZ)(P.Z,{size:b?"medium":"small",checked:n,onChange:Q})}),(x||w)&&(0,i.tZ)(p.Z,{onClick:F,size:b?"medium":"small",children:(0,i.tZ)(eQ.Z,{})}),(x||w)&&(0,i.BX)(B.Z,{anchorEl:C,open:!!C,onClose:R,elevation:3,children:[w&&(0,i.BX)(k.Z,{onClick:D,children:[(0,i.tZ)(E.Z,{children:(0,i.tZ)(eP.Z,{})}),(0,i.tZ)(S.Z,{primary:"Delete"})]}),x&&(0,i.BX)(k.Z,{onClick:M,children:[(0,i.tZ)(E.Z,{children:(0,i.tZ)(eM.Z,{})}),(0,i.tZ)(S.Z,{primary:"Copy"})]})]})]}),!m&&"xs"!==l&&(0,i.tZ)(c.Z,{sx:{width:138,textAlign:"center",textOverflow:"ellipsis",overflow:"hidden"},children:e?(0,i.BX)(u.Z,{className:"mono",variant:"caption",color:"textSecondary",children:[" ",e.id," "]}):(0,i.tZ)(v.Z,{variant:"text"})})]})}function oH({onTextSearch:e,placeholder:t="Search",expandable:r=!1,large:n=!1}){let[o,l]=(0,s.useState)(""),[a,d]=(0,s.useState)(!1),u=(0,s.useDeferredValue)(o);s.useEffect(()=>{e(u||void 0)},[u]);let A=(0,s.useCallback)(()=>{l(""),e(void 0)},[]);return(0,i.BX)(c.Z,{sx:e=>({position:"relative",display:"flex",alignItems:"center",height:n?56:40,width:r?void 0:"100%",minWidth:"200px",borderRadius:`${e.shape.borderRadius}px`,backgroundColor:"light"===e.palette.mode?(0,W._j)(e.palette.background.default,.05):(0,W._j)(e.palette.background.default,.2),"&:hover":{backgroundColor:"light"===e.palette.mode?(0,W._j)(e.palette.background.default,.08):(0,W._j)(e.palette.background.default,.3)},[e.breakpoints.up("sm")]:{width:"auto"}}),children:[(0,i.tZ)(c.Z,{sx:e=>({padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}),children:(0,i.tZ)(tN.Z,{htmlColor:"#888"})}),(0,i.tZ)(tz.ZP,{placeholder:t,value:o,onChange:e=>{l(e.target.value)},onFocus:()=>d(!0),onBlur:()=>d(!1),sx:{width:r?void 0:"100%",color:"inherit",minHeight:"inherit"},inputProps:{sx:e=>({padding:e.spacing(1,1,1,0),paddingLeft:`calc(1em + ${e.spacing(4)})`,transition:e.transitions.create("width"),width:"100%",[e.breakpoints.up("sm")]:{width:r?a?"20ch":"12ch":"100%"}}),"aria-label":t},endAdornment:o?(0,i.tZ)(p.Z,{sx:{mr:n?2:1},size:"small",onClick:A,children:(0,i.tZ)(ts.Z,{fontSize:"small"})}):(0,i.tZ)("div",{style:{width:26}})})]})}let oU=(0,J.ZP)(tz.ZP)(({theme:e})=>({"label + &":{},"& .MuiInputBase-input":{borderRadius:4,position:"relative",backgroundColor:"light"===e.palette.mode?(0,W.Fq)(e.palette.common.black,.05):(0,W._j)(e.palette.background.default,.2),fontSize:14,fontWeight:e.typography.fontWeightMedium,padding:"8px 26px 8px 12px",transition:e.transitions.create(["border-color","box-shadow"]),"&:focus":{borderRadius:4}}}));function oj(e){return(0,i.tZ)(D.Z,{input:(0,i.tZ)(oU,{}),renderValue:e=>e.toUpperCase(),...e,MenuProps:{MenuListProps:{disablePadding:!0,style:{borderRadius:4}},elevation:1},children:e.children})}function o$(e){return(0,i.tZ)(k.Z,{...e,sx:e=>({backgroundColor:e.palette.background.default,fontSize:14,fontWeight:e.typography.fontWeightMedium,paddingTop:e.spacing(1),paddingBottom:e.spacing(1),"&:hover":{backgroundColor:(0,W._j)(e.palette.background.default,.1)},"&:focus":{backgroundColor:(0,W._j)(e.palette.background.default,.2),"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.text.primary}}}),children:e.children})}function oL(e){let t=(0,A.Z)(),r=(0,K.Z)(t.breakpoints.up("md")),n=!e.forceFilter&&e.filterIsSet&&(0,i.tZ)(d.Z,{title:"Clear filter",children:(0,i.tZ)(p.Z,{sx:{height:"fit-content"},"aria-label":"filter clear",onClick:e.clearFilter,size:"medium",children:(0,i.tZ)(t2.Z,{})})}),o=(0,i.tZ)(oj,{variant:"standard",value:e.size,sx:{width:56,height:40},onChange:t=>e.onSizeChanged(t.target.value),renderValue:e=>e.toUpperCase(),children:["xs","s","m","l","xl"].map(e=>(0,i.tZ)(o$,{value:e,children:e.toUpperCase()},`size-select-${e}`))});return(0,i.BX)(c.Z,{sx:{minHeight:56,overflowX:"auto",[t.breakpoints.down("sm")]:{px:t.spacing(1)},px:t.spacing(2),backgroundColor:t.palette.background.default,borderBottom:`1px solid ${t.palette.divider}`,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,i.BX)(c.Z,{display:"flex",alignItems:"center",sx:{"& > *":{[t.breakpoints.down("md")]:{marginRight:`${t.spacing(1)} !important`},marginRight:`${t.spacing(2)} !important`}},children:[e.title&&(0,i.tZ)(q.Z,{lgDown:!0,children:e.title}),o,e.actionsStart,n]}),(0,i.BX)(c.Z,{sx:{display:"flex",alignItems:"center","& > *":{[t.breakpoints.down("md")]:{marginRight:`${t.spacing(.5)} !important`},marginRight:`${t.spacing(1)} !important`}},children:[r&&(0,i.tZ)(c.Z,{width:22,children:e.loading&&(0,i.tZ)(N.Z,{size:16,thickness:8})}),e.onTextSearch&&(0,i.tZ)(oH,{onTextSearch:e.onTextSearch,expandable:!0},"search-bar"),e.actions]})]})}let oN={"==":"==","!=":"!=",">":">","<":"<",">=":">=","<=":"<=",in:"In","not-in":"Not in","array-contains":"Contains","array-contains-any":"Contains Any"},oX=["array-contains-any","in","not-in"];function o_({name:e,value:t,setValue:r,isArray:n,path:o,title:l,previewProperties:a,setPopupOpen:d}){let u=n?["array-contains"]:["==","!=",">","<",">=","<="],[A,p]=s.useState(!1);n?u.push("array-contains-any"):u.push("in","not-in");let[h,f]=t||[u[0],void 0],[g,m]=(0,s.useState)(h),[y,b]=(0,s.useState)(f),Z=y?Array.isArray(y)?y.map(e=>e.id):[y.id]:[];function v(e,t){let i=oX.includes(g),n=oX.includes(e),o=t;i!==n&&(o=n?o instanceof rY?[o]:[]:void 0),m(e),b(o);let l=null!==o&&Array.isArray(o)?o.length>0:void 0!==o;r(e&&l?[e,o]:void 0)}let x=rp(),w=(0,s.useMemo)(()=>o?x.getCollection(o):void 0,[o]),B=oX.includes(g),E=rM({multiselect:B,path:o,collection:w,onSingleEntitySelected:e=>{v(g,iH(e))},onMultipleEntitiesSelected:e=>{v(g,e.map(e=>iH(e)))},selectedEntityIds:Z,onClose:()=>{d(!0)}}),S=()=>{d(!1),E.open()},I=e=>(0,i.tZ)(c.Z,{sx:{mb:.5},onMouseEnter:()=>p(!0),onMouseMove:()=>p(!0),onMouseLeave:()=>p(!1),children:(0,i.tZ)(ia,{disabled:!o,previewProperties:a,size:"regular",onClick:S,reference:e,onHover:A,allowEntityNavigation:!1})});return(0,i.BX)(c.Z,{display:"flex",width:440,flexDirection:"row",children:[(0,i.tZ)(c.Z,{width:120,children:(0,i.tZ)(F.Z,{fullWidth:!0,children:(0,i.tZ)(D.Z,{value:g,fullWidth:!0,onChange:e=>{v(e.target.value,y)},children:u.map(t=>(0,i.tZ)(k.Z,{value:t,children:oN[t]},`filter_op_${e}_${t}`))})})}),(0,i.tZ)(c.Z,{flexGrow:1,ml:1,children:(0,i.BX)(F.Z,{fullWidth:!0,sx:{height:"100%"},children:[y&&Array.isArray(y)&&(0,i.tZ)(c.Z,{children:y.map((e,t)=>I(e))}),y&&!Array.isArray(y)&&(0,i.tZ)(c.Z,{children:I(y)}),(!y||Array.isArray(y)&&0===y.length)&&(0,i.tZ)(C.Z,{onClick:S,sx:{height:"100%"},children:B?"Select references":"Select reference"})]})})]})}let oJ={"==":"==","!=":"!=",">":">","<":"<",">=":">=","<=":"<=",in:"In","not-in":"Not in","array-contains":"Contains","array-contains-any":"Any"},oK=["array-contains-any","in","not-in"];function oq({name:e,value:t,setValue:r,dataType:n,isArray:o,enumValues:l,title:a}){let d=o?["array-contains"]:["==","!=",">","<",">=","<="];l&&(o?d.push("array-contains-any"):d.push("in","not-in"));let[u,A]=t||[d[0],void 0],[h,f]=(0,s.useState)(u),[g,m]=(0,s.useState)(A);function y(e,t){let i=t,n=oK.includes(h),o=oK.includes(e);n!==o&&(i=o?"string"==typeof t||"number"==typeof t?[t]:[]:""),"number"==typeof i&&isNaN(i)&&(i=void 0),f(e),m(i);let l=null!==i&&Array.isArray(i)?i.length>0:void 0!==i;r(e&&l?[e,i]:void 0)}let b=oK.includes(h);return(0,i.BX)(c.Z,{display:"flex",width:440,alignItems:"center",children:[(0,i.tZ)(c.Z,{width:80,children:(0,i.tZ)(F.Z,{fullWidth:!0,children:(0,i.tZ)(D.Z,{value:h,fullWidth:!0,onChange:e=>{y(e.target.value,g)},children:d.map(t=>(0,i.tZ)(k.Z,{value:t,children:oJ[t]},`filter_op_${e}_${t}`))})})}),(0,i.tZ)(c.Z,{flexGrow:1,ml:1,children:(0,i.BX)(F.Z,{fullWidth:!0,children:[!l&&(0,i.tZ)(ee.Z,{fullWidth:!0,type:"number"===n?"number":void 0,value:void 0!==g?g:"",onChange:e=>{let t="number"===n?parseFloat(e.target.value):e.target.value;y(h,t)},endAdornment:g&&(0,i.tZ)(p.Z,{sx:{position:"absolute",right:"12px",top:"8px"},onClick:e=>y(h,void 0),children:(0,i.tZ)(ts.Z,{})})},`filter_${e}`),l&&(0,i.tZ)(D.Z,{fullWidth:!0,multiple:b,value:void 0!==g?g:o?[]:"",onChange:e=>y(h,"number"===n?parseInt(e.target.value):e.target.value),endAdornment:g&&(0,i.tZ)(p.Z,{sx:{position:"absolute",right:"12px",top:"8px"},onClick:e=>y(h,void 0),children:(0,i.tZ)(ts.Z,{})}),renderValue:b?t=>(0,i.tZ)("div",{children:t.map(t=>(0,i.tZ)(r6,{enumKey:t,enumValues:l,small:!0},`select_value_${e}_${t}`))}):void 0,children:l.map(t=>(0,i.tZ)(k.Z,{value:t.id,children:(0,i.tZ)(r6,{enumKey:t.id,enumValues:l,small:!0})},`select_${e}_${t.id}`))},`filter-select-${b}-${e}`)]})})]})}let o0="BooleanFilterField",o1={formControl:`${o0}-formControl`,label:`${o0}-label`},o2=(0,J.ZP)("div")(({theme:e})=>({[`& .${o1.formControl}`]:{width:"200px"},[`& .${o1.label}`]:{width:"100%",height:"100%"}}));function o4({name:e,title:t,value:r,setValue:n}){let o=r&&r[1],l=!!r;return(0,i.tZ)(o2,{children:(0,i.tZ)(M.Z,{className:o1.formControl,labelPlacement:"end",checked:l&&o,control:(0,i.tZ)(P.Z,{indeterminate:!l,onChange:e=>{var t;n(void 0!==(t=!o&&(!l||void 0))?["==",t]:void 0)}},`filter-${e}`),label:l?o?`${t} is true`:`${t} is false`:"No filter"})})}function o5({mode:e,value:t,onChange:r,disabled:n,clearable:o,small:l}){return(0,i.tZ)(void 0===e||"date_time"===e?tM.x:tP.M,{value:t??null,disabled:n,renderInput:e=>(0,i.tZ)(z.Z,{...e,fullWidth:!0,disabled:n,sx:e=>({height:l?"48px":"56px",borderRadius:`${e.shape.borderRadius}px`}),InputProps:{...e.InputProps,sx:e=>({height:l?"48px":"56px",borderRadius:`${e.shape.borderRadius}px`,padding:l?"0 0px":void 0}),disableUnderline:!0,endAdornment:o?(0,i.BX)(c.Z,{sx:{pr:2,gap:2},children:[(0,i.tZ)(p.Z,{sx:{position:"absolute",right:"56px",top:"8px"},onClick:e=>r?.(null),children:(0,i.tZ)(ts.Z,{})}),e.InputProps?.endAdornment]}):null},variant:"filled"}),onChange:r})}let o3={"==":"==","!=":"!=",">":">","<":"<",">=":">=","<=":"<=",in:"in","array-contains":"Contains","array-contains-any":"Any"},o8=["array-contains-any","in"];function o6({name:e,isArray:t,mode:r,value:n,setValue:o,title:l}){let a=t?["array-contains"]:["==","!=",">","<",">=","<="],[d,u]=n||[a[0],void 0],[A,p]=(0,s.useState)(d),[h,f]=(0,s.useState)(u);function g(e,t){let r=t,i=o8.includes(A),n=o8.includes(e);i!==n&&(r=n?t?[t]:[]:""),p(e),f(null===r?void 0:r);let l=null!==r&&Array.isArray(r)?r.length>0:void 0!==r;o(e&&l?[e,r]:void 0)}return(0,i.BX)(c.Z,{display:"flex",width:440,alignItems:"center",children:[(0,i.tZ)(c.Z,{width:80,children:(0,i.tZ)(F.Z,{fullWidth:!0,children:(0,i.tZ)(D.Z,{value:A,fullWidth:!0,onChange:e=>{g(e.target.value,h)},children:a.map(t=>(0,i.tZ)(k.Z,{value:t,children:o3[t]},`filter_op_${e}_${t}`))})})}),(0,i.tZ)(c.Z,{flexGrow:1,ml:1,children:(0,i.tZ)(o5,{mode:r,value:h,onChange:e=>{g(A,null===e?void 0:e)},clearable:!0})})]})}let o9=s.createContext({}),o7=()=>(0,s.useContext)(o9),le="collectionGroupParent",lt=s.memo(function({fullPath:e,initialFilter:t,initialSort:r,filterCombinations:n,forceFilter:o,actionsStart:l,actions:a,title:d,tableRowActionsBuilder:u,selectionController:p,highlightedEntities:h,onEntityClick:f,onColumnResize:g,onSizeChanged:m,textSearchEnabled:y=!1,hoverRow:b=!0,inlineEditing:Z=!1,tableController:{data:v,dataLoading:x,noMoreToLoad:w,dataLoadingError:B,filterValues:k,setFilterValues:E,sortBy:S,setSortBy:I,searchString:F,setSearchString:R,clearFilter:Q,itemCount:D,setItemCount:P,pageSize:M,paginationEnabled:T,checkFilterCombination:V},...z}){let Y=rp(),G=(0,A.Z)(),O=(0,K.Z)(G.breakpoints.up("md")),W=!!o,H=p?.selectedEntities?.length>0?p?.selectedEntities:h,U=s.useRef(Math.random().toString(36)),j=rk(),$=ru(),L=rb(),N=(0,s.useMemo)(()=>nU({collection:z,path:e,fields:j.fields}),[z,e]),[X,_]=s.useState(N.defaultSize??"m"),[J,q]=s.useState(void 0),[ee,et]=s.useState(void 0),[er,ei]=s.useState(!1),en=H?.map(e=>e.id),eo=!!k&&Object.keys(k).length>0,el=(0,s.useMemo)(()=>{let t=z.subcollections?.map(t=>({id:os(t),name:t.name,width:200,dependencies:[],Builder:({entity:r})=>i.tZ(C.Z,{color:"primary",variant:"outlined",startIcon:i.tZ(tp.Z,{fontSize:"small"}),onClick:i=>{i.stopPropagation(),L.open({path:e,entityId:r.id,selectedSubPath:t.alias??t.path,collection:z,updateUrl:!0})},children:t.name})}))??[],r=z.collectionGroup?[{id:le,name:"Parent entities",width:260,dependencies:[],Builder:({entity:e})=>{let t=Y.getParentReferencesFromPath(e.path);return(0,i.tZ)(i.HY,{children:t.map(e=>(0,i.tZ)(ia,{reference:e,size:"tiny"},e.path+"/"+e.id))})}}]:[];return[...z.additionalFields??z.additionalColumns??[],...t,...r]},[z,e]),ea=(0,s.useCallback)(({name:t,value:r,property:i,entityId:n})=>$.checkUniqueField(e,t,r,i,n),[e]),es=(0,s.useCallback)(()=>{P(M)},[M]),ed=(0,s.useCallback)(({rowData:e})=>{if(!Z)return f&&f(e)},[f,Z]),ec=(0,s.useCallback)(e=>{m&&m(e),_(e)},[]),eu=(0,s.useCallback)(e=>R(e),[]),eA=(0,s.useMemo)(()=>el?el.map(e=>({[e.id]:e})).reduce((e,t)=>({...e,...t}),{}):{},[el]);(0,s.useEffect)(()=>{let e=e=>{27===e.keyCode&&eh()};return document.addEventListener("keydown",e,!1),()=>{document.removeEventListener("keydown",e,!1)}});let ep=(0,s.useCallback)(e=>{q(e),ei(!0)},[]),eh=(0,s.useCallback)(()=>{q(void 0),ei(!1)},[]),ef=(0,s.useCallback)(()=>{et(void 0),ei(!0)},[]),eg=(0,s.useMemo)(()=>N.propertiesOrder?li(N,N.propertiesOrder):function(e,t){let r=Object.keys(e.properties);e.additionalColumns&&console.warn("`additionalColumns` is deprecated and will be removed in previous versions. Use `additionalFields` instead, with the same structure.");let i=e.additionalFields??e.additionalColumns??[],n=e.subcollections??[],o=[...r,...i.map(e=>e.id)];if(t){let e=n.map(e=>os(e));o.push(...e.filter(e=>!o.includes(e)))}return e.collectionGroup&&o.push(le),li(e,o)}(N,!0),[N,!0]),em=(0,s.useCallback)(({column:t,columnIndex:r,rowData:n,rowIndex:o})=>{let l=t.key,a=function e(t,r){if("object"==typeof t){if(r in t)return t[r];if(r.includes(".")){let i=r.split("."),n=t[i[0]];if("object"==typeof n&&"map"===n.dataType&&n.properties)return e(n.properties,i.slice(1).join("."))}}}(z.properties,l);if(!a)return null;let s=nj({propertyKey:l,propertyOrBuilder:a,path:e,propertyValue:n.values?iM(n.values,l):void 0,values:n.values,entityId:n.id,fields:j.fields});return s?(0,i.tZ)(i4,{children:n?(0,i.tZ)(ok,{readonly:!Z,align:t.align??"left",propertyKey:l,property:s,setFocused:ei,value:n?.values?iM(n.values,l):void 0,collection:z,customFieldValidator:ea,columnIndex:r,width:t.width,height:ox(X),entity:n,path:n.path},`property_table_cell_${n.id}_${l}`):rX()}):null},[z,ea,e,Z,X,en]),ey=(0,s.useCallback)(({column:e,rowData:t,width:r})=>{let n=eA[e.key],o=n.dependencies?Object.entries(t.values).filter(([e,t])=>n.dependencies.includes(e)).reduce((e,t)=>({...e,...t}),{}):t;n.builder&&console.warn("`additionalField.builder` is deprecated. Use `additionalField.Builder` instead.");let l=n.builder??n.Builder;if(!l)throw Error("No builder provided for additional field");return(0,i.tZ)(oB,{width:r,size:X,focused:er,value:o,selected:!1,selectedRow:en?.includes(t.id)??!1,disabled:!0,align:"left",allowScroll:!1,showExpandIcon:!1,disabledTooltip:"This column can't be edited directly",children:(0,i.tZ)(i4,{children:(0,i.tZ)(l,{entity:t,context:j})})},`additional_table_cell_${t.id}_${e.key}`)},[eA,X,en]),eb=(0,s.useMemo)(()=>{let e=Object.entries(N.properties).flatMap(([e,t])=>"map"===t.dataType&&t.spreadChildren&&t.properties?Object.keys(t.properties).map(t=>`${e}.${t}`):[e]).map(e=>{let t=function e(t,r){if("object"==typeof t){if(r in t)return t[r];if(r.includes(".")){let i=r.split("."),n=t[i[0]];if("map"===n.dataType&&n.properties)return e(n.properties,i.slice(1).join("."))}}}(N.properties,e);if(!t)throw Error("Internal error: no property found in path "+e);let r=function e(t,r=!1){return r?["string","number","date","reference"].includes(t.dataType):"array"===t.dataType?!!t.of&&e(t.of,!0):["string","number","boolean","date","reference","array"].includes(t.dataType)}(t);return{key:e,align:"boolean"===t.dataType?"center":"number"===t.dataType?t.enumValues?"left":"right":"date"===t.dataType?"right":"left",icon:e=>n3(t,e?void 0:"disabled","small"),title:t.name??e,sortable:!o||Object.keys(o).includes(e),filter:!W&&r,width:function e(t){return t.columnWidth?t.columnWidth:"string"===t.dataType?t.url?280:t.storage?160:t.enumValues?200:t.multiline||t.markdown?300:(t.email,200):"array"===t.dataType?t.of?Array.isArray(t.of)?300:e(t.of):300:"number"===t.dataType?t.enumValues?200:140:"map"===t.dataType?360:"date"===t.dataType?200:"reference"===t.dataType?220:"boolean"===t.dataType?140:200}(t),resizable:!0,custom:t}}),t=el?el.map(e=>({key:e.id,type:"additional",align:"left",sortable:!1,title:e.name,width:e.width??200})):[];return[...e,...t]},[el,W,o,N.properties]),eZ=(0,s.useMemo)(()=>({key:"id_ewcfedcswdf3",width:O?160:130,title:"ID",resizable:!1,frozen:O,headerAlign:"center"}),[O]),ev=(0,s.useMemo)(()=>[eZ,...eg.map(e=>eb.find(t=>t.key===e)).filter(e=>!!e)],[eb,eg,eZ]),ex=(0,s.useCallback)(e=>{let t=e.column,r=e.columns,n=t.key;if(0===e.columnIndex)return u?u({entity:e.rowData,size:X,width:t.width,frozen:t.frozen}):(0,i.tZ)(oW,{entity:e.rowData,width:t.width,frozen:t.frozen,size:X});if(eA[n])return ey(e);if(e.columnIndex<r.length+1)return em(e);throw Error("Internal: columns not mapped properly")},[eA,u,X,ey,em]),ew=(0,s.useCallback)(e=>{E({...e,...o})},[o]);return(0,i.tZ)(o9.Provider,{value:{setPopupCell:et,select:ep,onValueChange:lr,size:X,selectedCell:J,selectedEntityIds:en,focused:er,setFocused:ei},children:(0,i.BX)(c.Z,{sx:e=>({height:"100%",width:"100%",display:"flex",flexDirection:"column",backgroundColor:e.palette.background.paper}),children:[(0,i.tZ)(oL,{forceFilter:W,filterIsSet:eo,onTextSearch:y?eu:void 0,clearFilter:Q,size:X,onSizeChanged:ec,title:d,actionsStart:l,actions:a,loading:x}),(0,i.tZ)(c.Z,{sx:{flexGrow:1},children:(0,i.tZ)(oG,{data:v,columns:ev,cellRenderer:ex,onRowClick:Z?void 0:ed,onEndReached:()=>{!T||x||w||void 0!==D&&P(D+M)},onResetPagination:es,error:B,paginationEnabled:T,onColumnResize:g,size:X,loading:x,filter:k,onFilterUpdate:ew,sortBy:S,onSortByUpdate:I,hoverRow:b,checkFilterCombination:V,createFilterField:ln})}),(0,i.tZ)(oI,{open:!!ee,onClose:ef,cellRect:ee?.cellRect,columnIndex:ee?.columnIndex,propertyKey:ee?.propertyKey,collection:ee?.collection,entity:ee?.entity,tableKey:U.current,customFieldValidator:ea,path:e,onCellValueChange:lr},`popup_form_${ee?.columnIndex}_${ee?.entity?.id}`)]})})},eY()),lr=({fullPath:e,collection:t,dataSource:r,context:i,value:n,propertyKey:o,onValueUpdated:l,setError:a,entity:s})=>{let d=(0,te.tP)({...s.values},o,n),c={path:e,entityId:s.id,values:d,previousValues:s.values,collection:t,status:"existing"};return rI({...c,callbacks:t.callbacks,dataSource:r,context:i,onSaveSuccess:()=>l(),onSaveFailure:e=>{console.error("Save failure"),console.error(e),a(e)}})};function li(e,t){return t.flatMap(t=>{let r=e.properties[t];return r?r.hideFromCollection?[null]:r.disabled&&"object"==typeof r.disabled&&r.disabled.hidden?[null]:"map"===r.dataType&&r.spreadChildren&&r.properties?Object.keys(r.properties).map(e=>`${t}.${e}`):[t]:e.additionalFields?.find(e=>e.id===t)?[t]:e.collectionGroup&&t===le?[t]:[null]}).filter(e=>null!==e)}function ln({id:e,filterValue:t,setFilterValue:r,column:n,popupOpen:o,setPopupOpen:l}){let a=n.custom;if(!a)return null;let s=a?.dataType==="array",d=s?a.of:a;if(!d)return null;if("reference"===d.dataType)return(0,i.tZ)(o_,{value:t,setValue:r,name:e,isArray:s,path:d.path,title:a?.name,previewProperties:d?.previewProperties,popupOpen:o,setPopupOpen:l});if("number"===d.dataType||"string"===d.dataType){let n=d.name,o=d.enumValues?nX(d.enumValues):void 0;return(0,i.tZ)(oq,{value:t,setValue:r,name:e,dataType:d.dataType,isArray:s,enumValues:o,title:n})}if("boolean"===d.dataType){let n=d.name;return(0,i.tZ)(o4,{value:t,setValue:r,name:e,title:n})}if("date"===d.dataType){let n=d.name;return(0,i.tZ)(o6,{value:t,setValue:r,name:e,mode:d.mode,isArray:s,title:n})}return(0,i.tZ)("div",{children:`Currently the field ${a.dataType} is not supported`})}let lo={enter:225,exit:175},ll=s.forwardRef(function(e,t){let{children:r,onClose:n,open:o,offsetPosition:l}=e,a=(0,A.Z)();return(0,i.tZ)(et.Z,{BackdropProps:{transitionDuration:lo,sx:{backgroundColor:"dark"===a.palette.mode?"rgba(0, 0, 0, 0.85)":"rgba(0, 0, 0, 0.6)"}},BackdropComponent:er.Z,open:o,onClose:n?()=>n(!1):void 0,ref:t,keepMounted:!0,disableEnforceFocus:!0,disableEscapeKeyDown:!0,sx:{transition:`transform 300ms ${a.transitions.easing.easeOut}`,transform:`translateX(-${200*l}px)`},children:(0,i.tZ)(ei.Z,{in:o,timeout:lo,direction:"left",children:(0,i.tZ)(R.Z,{variant:"outlined",square:!0,sx:{height:"100%",WebkitOverflowScrolling:"touch",position:"fixed",outline:0,left:"auto",right:0,overflow:"hidden",borderRadius:"16px 0 0 16px"},children:r})})})});function la({open:e,handleOk:t,handleCancel:r,body:n,title:o}){return(0,i.BX)(en.Z,{keepMounted:!1,open:e,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,i.tZ)(eo.Z,{children:o??"Unsaved changes"}),(0,i.BX)(el.Z,{children:[n&&(0,i.tZ)(ea.Z,{children:n}),(0,i.tZ)(ea.Z,{children:"Are you sure you want to leave this page?"})]}),(0,i.BX)(oS,{children:[(0,i.tZ)(C.Z,{onClick:r,autoFocus:!0,children:" Cancel "}),(0,i.tZ)(C.Z,{onClick:t,children:" Ok "})]})]})}let ls=s.createContext({width:"",blocked:!1,setBlocked:e=>{},setBlockedNavigationMessage:e=>{},close:()=>{}}),ld=()=>(0,s.useContext)(ls);function lc(){let e=rm().sidePanels,t=[...e];return t.push(void 0),(0,i.tZ)(i.HY,{children:t.map((t,r)=>(0,i.tZ)(lu,{panel:t,offsetPosition:e.length-r-1},`side_dialog_${r}`))})}function lu({offsetPosition:e,panel:t}){let[r,n]=(0,s.useState)(!1),[o,l]=(0,s.useState)(!1),[a,d]=(0,s.useState)(),u=s.useRef(t?.width),A=u.current,p=rm(),{navigationWasBlocked:h,handleOk:f,handleCancel:g}=function(e,t){let[r,i]=s.useState(),{navigator:n}=s.useContext(eC.Us),o=(0,eC.s0)(),l=(0,s.useCallback)(({action:e,location:t,retry:r})=>{switch(e){case"REPLACE":r();return;case"POP":i(t)}},[]);return s.useEffect(()=>{if(!e||r||!("block"in n))return;let t=n.block(e=>{let r={...e,retry(){t(),e.retry()}};l(r)});return t},[n,l,e,r]),{navigationWasBlocked:!!r,handleCancel:()=>{i(void 0)},handleOk:()=>{t(),i(void 0),o(-1)}}}(o&&!r,()=>l(!1));(0,s.useEffect)(()=>{t&&(u.current=t.width)},[t]);let m=e=>{o&&!e?n(!0):(p.close(),t?.onClose?.())};return(0,i.BX)(ls.Provider,{value:{blocked:o,setBlocked:l,setBlockedNavigationMessage:d,width:A,close:m},children:[(0,i.BX)(ll,{open:!!t,onClose:m,offsetPosition:e,children:[t&&(0,i.tZ)(c.Z,{sx:e=>({display:"flex",flexDirection:"column",height:"100%",transition:"width 250ms ease-in-out",width:t.width,maxWidth:ra,[e.breakpoints.up("lg")]:{maxWidth:"95vw"}}),children:(0,i.tZ)(i4,{children:t.component})}),!t&&(0,i.tZ)("div",{style:{width:A}})]}),(0,i.tZ)(la,{open:h||r,handleOk:r?()=>{l(!1),n(!1),p.close(),t?.onClose?.()}:f,handleCancel:r?()=>{n(!1)}:g,body:a})]})}function lA({entityOrEntitiesToDelete:e,collection:t,onClose:r,open:n,callbacks:o,onEntityDelete:l,onMultipleEntitiesDelete:a,path:d,...c}){let u;let A=ru(),p=rx(),[h,f]=(0,s.useState)(!1),[g,m]=s.useState(),[y,b]=s.useState(),Z=rk();s.useEffect(()=>{if(e){let t=Array.isArray(e)&&1===e.length?e[0]:e;m(t),b(Array.isArray(t))}},[e]);let v=(0,s.useMemo)(()=>nU({collection:t,path:d,fields:Z.fields}),[t,d]),x=(0,s.useCallback)(()=>{r()},[r]),w=(0,s.useCallback)(e=>{console.debug("Deleted",e)},[]),B=(0,s.useCallback)((e,t)=>{p.open({type:"error",message:"Error deleting: "+t?.message}),console.error("Error deleting entity"),console.error(t)},[v.name]),k=(0,s.useCallback)((e,t)=>{p.open({type:"error",message:"Error before deleting: "+t?.message}),console.error(t)},[v.name]),E=(0,s.useCallback)((e,t)=>{p.open({type:"error",message:"Error after deleting: "+t?.message}),console.error(t)},[v.name]),S=(0,s.useCallback)(e=>rF({dataSource:A,entity:e,collection:v,callbacks:o,onDeleteSuccess:w,onDeleteFailure:B,onPreDeleteHookError:k,onDeleteSuccessHookError:E,context:Z}),[A,v,o,w,B,k,E,Z]),I=(0,s.useCallback)(async()=>{g&&(f(!0),y?Promise.all(g.map(S)).then(e=>{f(!1),a&&g&&a(d,g),e.every(Boolean)?p.open({type:"success",message:`${v.name}: multiple deleted`}):e.some(Boolean)?p.open({type:"warning",message:`${v.name}: Some of the entities have been deleted, but not all`}):p.open({type:"error",message:`${v.name}: Error deleting entities`}),r()}):S(g).then(e=>{f(!1),e&&(l&&g&&l(d,g),p.open({type:"success",message:`${v.singularName??v.name} deleted`}),r())}))},[g,y,S,a,d,r,p,v.name,l]);u=g&&y?(0,i.tZ)("div",{children:"Multiple entities"}):g?(0,i.tZ)(oa,{entity:g,collection:t,path:d}):(0,i.tZ)(i.HY,{});let F=y?`${v.name}: Confirm multiple delete?`:`Would you like to delete this ${v.singularName??v.name}?`;return(0,i.BX)(en.Z,{maxWidth:"md","aria-labelledby":"delete-dialog",open:n,onBackdropClick:r,...c,children:[(0,i.tZ)(eo.Z,{id:"delete-dialog-title",children:F}),!y&&(0,i.tZ)(el.Z,{dividers:!0,children:u}),(0,i.BX)(oS,{children:[h&&(0,i.tZ)(N.Z,{size:16,thickness:8}),(0,i.tZ)(C.Z,{onClick:x,disabled:h,color:"primary",children:"Cancel"}),(0,i.tZ)(C.Z,{autoFocus:!0,disabled:h,onClick:I,variant:"contained",color:"primary",children:"Ok"})]})]})}function lp(e){return e.map(e=>null==e?"":'"'+String(e).replaceAll('"','""')+'"').join(",")+`\r
`}function lh({collection:e,path:t,exportConfig:r}){let n=rk(),o=ru(),l=rp().resolveAliasesFrom(t),a=s.useMemo(()=>nU({collection:e,path:l,fields:n.fields}),[e,l]),c=(0,s.useRef)(),u=(0,s.useRef)(),[A,h]=s.useState(!1),[f,g]=s.useState(),[m,y]=s.useState(!1),[b,Z]=s.useState(!1),[v,x]=s.useState(!1),w=(0,s.useCallback)(()=>{x(!0)},[x]),B=(0,s.useCallback)(()=>{x(!1)},[x]),k=(0,s.useCallback)((e,t,r,i,n)=>{if(!e)throw Error("Trying to perform export without loading data first");!function(e,t,r,i,n){let o=r.properties,l=function(e,t,r){let i=[{label:"id",key:"id"},...Object.entries(e).map(([e,t])=>(function e(t,r,i=""){let n=i?`${i}.${r}`:r;return"map"===t.dataType&&t.properties?Object.entries(t.properties).map(([t,r])=>e(r,t,n)).flat():[{label:n,key:n}]})(t,e,"")).flat()];return r?.additionalFields&&i.push(...r.additionalFields.map(e=>({label:e.key,key:e.key}))),i}(o,0,n),a=function(e,t,r,i){let n=e.map(e=>({id:e.id,...function e(t,r){let i=Object.entries(r).map(([r,i])=>{let n=t&&t[r],o=function t(r,i){let n;if("map"===i.dataType&&i.properties)n=e(r,i.properties);else if("array"===i.dataType)n=i.of&&Array.isArray(r)?Array.isArray(i.of)?i.of.map((e,i)=>t(r[i],e)):"map"===i.of.dataType?r.map(e=>JSON.stringify(e)):r.map(e=>t(e,i.of)):r;else if("reference"===i.dataType){let e=r||void 0;n=e?e.pathWithId:null}else n="date"===i.dataType?r?r.getTime():null:r;return n}(n,i);return void 0===o?{}:{[r]:o}}).reduce((e,t)=>({...e,...t}),{});return{...t,...i}}(e.values,r)}));return t&&t.forEach((e,t)=>{n[t]={...n[t],...e}}),n&&n.map(e=>i.map(t=>iM(e,t.key)))}(e,t,o,l),s=lp(l.map(e=>e.label)),d=a.map(e=>lp(e));!function(e,t,r){let i=new Blob(e,{type:r}),n=URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.setAttribute("download",t),o.click()}([s,...d],`${r.name}.csv`,"text/csv")}(e,t,r,0,n)},[]),E=(0,s.useCallback)(async e=>{if(!r?.additionalFields)return;let t=r.additionalFields;return await Promise.all(e.map(async e=>(await Promise.all(t.map(async t=>({[t.key]:await t.builder({entity:e,context:n})})))).reduce((e,t)=>({...e,...t}),{})))},[r?.additionalFields]),S=(0,s.useCallback)(async e=>{e.length>=200&&y(!0);let t=c.current&&e.length>c.current.length&&b;c.current=e;let i=await E(e);u.current=i,g(void 0),t&&(k(e,i,a,l,r),B())},[a,k,r,E,b,B,l]);(0,s.useEffect)(()=>{v&&(h(!0),o.fetchCollection({path:l,collection:a,limit:b?void 0:200}).then(S).catch(g).finally(()=>h(!1)))},[a,o,b,v,l,S]);let I=m&&!b,F=(0,s.useCallback)(()=>{I?Z(!0):(k(c.current,u.current,a,l,r),B())},[I,k,a,l,r,B]);return(0,i.BX)(i.HY,{children:[(0,i.tZ)(d.Z,{title:"Export",children:(0,i.tZ)(p.Z,{color:"primary",onClick:w,children:(0,i.tZ)(tK.Z,{})})}),(0,i.BX)(en.Z,{keepMounted:!1,open:v,onClose:B,children:[(0,i.tZ)(eo.Z,{children:"Export data"}),(0,i.tZ)(el.Z,{children:(0,i.BX)(ea.Z,{children:[(0,i.tZ)("div",{children:"Download the the content of this table as a CSV"}),(0,i.tZ)("br",{}),I&&(0,i.BX)(es.Z,{elevation:3,variant:"filled",severity:"warning",children:[(0,i.BX)("div",{children:["This collections has a large number of documents (more than ",200,")."]}),(0,i.tZ)("div",{children:"Would you like to proceed?"})]})]})}),(0,i.BX)(oS,{children:[A&&(0,i.tZ)(N.Z,{size:16,thickness:8}),(0,i.tZ)(C.Z,{color:"primary",onClick:B,children:"Cancel"}),(0,i.tZ)(C.Z,{color:"primary",variant:"contained",disabled:A,onClick:F,children:"Download"})]})]})]})}function lf({collection:e,onNewClick:t,exportable:r,onMultipleDeleteClick:n,selectionEnabled:o,path:l,selectionController:a,loadedEntities:s}){let c;let u=rk(),h=rf(),f=(0,A.Z)(),g=(0,K.Z)(f.breakpoints.up("md")),m=a.selectedEntities,y=n7(e,h,iL(l),null)&&t&&(g?(0,i.BX)(C.Z,{id:`add_entity_${l}`,onClick:t,startIcon:(0,i.tZ)(eT.Z,{}),size:"large",variant:"contained",color:"primary",children:["Add ",e.singularName??e.name]}):(0,i.tZ)(C.Z,{id:`add_entity_${l}`,onClick:t,size:"medium",variant:"contained",color:"primary",children:(0,i.tZ)(eT.Z,{})})),b=oe(e,h,iL(l),null);if(o){let e=g?(0,i.BX)(C.Z,{disabled:!m?.length||!b,startIcon:(0,i.tZ)(eP.Z,{}),onClick:n,color:"primary",sx:{minWidth:68},children:["(",m?.length,")"]}):(0,i.tZ)(p.Z,{color:"primary",disabled:!m?.length||!b,onClick:n,children:(0,i.tZ)(eP.Z,{})});c=(0,i.tZ)(d.Z,{title:b?"Delete":"You have selected at least one entity you cannot delete",children:(0,i.tZ)("span",{children:e})})}let Z={path:l,collection:e,selectionController:a,context:u,loadedEntities:s},v=e.Actions?Array.isArray(e.Actions)?(0,i.tZ)(i.HY,{children:e.Actions.map((e,t)=>(0,i.tZ)(e,{...Z},`actions_${t}`))}):(0,i.tZ)(e.Actions,{...Z}):void 0,x=r&&(0,i.tZ)(lh,{collection:e,exportConfig:"object"==typeof e.exportable?e.exportable:void 0,path:l});return(0,i.BX)(i.HY,{children:[v,c,x,y]})}function lg({fullPath:e,collection:t,entitiesDisplayedFirst:r,isFilterCombinationValid:i,lastDeleteTimestamp:n}){let{filterCombinations:o,initialFilter:l,initialSort:a,forceFilter:d}=t,c=void 0===t.pagination||!!t.pagination,u="number"==typeof t.pagination?t.pagination:50,[A,p]=s.useState(),[h,f]=s.useState(c?u:void 0),g=(0,s.useCallback)((e,t)=>i(e,t,o),[o]),m=(0,s.useMemo)(()=>{if(a&&d&&!g(d,a)){console.warn("Initial sort is not compatible with the force filter. Ignoring initial sort");return}return a},[a,d]),[y,b]=s.useState(d??l??void 0),[Z,v]=s.useState(m),x=(0,s.useCallback)(()=>b(d??void 0),[d]),{data:w,dataLoading:C,noMoreToLoad:B,dataLoadingError:k}=function({path:e,collection:t,filterValues:r,sortBy:i,itemCount:n,searchString:o}){let l=ru(),a=rp().resolveAliasesFrom(e),d=i?i[0]:void 0,c=i?i[1]:void 0,u=rk(),[A,p]=(0,s.useState)([]),[h,f]=(0,s.useState)(!1),[g,m]=(0,s.useState)(),[y,b]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{f(!0);let e=async e=>{if(t.callbacks?.onFetch)try{e=await Promise.all(e.map(e=>t.callbacks.onFetch({collection:t,path:a,entity:e,context:u})))}catch(e){console.error(e)}f(!1),m(void 0),p(e),b(!n||e.length<n)},i=e=>{console.error("ERROR",e),f(!1),p([]),m(e)};return l.listenCollection?l.listenCollection({path:a,collection:t,onUpdate:e,onError:i,searchString:o,filter:r,limit:n,startAfter:void 0,orderBy:d,order:c}):(l.fetchCollection({path:a,collection:t,searchString:o,filter:r,limit:n,startAfter:void 0,orderBy:d,order:c}).then(e).catch(i),()=>{})},[a,n,c,d,r,o]),{data:A,dataLoading:h,dataLoadingError:g,noMoreToLoad:y}}({path:e,collection:t,filterValues:y,sortBy:Z,searchString:A,itemCount:h}),E=function({data:e,entitiesDisplayedFirst:t}){if(!t)return e;let r=new Set(t.map(e=>e.id));return[...t,...e.filter(e=>!r.has(e.id))]}({data:w,entitiesDisplayedFirst:r});return{data:function(e,t,r=5e3){let[i,n]=s.useState(e),o=s.useRef(i.length??0),l=s.useRef(!1),a=s.useRef(t),d=!eY()(a.current,t),c=e.length>=o.current||d;return s.useEffect(()=>{let s;let d=()=>{eY()(i,e)||(a.current=t,o.current=e.length,n(e)),l.current=!1};return l.current=!0,c?d():s=setTimeout(d,r),()=>{clearTimeout(s),l.current&&c&&d()}},[e,r,t,c]),c?e:i}(E,{filterValues:y,sortBy:Z,searchString:A,lastDeleteTimestamp:n}),dataLoading:C,noMoreToLoad:B,dataLoadingError:k,filterValues:y,setFilterValues:b,sortBy:Z,setSortBy:v,searchString:A,setSearchString:p,clearFilter:x,itemCount:h,setItemCount:f,paginationEnabled:c,pageSize:u,checkFilterCombination:g}}function lm(e,t,r){let i=t?t[0]:void 0,n=t?t[1]:void 0,o=Object.values(e);if(i&&o.map(e=>e[0]).includes("=="))return!1;let l=Object.keys(e),a=l.length;return 1===a&&(!i||i===l[0])||(!!r||!(a>1))&&!!r&&void 0!==r.filter(e=>!i||i in e).find(t=>Object.entries(e).every(([e,r])=>void 0!==t[e]&&(!n||t[e]===n)))}let ly=s.memo(function({fullPath:e,isSubCollection:t,...r}){console.log("EntityCollectionView",e,t,r);let n=rb(),o=rf(),l=rC(),a=rk(),d=(0,s.useMemo)(()=>{let t=l?.getCollectionConfig(e);return t?iP(r,t):r},[r,e,l?.getCollectionConfig]),p=(0,A.Z)(),[h,f]=(0,s.useState)(void 0),[g,m]=s.useState(void 0),[y,b]=s.useState(0),Z=(0,s.useCallback)(()=>{setTimeout(()=>{h==h&&f(void 0)},2400)},[h]),v=(0,s.useCallback)(t=>!!n9(d,o,iL(e),t??null)&&(void 0===d.inlineEditing||d.inlineEditing),[d,o,e]),x=void 0===d.exportable||d.exportable,w=void 0===d.selectionEnabled||d.selectionEnabled,C=!v(),[B,k]=s.useState(null),E=lb(),S=d.selectionController??E,{selectedEntities:I,toggleEntitySelection:F,isEntitySelected:R,setSelectedEntities:Q}=S;(0,s.useEffect)(()=>{m(void 0)},[I]);let D=lg({fullPath:e,collection:d,entitiesDisplayedFirst:[],isFilterCombinationValid:lm,lastDeleteTimestamp:y}),P=(0,s.useCallback)(t=>(f(t),a.onAnalyticsEvent?.("edit_entity_clicked",{path:t.path,entityId:t.id}),n.open({entityId:t.id,path:e,collection:d,updateUrl:!0,onClose:Z})),[e,d,n]),M=(0,s.useCallback)(()=>{a.onAnalyticsEvent?.("new_entity_click",{path:e}),n.open({path:e,collection:d,updateUrl:!0,onClose:Z})},[e,d,n]),T=(0,s.useCallback)(t=>{a.onAnalyticsEvent?.("single_delete_dialog_open",{path:e}),m(t)},[a,e]),V=(0,s.useCallback)(()=>{a.onAnalyticsEvent?.("multiple_delete_dialog_open",{path:e}),m(I)},[a,e,I]),z=(0,s.useCallback)((t,r)=>{a.onAnalyticsEvent?.("single_entity_deleted",{path:e}),Q(e=>e.filter(e=>e.id!==r.id)),b(Date.now())},[a,e,Q]),Y=(0,s.useCallback)((t,r)=>{a.onAnalyticsEvent?.("multiple_entities_deleted",{path:e}),Q([]),m(void 0),b(Date.now())},[Q]),G=(0,s.useCallback)((e,t)=>{if(l){let r=l.getCollectionConfig(e),i=iP(r,t);l.onCollectionModified(e,i)}},[l]),O=(0,s.useCallback)(({width:t,key:r})=>{d.properties[r]&&G(e,{properties:{[r]:{columnWidth:t}}})},[d,G,e]),W=(0,s.useCallback)(t=>{l&&G(e,{defaultSize:t})},[G,e,l]),H=null!=B,U=(0,s.useMemo)(()=>(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"row",contain:"content","& > *:not(:last-child)":{[p.breakpoints.down("md")]:{mr:p.spacing(1)},mr:p.spacing(2)}},children:(0,i.BX)(c.Z,{children:[(0,i.tZ)(u.Z,{variant:"h6",sx:{lineHeight:"1.15",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:"164px",cursor:d.description?"pointer":"inherit"},onClick:d.description?e=>{k(e.currentTarget),e.stopPropagation()}:void 0,children:`${d.name}`}),(0,i.tZ)(lZ,{fullPath:e,collection:d}),d.description&&(0,i.tZ)(_.ZP,{id:"info-dialog",open:H,anchorEl:B,elevation:3,onClose:()=>{k(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,i.tZ)(c.Z,{m:2,children:(0,i.tZ)(r0,{source:d.description})})})]})}),[p,d.description,d.name,e,H,B]),j=n7(d,o,iL(e),null),$=(0,s.useCallback)(t=>{f(t),a.onAnalyticsEvent?.("copy_entity_click",{path:t.path,entityId:t.id}),n.open({entityId:t.id,path:e,copy:!0,collection:d,updateUrl:!0,onClose:Z})},[n,d,e,Z]),L=(0,s.useCallback)(e=>{f(e),a.onAnalyticsEvent?.("entity_click",{path:e.path,entityId:e.id}),n.open({entityId:e.id,path:e.path,collection:d,updateUrl:!0,onClose:Z})},[n,d,e,Z]),N=(0,s.useCallback)(({entity:t,size:r,width:n,frozen:l})=>{let a=R(t),s=oe(d,o,iL(e),t);return(0,i.tZ)(oW,{entity:t,width:n,frozen:l,isSelected:a,selectionEnabled:w,size:r,toggleEntitySelection:F,onEditClicked:L,onCopyClicked:j?$:void 0,onDeleteClicked:s?T:void 0,hideId:d?.hideIdFromCollection})},[R,d,o,e,w,F,L,j,$]);return(0,i.BX)(c.Z,{sx:{overflow:"hidden",height:"100%",width:"100%"},children:[(0,i.tZ)(lt,{fullPath:e,tableController:D,onSizeChanged:W,onEntityClick:P,onColumnResize:O,tableRowActionsBuilder:N,title:U,selectionController:S,highlightedEntities:h?[h]:[],...d,actions:(0,i.tZ)(lf,{collection:d,exportable:x,onMultipleDeleteClick:V,onNewClick:M,path:e,loadedEntities:D.data,selectionController:S,selectionEnabled:w}),hoverRow:C,inlineEditing:v()},`collection_table_${e}`),g&&(0,i.tZ)(lA,{entityOrEntitiesToDelete:g,path:e,collection:d,callbacks:d.callbacks,open:!!g,onEntityDelete:z,onMultipleEntitiesDelete:Y,onClose:()=>m(void 0)})]})},eY());function lb(){let[e,t]=(0,s.useState)([]),r=(0,s.useCallback)(r=>{t(e.map(e=>e.id).includes(r.id)?e.filter(e=>e.id!==r.id):[...e,r])},[e]),i=(0,s.useCallback)(t=>e.map(e=>e.id).includes(t.id),[e]);return{selectedEntities:e,setSelectedEntities:t,isEntitySelected:i,toggleEntitySelection:r}}function lZ({fullPath:e,collection:t}){let r=ru(),n=rp(),[o,l]=(0,s.useState)(void 0),[a,d]=(0,s.useState)(void 0);return(0,s.useEffect)(()=>{r.countEntities({path:n.resolveAliasesFrom(e),collection:t}).then(l).catch(d)},[e,r,n]),a?null:(0,i.tZ)(u.Z,{sx:{display:"block",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:"160px",textAlign:"left"},variant:"caption",color:"textSecondary",children:void 0!==o?`${o} entities`:rX()})}function lv({onSingleEntitySelected:e,onMultipleEntitiesSelected:t,multiselect:r,collection:n,path:o,selectedEntityIds:l,description:a,forceFilter:d,maxSelection:A}){let p=ld(),h=rb(),f=rp(),g=rk(),m=f.resolveAliasesFrom(o),y=ru(),[b,Z]=(0,s.useState)([]),v=lb();(0,s.useEffect)(()=>{let e=!1;return l&&n?Promise.all(l.map(e=>y.fetchEntity({path:m,entityId:e,collection:n}))).then(t=>{if(!e){let e=t.filter(e=>void 0!==e);v.setSelectedEntities(e),Z(e)}}):(v.setSelectedEntities([]),Z([])),()=>{e=!0}},[y,m,l,n,v.setSelectedEntities]);let x=(0,s.useCallback)(()=>{g.onAnalyticsEvent?.("reference_selection_clear",{path:m}),v.setSelectedEntities([]),!r&&e?e(null):t&&t([])},[r,t,e]),w=(0,s.useCallback)(e=>{let r;let i=v.selectedEntities;if(g.onAnalyticsEvent?.("reference_selection_toggle",{path:m,entityId:e.id}),i){if(i.map(e=>e.id).indexOf(e.id)>-1)r=i.filter(t=>t.id!==e.id);else{if(A&&i.length>=A)return;r=[...i,e]}v.setSelectedEntities(r),t&&t(r)}},[t,v.selectedEntities]),B=(0,s.useCallback)(t=>{!r&&e?(g.onAnalyticsEvent?.("reference_selected_single",{path:m,entityId:t.id}),e(t),p.close(!1)):w(t)},[p,r,e,w]),k=(0,s.useCallback)(()=>{g.onAnalyticsEvent?.("reference_selection_new_entity",{path:m}),h.open({path:m,collection:n,updateUrl:!0,onUpdate:({entity:e})=>{Z([e,...b]),B(e)},closeOnSave:!0})},[h,m,n,b,B]),E=(0,s.useCallback)(({entity:e,size:t,width:o,frozen:l})=>{let a=v.selectedEntities,s=a&&a.map(e=>e.id).indexOf(e.id)>-1;return(0,i.tZ)(oW,{width:o,frozen:l,entity:e,size:t,isSelected:s,selectionEnabled:r,toggleEntitySelection:w,hideId:n?.hideIdFromCollection})},[r,v.selectedEntities,w,n?.hideIdFromCollection]),S=(0,s.useCallback)(e=>{e.stopPropagation(),p.close(!1)},[p]);if(!n)return(0,i.tZ)(rz,{error:"Could not find collection with id "+n});let I=lg({fullPath:m,collection:n,entitiesDisplayedFirst:b,isFilterCombinationValid:lm});return(0,i.BX)(c.Z,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,i.tZ)(c.Z,{sx:{flexGrow:1},children:b&&(0,i.tZ)(lt,{fullPath:m,onEntityClick:B,forceFilter:d,tableController:I,tableRowActionsBuilder:E,title:(0,i.tZ)(u.Z,{variant:"h6",children:n.singularName?`Select ${n.singularName}`:`Select from ${n.name}`}),...n,inlineEditing:!1,selectionController:v,actions:(0,i.tZ)(lx,{collection:n,path:m,onNewClick:k,onClear:x})})}),(0,i.BX)(oS,{translucent:!1,children:[a&&(0,i.tZ)(u.Z,{variant:"body2",sx:{flexGrow:1,textAlign:"left"},children:a}),(0,i.tZ)(C.Z,{onClick:S,color:"primary",variant:"contained",children:"Done"})]})]})}function lx({collection:e,path:t,onClear:r,onNewClick:n}){let o=rf(),l=(0,A.Z)(),a=(0,K.Z)(l.breakpoints.up("md")),s=n7(e,o,iL(t),null)&&n&&(a?(0,i.BX)(C.Z,{onClick:n,startIcon:(0,i.tZ)(eT.Z,{}),size:"large",variant:"outlined",color:"primary",children:["Add ",e.singularName??e.name]}):(0,i.tZ)(C.Z,{onClick:n,size:"medium",variant:"outlined",color:"primary",children:(0,i.tZ)(eT.Z,{})}));return(0,i.BX)(i.HY,{children:[(0,i.tZ)(C.Z,{onClick:r,color:"primary",children:"Clear"}),s]})}function lw(e){return Array.isArray(e)?e:e?[e]:[]}function lC({children:e,group:t}){let r=rC();return(0,i.tZ)(nM,{invisible:!0,initiallyExpanded:!(r?.collapsedGroups??[]).includes(t??"ungrouped"),onExpandedChange:e=>{if(r){if(e)r.setCollapsedGroups((r.collapsedGroups??[]).filter(e=>e!==(t??"ungrouped")));else{let e=(r.collapsedGroups??[]).concat(t??"ungrouped");r.setCollapsedGroups(e)}}},title:(0,i.tZ)(u.Z,{color:"textSecondary",className:"weight-500",sx:{ml:1},children:t?.toUpperCase()??"UNGROUPED VIEWS"}),children:(0,i.tZ)(c.Z,{mb:2,children:e})})}function lB({view:e,path:t,collection:r,url:n,name:o,description:l,onClick:a}){let s;let d=rC(),A=ot(r??e),h=(0,eC.s0)(),f=rk(),g=(d?.favouritePaths??[]).includes(t);if(f.plugins&&r){let e={path:t,collection:r,context:f};s=(0,i.tZ)(i.HY,{children:f.plugins.map((t,r)=>t.homePage?.CollectionActions?(0,i.tZ)(t.homePage.CollectionActions,{...e,extraProps:t.homePage.extraProps},`actions_${r}`):null)})}return(0,i.tZ)(R.Z,{elevation:0,sx:{height:"100%"},children:(0,i.BX)(ed.Z,{component:"div",sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:248,height:"100%"},onClick:()=>{a?.(),h(n),d&&d.setRecentlyVisitedPaths([t,...(d.recentlyVisitedPaths??[]).filter(e=>e!==t)])},children:[(0,i.BX)(ec.Z,{sx:{flexGrow:1,width:"100%"},children:[(0,i.BX)(c.Z,{sx:{height:40,display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[(0,i.tZ)(A,{color:"disabled"}),(0,i.BX)(c.Z,{sx:{display:"flex",alignItems:"center",gap:1},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:[s,d&&(0,i.tZ)(p.Z,{size:"small",onClick:e=>{e.preventDefault(),e.stopPropagation(),g?d.setFavouritePaths(d.favouritePaths.filter(e=>e!==t)):d.setFavouritePaths([...d.favouritePaths,t])},children:g?(0,i.tZ)(tC.Z,{color:"secondary"}):(0,i.tZ)(tw.Z,{color:"disabled"})})]})]}),(0,i.tZ)(u.Z,{gutterBottom:!0,variant:"h5",component:"h2",children:o}),l&&(0,i.tZ)(u.Z,{variant:"body2",color:"textSecondary",component:"div",children:(0,i.tZ)(r0,{source:l})})]}),(0,i.tZ)(eu.Z,{style:{alignSelf:"flex-end"},children:(0,i.tZ)(c.Z,{p:1,children:(0,i.tZ)(tx.Z,{color:"primary"})})})]})})}function lk({entry:e}){let t=(0,eC.s0)(),r=rC();if(!r)return null;let n=r.favouritePaths.includes(e.path);return(0,i.tZ)(x.Z,{label:e.name,onClick:()=>t(e.url),onDelete:t=>{t.preventDefault(),t.stopPropagation(),n?r.setFavouritePaths(r.favouritePaths.filter(t=>t!==e.path)):r.setFavouritePaths([...r.favouritePaths,e.path])},deleteIcon:n?(0,i.tZ)(tC.Z,{color:"secondary"}):(0,i.tZ)(tw.Z,{color:"disabled"})},e.path)}function lE({hidden:e}){let t=rk(),r=rp(),n=rC();if(!n)return null;let o=(n?.favouritePaths??[]).map(e=>r.topLevelNavigation?.navigationEntries.find(t=>t.path===e)).filter(Boolean),l=(n?.recentlyVisitedPaths??[]).map(e=>r.topLevelNavigation?.navigationEntries.find(t=>t.path===e)).filter(Boolean).slice(0,5),a=(0,i.tZ)(V.Z,{in:!e&&o.length>0,children:(0,i.tZ)(lC,{group:"Favourites",children:(0,i.tZ)(Z.ZP,{container:!0,spacing:2,children:o.map(e=>(0,i.tZ)(Z.ZP,{item:!0,xs:12,sm:6,lg:4,children:(0,i.tZ)(lB,{...e,onClick:()=>{let r="collection"===e.type?"home_favorite_navigate_to_collection":"view"===e.type?"home_favorite_navigate_to_view":"unmapped_event";t.onAnalyticsEvent?.(r,{path:e.path})}})},`nav_${e.group}_${e.name}`))})})});return(0,i.BX)(c.Z,{children:[(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1,pb:2},children:l.map(e=>(0,i.tZ)(lk,{entry:e},e.path))}),a]})}function lS(){let e=s.useRef({}),t=(0,eC.TH)(),r=s.createRef(),[i,n]=s.useState(0),[o,l]=s.useState("down"),a=(0,s.useCallback)(()=>{r.current&&t.key&&(e.current[t.key]=r.current.scrollTop,n(r.current.scrollTop),l(r.current.scrollTop>i?"down":"up"))},[r,t.key,i]);return(0,s.useEffect)(()=>{let e=r.current;if(e)return e.addEventListener("scroll",a,{passive:!0}),()=>{e&&e.removeEventListener("scroll",a)}},[r,a,t]),(0,s.useEffect)(()=>{r.current&&e.current&&e.current[t.key]&&r.current.scrollTo({top:e.current[t.key],behavior:"auto"})},[t]),{containerRef:r,scroll:i,direction:o}}let lI=new tL.Z({charset:"latin:advanced",tokenize:"full"});function lF({additionalChildren:e}){let t;let r=rk(),n=rp();if(!n.topLevelNavigation)throw Error("Navigation not ready in FireCMSHomePage");let{containerRef:o,scroll:l,direction:a}=lS(),{navigationEntries:d,groups:u}=n.topLevelNavigation,[A,p]=(0,s.useState)(null),h=A?d.filter(e=>A.includes(e.url)):d;(0,s.useEffect)(()=>{h.forEach(e=>{lI.addAsync(e.url,`${e.name} ${e.description} ${e.group} ${e.path}`)})},[d]);let f=(0,s.useCallback)(e=>{e&&""!==e?lI.searchAsync(e).then(e=>{p(e)}):p(null)},[]),g=[...u];if((h.filter(e=>!e.group).length>0||0===h.length)&&g.push(void 0),r.plugins){let e={context:r};t=(0,i.tZ)(i.HY,{children:r.plugins.filter(e=>e.homePage?.includeSection).map((t,r)=>{let n=t.homePage.includeSection(e);return(0,i.tZ)(lC,{group:n.title,children:n.children},`plugin_section_${t.name}`)})})}return(0,i.tZ)(c.Z,{ref:o,sx:{py:2,overflow:"auto",height:"100%",width:"100%"},children:(0,i.BX)($.Z,{children:[(0,i.tZ)(c.Z,{sx:{position:"sticky",py:2,transition:"top 0.4s ease-in-out",top:0,zIndex:10},children:(0,i.tZ)(oH,{onTextSearch:f,placeholder:"Search collections",large:!1})}),(0,i.tZ)(lE,{hidden:!!A}),g.map((e,t)=>{let n=[],o={group:e,context:r};r.plugins&&r.plugins.forEach(e=>{e.homePage?.AdditionalCards&&n.push(...lw(e.homePage?.AdditionalCards))});let l=h.filter(t=>t.group===e||!t.group&&void 0===e);return 0===l.length&&0===n.length?null:(0,i.tZ)(lC,{group:e,children:(0,i.BX)(Z.ZP,{container:!0,spacing:2,children:[l.map(e=>(0,i.tZ)(Z.ZP,{item:!0,xs:12,sm:6,lg:4,children:(0,i.tZ)(lB,{...e,onClick:()=>{let t="collection"===e.type?"home_navigate_to_collection":"view"===e.type?"home_navigate_to_view":"unmapped_event";r.onAnalyticsEvent?.(t,{path:e.path})}})},`nav_${e.group}_${e.name}`)),n&&n.map((t,r)=>(0,i.tZ)(Z.ZP,{item:!0,xs:12,sm:6,lg:4,children:(0,i.tZ)(t,{...o})},`nav_${e}_"add_${r}`))]})},`plugin_section_${e}`)}),t,e]})})}function lR(){return(0,i.tZ)(c.Z,{display:"flex",width:"100%",height:"100%",children:(0,i.BX)(c.Z,{m:"auto",display:"flex",alignItems:"center",flexDirection:"column",children:[(0,i.tZ)(u.Z,{variant:"h4",align:"center",gutterBottom:!0,children:"Page not found"}),(0,i.tZ)(u.Z,{align:"center",gutterBottom:!0,children:"This page does not exist or you may not have access to it"}),(0,i.tZ)(C.Z,{component:eB.rU,to:"/",children:"Back to home"})]})})}function lQ({width:e,height:t,style:r}){return(0,i.BX)("svg",{width:e??"100%",height:t??"100%",viewBox:"0 0 599 599",version:"1.1",style:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,i.BX)("defs",{children:[(0,i.BX)("radialGradient",{cx:"28.6213569%",cy:"43.1133328%",fx:"28.6213569%",fy:"43.1133328%",r:"71.5003456%",gradientTransform:"translate(0.286214,0.431133),rotate(3.343450),scale(1.000000,0.996175),translate(-0.286214,-0.431133)",id:"radialGradient-1",children:[(0,i.tZ)("stop",{stopColor:"#FF5B79",offset:"0%"}),(0,i.tZ)("stop",{stopColor:"#FA5574",offset:"28.0930803%"}),(0,i.tZ)("stop",{stopColor:"#EC4C51",offset:"44.7242531%"}),(0,i.tZ)("stop",{stopColor:"#9543C1",offset:"71.4578165%"}),(0,i.tZ)("stop",{stopColor:"#3857B3",offset:"100%"})]}),(0,i.BX)("radialGradient",{cx:"53.6205516%",cy:"47.2473036%",fx:"53.6205516%",fy:"47.2473036%",r:"50.8229649%",gradientTransform:"translate(0.536206,0.472473),rotate(90.000000),scale(1.000000,1.206631),translate(-0.536206,-0.472473)",id:"radialGradient-2",children:[(0,i.tZ)("stop",{stopColor:"#68294F",stopOpacity:"0",offset:"0%"}),(0,i.tZ)("stop",{stopColor:"#5E2548",stopOpacity:"0.04641108",offset:"75.3503173%"}),(0,i.tZ)("stop",{stopColor:"#0D060B",stopOpacity:"0.437431709",offset:"100%"})]}),(0,i.BX)("radialGradient",{cx:"53.8605015%",cy:"48.1990423%",fx:"53.8605015%",fy:"48.1990423%",r:"59.9151549%",gradientTransform:"translate(0.538605,0.481990),rotate(180.000000),scale(1.000000,0.925027),translate(-0.538605,-0.481990)",id:"radialGradient-3",children:[(0,i.tZ)("stop",{stopColor:"#68294F",stopOpacity:"0",offset:"0%"}),(0,i.tZ)("stop",{stopColor:"#5E2548",stopOpacity:"0.04641108",offset:"84.0867343%"}),(0,i.tZ)("stop",{stopColor:"#FF0000",stopOpacity:"0.567324765",offset:"100%"})]})]}),(0,i.tZ)("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:(0,i.BX)("g",{id:"firecms_logo",children:[(0,i.tZ)("circle",{fill:"url(#radialGradient-1)",cx:"299.5",cy:"299.5",r:"299.5"}),(0,i.tZ)("circle",{fill:"url(#radialGradient-2)",cx:"299.5",cy:"299.5",r:"299.5"}),(0,i.tZ)("circle",{fill:"url(#radialGradient-3)",cx:"299.5",cy:"299.5",r:"299.5"})]})})]})}function lD({children:e,maxWidth:t,fullScreen:r=!1,fadeTimeout:n=800}){return(0,i.tZ)(eA.Z,{in:!0,appear:!0,timeout:n,mountOnEnter:!0,unmountOnExit:!0,children:(0,i.BX)(c.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:r?"100vh":"100%","@supports (height: 100dvh)":{height:r?"100dvh":"100%"},justifyContent:t?void 0:"center",maxHeight:"100%",gap:2,p:2},children:[t&&(0,i.tZ)(c.Z,{sx:{width:"100%",margin:"auto",maxWidth:t},children:e}),!t&&e]})})}function lP({hovered:e,drawerOpen:t,closeDrawer:r}){let n=rk(),o=rp(),l=e&&!t;if(!o.topLevelNavigation)throw Error("Navigation not ready in Drawer");let{navigationEntries:a,groups:d}=o.topLevelNavigation,A=Object.values(a).filter(e=>!e.group),p=(0,s.useCallback)(e=>t?(0,i.tZ)(c.Z,{pt:2,pl:2,pr:2,pb:.5,sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,i.tZ)(u.Z,{variant:"caption",color:"textSecondary",className:"weight-500",sx:{flexGrow:1},children:e?e.toUpperCase():"UNGROUPED VIEWS"})}):(0,i.tZ)(c.Z,{sx:{height:16}}),[t]),h=e=>{let t="collection"===e.type?"drawer_navigate_to_collection":"view"===e.type?"drawer_navigate_to_view":"unmapped_event";n.onAnalyticsEvent?.(t,{url:e.url})};return(0,i.BX)(ep.Z,{children:[d.map(e=>(0,i.BX)(s.Fragment,{children:[p(e),Object.values(a).filter(t=>t.group===e).map((e,r)=>(0,i.tZ)(lM,{Icon:ot(e.collection??e.view),tooltipsOpen:l,drawerOpen:t,onClick:()=>h(e),url:e.url,name:e.name},`navigation_${r}`))]},`drawer_group_${e}`)),A.length>0&&p(),A.map((e,r)=>(0,i.tZ)(lM,{Icon:ot(e.collection??e.view),tooltipsOpen:l,onClick:()=>h(e),drawerOpen:t,url:e.url,name:e.name},`navigation_${r}`))]})}function lM({name:e,Icon:t,drawerOpen:r,tooltipsOpen:n,url:o,onClick:l}){let a=(0,A.Z)(),s=(0,i.BX)(eh.ZP,{button:!0,component:eB.OL,onClick:l,style:({isActive:e})=>({fontWeight:e?"600":"500",background:e?"light"===a.palette.mode?(0,W._j)(a.palette.background.default,.1):(0,W.$n)(a.palette.background.default,.08):"inherit",minHeight:"48px",borderRadius:"0 16px 16px 0"}),sx:e=>({pl:3,alignItems:"center"}),to:o,children:[(0,i.tZ)(t,{fontSize:"medium",sx:e=>({color:"dark"===e.palette.mode?tY.Z[500]:tY.Z[700]})}),(0,i.tZ)(u.Z,{variant:"subtitle2",sx:{opacity:r?1:0,fontWeight:"inherit",ml:3,p:.5},children:e.toUpperCase()})]});return r?s:(0,i.tZ)(d.Z,{open:n,placement:"right",title:e,children:s})}let lT=s.memo(function(e){let{children:t,name:r,logo:n,toolbarExtraWidget:o,Drawer:l,autoOpenDrawer:a,FireCMSAppBarComponent:d=lO}=e,u=(0,A.Z)(),p=(0,K.Z)(u.breakpoints.up("md")),h=rp(),{containerRef:f}=lS(),[g,m]=s.useState(!1),[y,b]=s.useState(!1),Z=(0,s.useCallback)(()=>b(!0),[]),v=(0,s.useCallback)(()=>b(!1),[]),x=l||lP,w=(0,s.useCallback)(()=>{m(!1)},[]),C=g||!!(p&&a&&y);return(0,i.BX)(c.Z,{sx:{display:"flex",height:"100vh","@supports (height: 100dvh)":{height:"100dvh"},width:"100vw",pt:"env(safe-area-inset-top)",pl:"env(safe-area-inset-left)",pr:"env(safe-area-inset-right)",pb:"env(safe-area-inset-bottom)"},children:[(0,i.tZ)(d,{title:r,drawerOpen:C,toolbarExtraWidget:o}),(0,i.tZ)(lz,{onMouseEnter:Z,onMouseMove:Z,onMouseLeave:v,open:C,logo:n,hovered:!!a&&y,setDrawerOpen:m,children:(0,i.tZ)("nav",{children:h.loading?(0,i.tZ)(oR,{}):(0,i.tZ)(x,{hovered:y,drawerOpen:C,closeDrawer:w})})}),(0,i.BX)(c.Z,{component:"main",sx:{display:"flex",flexDirection:"column",flexGrow:1,width:"100%",height:"100%",overflow:"auto"},children:[(0,i.tZ)(lV,{}),(0,i.tZ)(c.Z,{ref:f,sx:{flexGrow:1,m:p?2:0,mt:p?0:1,borderRadius:p?"12px":void 0,border:p?`1px solid ${u.palette.divider}`:void 0,height:"100%",overflow:"auto"},children:(0,i.tZ)(i4,{children:t})})]})]})},eY()),lV=(0,J.ZP)("div")(({theme:e})=>({display:"flex",flexDirection:"column",...e.mixins.toolbar}));function lz(e){let t;let r=rk(),n=(0,A.Z)(),o=(0,K.Z)(n.breakpoints.up("md")),{open:l,logo:a,setDrawerOpen:s,hovered:u,...h}=e;t=a?(0,i.tZ)("img",{style:{maxWidth:"100%",maxHeight:"100%"},src:a,alt:"Logo"}):(0,i.tZ)(lQ,{});let g=(0,i.tZ)(p.Z,{color:"inherit","aria-label":"Open drawer",edge:"start",onClick:()=>s(!0),size:"large",sx:{position:"absolute",top:8,left:24},children:(0,i.tZ)(tU.Z,{})});return(0,i.BX)(i.HY,{children:[!o&&g,(0,i.BX)(ef.ZP,{...h,variant:o?"permanent":"temporary",open:l,onClose:o?void 0:()=>{s(!1)},sx:{width:280,flexShrink:0,height:"100%",whiteSpace:"nowrap",boxSizing:"border-box",border:"none",...l&&{...lY(n),"& .MuiDrawer-paper":lY(n)},...!l&&{...lG(n,o),"& .MuiDrawer-paper":lG(n,o)}},children:[(0,i.tZ)(p.Z,{onClick:()=>s(!1),sx:{position:"absolute",right:16,top:16,opacity:l?1:0,transition:n.transitions.create("opacity",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen})},children:"rtl"===n.direction?(0,i.tZ)(t$.Z,{}):(0,i.tZ)(tj.Z,{})}),(0,i.tZ)(eg.Z,{sx:{position:"absolute",left:l?"-100%":0,right:l?void 0:0,opacity:l?0:1,backgroundColor:n.palette.background.default,transition:n.transitions.create(["left","opacity"],{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen})},children:l?g:(0,i.tZ)(d.Z,{title:"Open menu",placement:"right",children:g})}),(0,i.BX)(c.Z,{sx:{height:"100%",width:"100%",overflow:"auto"},children:[(0,i.tZ)(f.Z,{color:"inherit",component:eB.OL,to:".",sx:e=>({display:"block",transition:e.transitions.create(["padding"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),p:e.spacing(l?4:9,l?12:2,0,l?3:2)}),children:(0,i.tZ)(d.Z,{title:"Home",placement:"right",children:(0,i.tZ)("div",{onClick:()=>{r.onAnalyticsEvent?.("drawer_navigate_to_home")},children:t})})},"breadcrumb-home"),e.children]}),(0,i.BX)(f.Z,{sx:e=>({width:280,position:"fixed",bottom:0,left:l?0:"-100%",opacity:l?1:0,transition:e.transitions.create(["left","opacity"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),px:"24px",py:1,display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,background:"light"===e.palette.mode?"rgba(255,255,255,0.6)":(0,W.Fq)(e.palette.background.paper,.1),backdropFilter:"blur(8px)"}),href:"https://firecms.co?utm_source=drawer",onMouseDown:e=>{e.preventDefault()},target:"_blank",children:[(0,i.tZ)(tc.Z,{style:{marginRight:"24px"},fontSize:"small"}),"firecms.co"]})]})]})}let lY=e=>({willChange:"width",pb:"32px",width:280,border:"none",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),backgroundColor:e.palette.background.default,overflowX:"hidden"}),lG=(e,t)=>({willChange:"width",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),border:"none",overflowX:"hidden",backgroundColor:e.palette.background.default,width:t?`calc(${e.spacing(9)})`:"0px"}),lO=function({title:e,toolbarExtraWidget:t,drawerOpen:r}){let n=rP(),{breadcrumbs:o}=n,l=rf(),{mode:a,toggleMode:s}=rQ(),d=(0,A.Z)(),h=(0,K.Z)(d.breakpoints.up("md")),g=l.user?.displayName?l.user.displayName[0].toUpperCase():l.user?.email?l.user.email[0].toUpperCase():"A";return(0,i.tZ)(c.Z,{sx:{position:"fixed",marginLeft:d.spacing(8),width:`calc(100% - ${d.spacing(8)})`,zIndex:h?d.zIndex.drawer+1:void 0,transition:d.transitions.create(["width","margin"],{easing:d.transitions.easing.sharp,duration:d.transitions.duration.leavingScreen}),...r&&h&&{marginLeft:"calc(280px - 8px)",width:"calc(100% - 280px)",transition:d.transitions.create(["width","margin"],{easing:d.transitions.easing.sharp,duration:d.transitions.duration.enteringScreen})}},children:(0,i.tZ)(ei.Z,{direction:"down",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:(0,i.BX)(eg.Z,{sx:{gap:1},children:[(0,i.tZ)(q.Z,{lgDown:!0,children:(0,i.tZ)(c.Z,{mr:2,children:(0,i.tZ)(f.Z,{underline:"none",color:"inherit",component:eB.rU,to:".",children:(0,i.tZ)(u.Z,{variant:"h6",noWrap:!0,className:"weight-500",children:e})},"breadcrumb-home")})}),h&&(0,i.tZ)(c.Z,{children:(0,i.tZ)(em.Z,{separator:(0,i.tZ)(tD.Z,{htmlColor:"rgb(0,0,0,0.87)",fontSize:"small"}),"aria-label":"breadcrumb",children:o.map((e,t)=>(0,i.tZ)(f.Z,{underline:"none",color:"inherit",component:eB.rU,to:e.url,children:(0,i.tZ)(x.Z,{sx:e=>({backgroundColor:e.palette.grey[200],height:e.spacing(3),color:e.palette.grey[800],fontWeight:e.typography.fontWeightMedium,"&:hover, &:focus":{cursor:"pointer",backgroundColor:e.palette.grey[300]},"&:active":{boxShadow:e.shadows[1],backgroundColor:e.palette.grey[400]}}),label:e.title})},`breadcrumb-${t}`))})}),(0,i.tZ)(c.Z,{flexGrow:1}),t&&(0,i.tZ)(i4,{children:t}),(0,i.tZ)(c.Z,{p:1,children:(0,i.tZ)(p.Z,{color:"inherit","aria-label":"Open drawer",edge:"start",onClick:()=>s(),size:"large",children:"dark"===a?(0,i.tZ)(tQ.Z,{}):(0,i.tZ)(tR.Z,{})})}),(0,i.tZ)(c.Z,{p:1,children:l.user&&l.user.photoURL?(0,i.tZ)(ey.Z,{src:l.user.photoURL}):(0,i.tZ)(ey.Z,{children:g})}),(0,i.tZ)(C.Z,{variant:"text",color:"inherit",onClick:l.signOut,children:"Log Out"})]})})})},lW=s.memo(function({path:e,entityId:t,selectedSubPath:r,copy:n,collection:o,onValuesAreModified:l,formWidth:a,onUpdate:d,onClose:h}){let f=(0,A.Z)(),g=function(){let e=(0,A.Z)();return(0,K.Z)(e.breakpoints.up("xl"))}(),m=(0,s.useRef)(!g),y="number"==typeof a?`${a}px`:a??rd,b=ru(),Z=ld(),v=rb(),x=rx(),C=rk(),B=rf(),[k,E]=(0,s.useState)(void 0),[S,I]=(0,s.useState)(n?"copy":t?"existing":"new"),F=(0,s.useRef)(void 0),R=F.current,Q=(o.subcollections??[]).filter(e=>!e.hideFromNavigation),D=Q?.length??0,P=o.views,M=P?.length??0,T=(0,s.useCallback)(e=>{if(P){let t=P.map(e=>e.path).findIndex(t=>t===e);if(-1!==t)return t}if(Q){let t=Q.map(e=>e.path).findIndex(t=>t===e);if(-1!==t)return t+M}return -1},[P,M,Q]),V=M>0||D>0,z=r??iU(o?o.defaultSelectedView:void 0,{status:S,entityId:t}),[Y,G]=s.useState(z?T(z):-1),O=-1===Y||g,{entity:W,dataLoading:H,dataLoadingError:U}=rS({path:e,entityId:t,collection:o,useCache:!1}),[j,$]=s.useState(t),[L,X]=(0,s.useState)(W),[_,J]=(0,s.useState)(void 0);(0,s.useEffect)(()=>{W&&X(W)},[W]),(0,s.useEffect)(()=>{if("new"===S)J(!1);else{let t=!!L&&n9(o,B,iL(e),L??null);L&&J(!t)}},[B,L,S]),(0,s.useEffect)(()=>{m.current!==g&&(r!==z&&v.replace({path:e,entityId:t,selectedSubPath:z,updateUrl:!0,collection:o}),m.current=g)},[z,g,r]);let q=(0,s.useCallback)(e=>{x.open({type:"error",message:"Error before saving: "+e?.message}),console.error(e)},[x]),ee=(0,s.useCallback)(e=>{x.open({type:"error",message:"Error after saving (entity is saved): "+e?.message}),console.error(e)},[x]),et=(t,i)=>{x.open({type:"success",message:`${o.singularName??o.name}: Saved correctly`}),X(t),I("existing"),l(!1),d&&d({entity:t}),i?(Z.setBlocked(!1),Z.close(!0),h?.()):v.replace({path:e,entityId:t.id,selectedSubPath:r,updateUrl:!0,collection:o})},er=(0,s.useCallback)(r=>{x.open({type:"error",message:"Error saving: "+r?.message}),console.error("Error saving entity",e,t),console.error(r)},[t,e,x]),ei=(0,s.useCallback)(async({collection:e,path:t,entityId:r,values:i,previousValues:n,closeAfterSave:o})=>{if(S)return rI({path:t,entityId:r,values:i,previousValues:n,collection:e,status:S,dataSource:b,context:C,onSaveSuccess:e=>et(e,o),onSaveFailure:er,onPreSaveHookError:q,onSaveSuccessHookError:ee})},[S,o,b,C,et,er,q,ee]),en=P&&P.map((e,t)=>{if(Y!==t)return null;e.Builder&&console.warn("customView.builder is deprecated, use customView.Builder instead",e);let r=e.Builder??e.builder;return r?(0,i.tZ)(c.Z,{sx:{width:rs,height:"100%",overflow:"auto",borderLeft:`1px solid ${f.palette.divider}`,[f.breakpoints.down("lg")]:{borderLeft:"inherit",width:ra}},role:"tabpanel",flexGrow:1,children:(0,i.tZ)(i4,{children:(0,i.tZ)(r,{collection:o,entity:L,modifiedValues:R??L?.values})})},`custom_view_${e.path}`):(console.error("customView.Builder is not defined"),null)}).filter(Boolean),eo=H&&!L||(!L||void 0===_)&&("existing"===S||"copy"===S),el=Q&&Q.map((t,r)=>{let n=L?`${e}/${L?.id}/${rn(t.alias??t.path)}`:void 0;return Y!==r+M?null:(0,i.BX)(c.Z,{sx:{width:rs,height:"100%",overflow:"auto",borderLeft:`1px solid ${f.palette.divider}`,[f.breakpoints.down("lg")]:{borderLeft:"inherit",width:ra}},role:"tabpanel",flexGrow:1,children:[eo&&(0,i.tZ)(oR,{}),!eo&&(L&&n?(0,i.tZ)(ly,{fullPath:n,isSubCollection:!0,...t}):(0,i.tZ)(c.Z,{sx:{width:"100%",height:"100%",p:3},display:"flex",alignItems:"center",justifyContent:"center",children:(0,i.tZ)(u.Z,{variant:"label",children:"You need to save your entity before adding additional collections"})}))]},`subcol_${t.alias??t.path}`)}).filter(Boolean),ea=(0,s.useCallback)(e=>{if(-1!==e){if(P&&e<M)return P[e].path;if(Q)return Q[e-M].path;throw Error("Something is wrong in getSelectedSubPath")}},[M]),es=(0,s.useCallback)(()=>{l(!1)},[]),ed=r=>{G(r),v.replace({path:e,entityId:t,selectedSubPath:ea(r),updateUrl:!0,collection:o})},ec=(0,s.useCallback)(e=>{F.current=e},[]),eu=(0,s.useCallback)(e=>{X(t=>t?{...t,id:e}:void 0),$(e)},[]),eA=void 0===_?(0,i.tZ)(i.HY,{}):_?(0,i.tZ)(oa,{entity:L,path:e,collection:o}):function(){let t=C.plugins,r=(0,i.tZ)(n0,{status:S,path:e,collection:o,onEntitySave:ei,onDiscard:es,onValuesChanged:ec,onModified:l,entity:L,onIdChange:eu,onFormContextChange:E,hideId:o.hideIdFromForm});return t&&t.forEach(t=>{t.form?.provider&&(r=(0,i.tZ)(t.form.provider.Component,{status:S,path:e,collection:o,onEntitySave:ei,onDiscard:es,onValuesChanged:ec,onModified:l,entity:L,context:C,currentEntityId:j,formContext:k,...t.form.provider.props,children:r}))}),(0,i.tZ)(i4,{children:r})}(),ep=Q&&Q.map(e=>(0,i.tZ)(eb.Z,{sx:{fontSize:"0.875rem",minWidth:"140px"},wrapped:!0,label:e.name},`entity_detail_collection_tab_${e.name}`)),eh=P&&P.map(e=>(0,i.tZ)(eb.Z,{sx:{fontSize:"0.875rem",minWidth:"140px"},wrapped:!0,label:e.name},`entity_detail_custom_tab_${e.name}`)),ef=(0,i.BX)(c.Z,{sx:{paddingLeft:2,paddingRight:2,paddingTop:1,display:"flex",alignItems:"end",backgroundColor:"light"===f.palette.mode?f.palette.background.default:f.palette.background.paper},children:[(0,i.tZ)(c.Z,{sx:{pb:1,alignSelf:"center"},children:(0,i.tZ)(p.Z,{onClick:()=>(h?.(),Z.close(!1)),size:"large",children:(0,i.tZ)(eG.Z,{})})}),(0,i.tZ)(c.Z,{flexGrow:1}),eo&&(0,i.tZ)(c.Z,{sx:{alignSelf:"center"},children:(0,i.tZ)(N.Z,{size:16,thickness:8})}),(0,i.BX)(eZ.Z,{value:Y+1,indicatorColor:"secondary",textColor:"inherit",onChange:(e,t)=>{ed(t-1)},sx:{paddingLeft:f.spacing(1),paddingRight:f.spacing(1),paddingTop:f.spacing(0)},variant:"scrollable",scrollButtons:"auto",children:[(0,i.tZ)(eb.Z,{label:o.singularName??o.name,disabled:!V,onClick:()=>{ed(-1)},sx:{display:V?void 0:"none",fontSize:"0.875rem",minWidth:"140px"},wrapped:!0}),eh,ep]})]});return(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%",transition:"width 250ms ease-in-out"},children:(0,i.BX)(i.HY,{children:[ef,(0,i.tZ)(w.Z,{}),(0,i.BX)(c.Z,{sx:{flexGrow:1,height:"100%",width:`calc(${rs} + ${y})`,maxWidth:"100%",[`@media (max-width: ${y})`]:{width:y},display:"flex",overflow:"auto",flexDirection:"row"},children:[(0,i.tZ)(c.Z,{sx:{position:"relative",maxWidth:"100%"},children:(0,i.tZ)(c.Z,{role:"tabpanel",hidden:!O,id:`form_${e}`,sx:{width:y,maxWidth:"100%",height:"100%",overflow:"auto",[f.breakpoints.down("sm")]:{maxWidth:ra,width:ra}},children:eo?(0,i.tZ)(oR,{}):eA})}),en,el]})]})})},eY());function lH(e){let{blocked:t,setBlocked:r,setBlockedNavigationMessage:n}=ld();console.log("EntitySidePanel",e);let o=rp(),l=(0,s.useMemo)(()=>{if(!e)return;let t=e.collection;if(!t&&!(t=o.getCollection(e.path,e.entityId)))throw console.error("ERROR: No collection found in path `",e.path,"`. Entity id: ",e.entityId),Error("ERROR: No collection found in path `"+e.path+"`. Make sure you have defined a collection for this path in the root navigation.");return t},[o,e]);(0,s.useEffect)(()=>{function e(e){t&&l&&(e.preventDefault(),e.returnValue=`You have unsaved changes in this ${l.name}. Are you sure you want to leave this page?`)}return"u">typeof window&&window.addEventListener("beforeunload",e),()=>{"u">typeof window&&window.removeEventListener("beforeunload",e)}},[t,l]);let a=(0,s.useCallback)(e=>{r(e),n(e?(0,i.BX)(i.HY,{children:[" You have unsaved changes in this ",(0,i.tZ)("b",{children:l?.name}),"."]}):void 0)},[l?.name,r,n]);return e&&l?(0,i.tZ)(i.HY,{children:(0,i.tZ)(i4,{children:(0,i.tZ)(lW,{...e,formWidth:e.width,collection:l,onValuesAreModified:a})})}):(0,i.tZ)("div",{style:{width:rd}})}let lU=(e,t)=>{let r=(0,eC.TH)(),i=(0,s.useRef)(!1),n=(0,A.Z)(),o=(0,K.Z)(n.breakpoints.down("sm"));(0,s.useEffect)(()=>{if(!e.loading&&!i.current){if(e.isUrlCollectionPath(r.pathname)){let i="#new"===r.hash,n=e.urlPathToDataPath(r.pathname),l=function(e,t,r){let i=function e(t){let{path:r,collections:i=[],currentFullPath:n}=t,o=rn(r).split("/"),l=rl(o),a=[];for(let t=0;t<l.length;t++){let o=l[t],s=i&&i.find(e=>e.alias===o||e.path===o);if(s){let t=s.alias??s.path,i=n&&n.length>0?n+"/"+t:t;a.push({type:"collection",path:i,collection:s});let l=rn(rn(r).replace(o,"")),d=l.length>0?l.split("/"):[];if(d.length>0){let t=d[0],r=i+"/"+t;if(a.push({type:"entity",entityId:t,path:i,parentCollection:s}),d.length>1){let t=d.slice(1).join("/");if(!s)throw Error("collection not found resolving path: "+s);let i=s.views,o=i&&i.find(e=>e.path===t);if(o){let e=n&&n.length>0?n+"/"+o.path:o.path;a.push({type:"custom_view",path:e,view:o})}else s.subcollections&&a.push(...e({path:t,customViews:i,collections:s.subcollections,currentFullPath:r}))}}break}}return a}({path:e,collections:t}),n=[],o="";for(let e=0;e<i.length;e++){let t=i[e];if("collection"===t.type&&(o=t.path),e>0){let r=i[e-1];if("entity"===t.type)n.push({path:t.path,entityId:t.entityId,copy:!1});else if("custom_view"===t.type){if("entity"===r.type){let e=n[n.length-1];e&&(e.selectedSubPath=t.view.path)}}else if("collection"===t.type&&"entity"===r.type){let e=n[n.length-1];e&&(e.selectedSubPath=t.collection.alias??t.collection.path)}}}return r&&n.push({path:o,copy:!1}),n}(n,e.collections,i);t.replace(l.map(t=>lj(t,e,o)))}i.current=!0}},[r,e,t,o]);let l=(0,s.useCallback)(()=>{t.close()},[t]),a=(0,s.useCallback)(r=>{if(r.copy&&!r.entityId)throw Error("If you want to copy an entity you need to provide an entityId");let i=iU(r.collection?r.collection.defaultSelectedView:void 0,{status:r.copy?"copy":r.entityId?"existing":"new",entityId:r.entityId});t.open(lj({selectedSubPath:i,...r},e,o))},[t,e,o]),d=(0,s.useCallback)(r=>{if(r.copy&&!r.entityId)throw Error("If you want to copy an entity you need to provide an entityId");t.replace(lj(r,e,o))},[e,t,o]);return{close:l,open:a,replace:d}},lj=(e,t,r)=>{let n=rn(e.path),o=e.entityId?t.buildUrlCollectionPath(`${n}/${e.entityId}/${e.selectedSubPath||""}`):t.buildUrlCollectionPath(`${n}#new`);return{key:`${e.path}/${e.entityId}`,component:(0,i.tZ)(lH,{...e}),urlPath:o,parentUrlPath:t.buildUrlCollectionPath(n),width:function(e,t){if(t)return ra;let r=!e.selectedSubPath,i="number"==typeof e.width?`${e.width}px`:e.width;return r?i??rd:`calc(${rs} + ${i??rd})`}(e,r),onClose:e.onClose}};function l$(e){return encodeURIComponent(rn(e)).replaceAll("%2F","/").replaceAll("%23","#")}async function lL(e,t,r,i){let n=[];return"function"==typeof e?n=await e({user:t.user,authController:t,dataSource:r}):Array.isArray(e)&&(n=e),n=function e(t,r){return t.filter(e=>!e.permissions||!1!==n6(e,r,[e.path],null).read).map(t=>t.subcollections?{...t,subcollections:e(t.subcollections,r)}:t)}(n,t),i&&i.forEach(e=>{e.collections?.injectCollections&&(n=e.collections?.injectCollections(n??[]))}),n}async function lN(e,t,r){let i=[];return"function"==typeof e?i=await e({user:t.user,authController:t,dataSource:r}):Array.isArray(e)&&(i=e),i}function lX(e){let t=rQ(),{children:r,collections:d,views:c,entityLinkBuilder:u,userConfigPersistence:A,dateTimeFormat:p,locale:h,authController:f,collectionOverrideHandler:g,storageSource:m,dataSource:y,basePath:b,baseCollectionPath:Z,plugins:v,onAnalyticsEvent:x,fields:w}=e,C=h?a[h]:void 0,B=function({basePath:e,baseCollectionPath:t,authController:r,collections:i,views:n,collectionOverrideHandler:o,userConfigPersistence:l,plugins:a,dataSource:d}){let c=(0,eC.TH)(),[u,A]=(0,s.useState)(),[p,h]=(0,s.useState)(),[f,g]=(0,s.useState)(!1),[m,y]=(0,s.useState)(void 0),[b,Z]=(0,s.useState)(!0),[v,x]=(0,s.useState)(void 0),w=rn(e),C=rn(t),B=w?`/${w}`:"/",k=w?`/${w}/${C}`:`/${C}`,E=(0,s.useCallback)(e=>w?`/${w}/${l$(e)}`:`/${l$(e)}`,[w]),S=(0,s.useCallback)(e=>`${rn(t)}/${l$(e)}`,[t]),I=(0,s.useCallback)((e,t)=>{let r=[...(e??[]).map(e=>e.hideFromNavigation?void 0:{url:S(e.alias??e.path),type:"collection",name:e.name.trim(),path:e.alias??e.path,collection:e,description:e.description?.trim(),group:e.group?.trim()}).filter(Boolean),...(t??[]).map(e=>e.hideFromNavigation?void 0:{url:E(Array.isArray(e.path)?e.path[0]:e.path),name:e.name.trim(),type:"view",view:e,description:e.description?.trim(),group:e.group?.trim()}).filter(Boolean)],i=Object.values(r).map(e=>e.group).filter(Boolean).filter((e,t,r)=>r.indexOf(e)===t);return{navigationEntries:r,groups:i}},[E,S]),F=(0,s.useCallback)(async()=>{try{let[e=[],t=[]]=await Promise.all([lL(i,r,d,a),lN(n,r,d)]);A(e),h(t),y(I(e??[],t))}catch(e){console.error(e),x(e)}Z(!1),g(!0)},[i,r.user,d,a,n,I]);(0,s.useEffect)(()=>{F()},[F]);let R=(0,s.useCallback)((e,t,r=!1)=>{if(!u)return;let i=ro(rn(e),u),n=r?l?.getCollectionConfig(e):void 0,a=i?iP(i,n):void 0,s=a,d=o&&o({entityId:t,path:rn(e)});if(d&&(s=d),a){let e=a.subcollections,t=a.callbacks,r=a.permissions;s={...s,subcollections:s?.subcollections??e,callbacks:s?.callbacks??t,permissions:s?.permissions??r}}if(s)return{...a,...s}},[e,t,u,o]),Q=(0,s.useCallback)(e=>rn(e+"/").startsWith(rn(k)+"/"),[k]),D=(0,s.useCallback)(e=>{if(e.startsWith(k))return e.replace(k,"");throw Error("Expected path starting with "+k)},[k]),P=(0,s.useCallback)(({path:e})=>`s/edit/${l$(e)}`,[]),M=(0,s.useCallback)(e=>{if(!u)throw Error("Collections have not been initialised yet");return function e(t,r){let i;let n=rn(t),o=n.split("/");if(o.length%2==0)throw Error(`Collection paths must have an odd number of segments: ${t}`);let l=r.find(e=>e.alias===o[0]);if(l&&(i=l.path),!(o.length>1))return i??n;{let t=ro(i??o[0],r);if(!t?.subcollections)return n;let l=n.split("/").slice(2).join("/");return(i??o[0])+"/"+o[1]+"/"+e(l,t.subcollections)}}(e,u)},[u]),T=c.state,V=T&&T.base_location?T.base_location:c,z=(0,s.useCallback)(e=>(function e(t){let{path:r,collections:i=[],currentFullPath:n}=t,o=rn(r).split("/"),l=rl(o),a=[];for(let t=0;t<l.length;t++){let o=l[t],s=i&&i.find(e=>e.alias===o||e.path===o);if(s){let t=s.alias??s.path,i=n&&n.length>0?n+"/"+t:t,l=rn(rn(r).replace(o,"")),d=l.length>0?l.split("/"):[];if(d.length>0){let t=d[0],r=i+"/"+t;if(a.push(new rY(t,i)),d.length>1){let t=d.slice(1).join("/");if(!s)throw Error("collection not found resolving path: "+s);s.subcollections&&a.push(...e({path:t,collections:s.subcollections,currentFullPath:r}))}}break}}return a})({path:e,collections:u}),[u]);return{collections:u??[],views:p??[],loading:!f||b,navigationLoadingError:v,homeUrl:B,basePath:e,baseCollectionPath:t,initialised:f,getCollection:R,isUrlCollectionPath:Q,urlPathToDataPath:D,buildUrlCollectionPath:S,buildUrlEditCollectionPath:P,buildCMSUrlPath:E,resolveAliasesFrom:M,topLevelNavigation:m,baseLocation:V,refreshNavigation:F,getParentReferencesFromPath:z}}({basePath:b??"/",baseCollectionPath:Z??"/c",authController:f,collections:d,views:c,collectionOverrideHandler:g,userConfigPersistence:A,dataSource:y,plugins:v}),k=function(){let e=(0,eC.TH)(),t=(0,eC.s0)(),[r,i]=(0,s.useState)([]),n=(0,s.useRef)(r),o=(0,s.useRef)({}),l=(0,s.useRef)(0),a=e=>{n.current=e,i(e)};(0,s.useEffect)(()=>{let t=(e.state?.panels??[]).map(e=>o.current[e]).filter(e=>!!e);eY()(n.current.map(e=>e.key),t.map(e=>e.key))||a(t)},[e]);let d=(0,s.useCallback)(()=>{if(0===r.length)return;let i=r[r.length-1],n=[...r.slice(0,-1)];if(a(n),l.current>0)i.urlPath&&t(-1),l.current--;else if(i.parentUrlPath){let r=e.state?.base_location??e;t(i.parentUrlPath,{replace:!0,state:{base_location:r,panels:n.map(e=>e.key)}})}},[r,t,e]),c=(0,s.useCallback)(i=>{let n=Array.isArray(i)?i:[i];n.forEach(e=>{o.current[e.key]=e}),l.current=l.current+n.length;let s=e.state?.base_location??e,d=[...r,...n];a(d),n.forEach(e=>{e.urlPath&&t(e.urlPath,{state:{base_location:s,panels:d.map(e=>e.key)}})})},[e,t,r]),u=(0,s.useCallback)(i=>{let n=Array.isArray(i)?i:[i];n.forEach(e=>{o.current[e.key]=e});let l=e.state?.base_location??e,s=[...r.slice(0,-n.length),...n];a(s),n.forEach(e=>{e.urlPath&&t(e.urlPath,{replace:!0,state:{base_location:l,panels:s.map(e=>e.key)}})})},[e,t,r]);return{sidePanels:r,close:d,open:c,replace:u}}(),E=lU(B,k),S=f.initialLoading||B.loading||(v?.some(e=>e.loading)??!1);return B.navigationLoadingError?(0,i.tZ)(lD,{maxWidth:300,fullScreen:!0,children:(0,i.tZ)(rz,{title:"Error loading navigation",error:B.navigationLoadingError})}):f.authError?(0,i.tZ)(lD,{maxWidth:300,fullScreen:!0,children:(0,i.tZ)(rz,{title:"Error loading auth",error:f.authError})}):(0,i.tZ)(rr.Provider,{value:t,children:(0,i.tZ)(rB.Provider,{value:{entityLinkBuilder:u,dateTimeFormat:p,locale:h,plugins:v,onAnalyticsEvent:x,fields:w??{}},children:(0,i.tZ)(rw.Provider,{value:A,children:(0,i.tZ)(rZ.Provider,{value:m,children:(0,i.tZ)(rc.Provider,{value:y,children:(0,i.tZ)(rh.Provider,{value:f,children:(0,i.tZ)(rg.Provider,{value:k,children:(0,i.tZ)(ry.Provider,{value:E,children:(0,i.tZ)(rA.Provider,{value:B,children:(0,i.tZ)(rt,{children:(0,i.tZ)(o._,{dateAdapter:n.H,utils:l.Z,locale:C,children:(0,i.tZ)(l_,{loading:S,children:r})})})})})})})})})})})})}function l_({loading:e,children:t}){let r=rk(),n=t({context:r,loading:e}),o=r.plugins;return!e&&o&&o.forEach(e=>{e.provider&&(n=(0,i.tZ)(e.provider.Component,{...e.provider.props,context:r,children:n}))}),(0,i.tZ)(i.HY,{children:n})}let lJ=({mode:e,primaryColor:t,secondaryColor:r,fontFamily:i,headersFontFamily:n})=>{(0,ev.Z)();let o=(0,ev.Z)({palette:{mode:e,background:{default:"dark"===e?"#202024":"#f8f8fa",paper:"dark"===e?"#121215":"#ffffff"},primary:{main:t||"#0070f4"},secondary:{main:r||tG.Z[400]},error:{main:tO.Z.A400}},shape:{borderRadius:6},typography:{fontFamily:i||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeightMedium:500,h6:{fontFamily:i||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontSize:"1.15rem",fontWeight:500},h5:{fontFamily:i||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontSize:"1.55rem"},h4:{fontFamily:i||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontSize:"2rem",fontWeight:500},h3:{fontFamily:i||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeight:600},h2:{fontFamily:n||"'IBM Plex Mono', 'Space Mono', 'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeight:600},h1:{fontFamily:n||"'IBM Plex Mono', 'Space Mono', 'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeight:600},label:{display:"block",color:"#838383",fontWeight:500,fontSize:"0.875rem",lineHeight:1.43}},components:{MuiSkeleton:{styleOverrides:{root:{borderRadius:6}}},MuiButton:{styleOverrides:{root:{borderRadius:6}}},MuiLoadingButton:{styleOverrides:{root:{borderRadius:6}}},MuiTableRow:{styleOverrides:{root:{"&:last-child td":{borderBottom:0}}}},MuiTypography:{styleOverrides:{root:{"&.mono":{fontFamily:"'IBM Plex Mono', 'Space Mono', monospace, 'Lucida Console'"},"&.weight-500":{fontWeight:500}}}},MuiInputBase:{styleOverrides:{root:{"&.mono":{fontFamily:"'IBM Plex Mono', 'Space Mono', 'Lucida Console', monospace"},"& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button":{display:"none"},"& input[type=number]":{MozAppearance:"textfield"}}}},MuiDialog:{styleOverrides:{paper:{backgroundImage:"inherit"}}},MuiCardActionArea:{styleOverrides:{root:{borderRadius:6}}}}});return{...o,shadows:o.shadows.map((e,t)=>3===t?"0px 0px 0px 0px rgba(0,0,0,0.18), 0px 0px 10px 0px rgba(0,0,0,0.12), 0px 0px 14px 2px rgba(0,0,0,0.10)":e)}},lK=s.memo(function({HomePage:e=lF,customRoutes:t}){let r=(0,eC.TH)(),n=rp(),o=rk().plugins??[];if(!n)return(0,i.tZ)(i.HY,{});let l=r.state,a=l&&l.base_location?l.base_location:r,s=[];n.views&&n.views.forEach(e=>{Array.isArray(e.path)?s.push(...e.path.map(t=>lq(t,e))):s.push(lq(e.path,e))});let d=[...n.collections??[]].sort((e,t)=>t.path.length-e.path.length).map(e=>{let t=n.buildUrlCollectionPath(e.alias??e.path),r=[];return o&&o.forEach(e=>{e.collections?.CollectionActions&&r.push(...lw(e.collections?.CollectionActions))}),r.push(...lw(e.Actions)),(0,i.tZ)(eC.AW,{path:t+"/*",element:(0,i.tZ)(l0,{path:t,title:e.name,type:"collection",children:(0,i.tZ)(ly,{isSubCollection:!1,fullPath:e.alias??e.path,...e,Actions:r},`collection_view_${e.alias??e.path}`)})},`navigation_${e.alias??e.path}`)}),c=(0,i.tZ)(eC.AW,{path:"/",element:(0,i.tZ)(l0,{path:n.homeUrl,title:"Home",type:"home",children:(0,i.tZ)(e,{})},"navigation_home")});return(0,i.BX)(eC.Z5,{location:a,children:[d,s,c,(0,i.tZ)(eC.AW,{path:"*",element:(0,i.tZ)(lR,{})}),t]})}),lq=(e,t)=>(0,i.tZ)(eC.AW,{path:e,element:(0,i.tZ)(l0,{path:e,title:t.name,type:"view",children:t.view},`navigation_${e}`)},"navigation_view_"+e),l0=s.memo(function({children:e,title:t,path:r,type:n}){let o=rP();return s.useEffect(()=>{o.set({breadcrumbs:[{title:t,url:r}]})},[r,t]),(0,i.tZ)(i.HY,{children:e})},eY());function l1(e){return e}function l2(e){return e}let l4=({children:e})=>(0,i.tZ)(ek.wT,{maxSnack:3,autoHideDuration:3500,children:e}),l5=({firebaseApp:e,signInOptions:t})=>{let[r,i]=(0,s.useState)(void 0),[n,o]=(0,s.useState)(),[l,a]=(0,s.useState)(),[d,c]=(0,s.useState)(!0),[u,A]=(0,s.useState)(!0),[p,h]=(0,s.useState)(!1),[f,g]=(0,s.useState)(),[m,y]=(0,s.useState)();(0,s.useEffect)(()=>{if(e)try{let t=(0,t4.v0)(e);return o(void 0),i(t.currentUser),(0,t4.Aj)(t,Z,e=>a(e))}catch(e){return o(e),()=>{}}},[e]);let b=(0,s.useCallback)(()=>{h(!0),i(null)},[]),Z=(0,s.useCallback)(async e=>{i(e),c(!1),A(!1)},[]),v=(0,s.useCallback)(()=>{let t=(0,t4.v0)(e);(0,t4.w7)(t).then(e=>{i(null),a(null)}),h(!1)},[e]),x=(0,s.useCallback)(e=>t.find(t=>{if(null===t)throw Error("useFirebaseAuthController");if("object"==typeof t&&t.provider===e)return t}),[t]),w=(0,s.useCallback)(()=>{let e=new t4.hJ,t=x("google.com");t?.scopes&&t.scopes.forEach(t=>e.addScope(t)),t?.customParameters&&e.setCustomParameters(t.customParameters);let r=(0,t4.v0)();(0,t4.rh)(r,e).catch(a)},[x]),C=(0,s.useCallback)((e,t)=>{A(!0),(0,t4.rh)(e,t).catch(a).then(()=>A(!1))},[]),B=(0,s.useCallback)(()=>{let e=(0,t4.v0)();A(!0),(0,t4.XB)(e).catch(a).then(()=>A(!1))},[]),k=(0,s.useCallback)((e,t)=>{let r=(0,t4.v0)();return A(!0),(0,t4.$g)(r,e,t).catch(a).then(e=>{A(!1),g(e??void 0)})},[]),E=(0,s.useCallback)(()=>{let e=new t4.O4("apple.com"),t=x("apple.com");t?.scopes&&t.scopes.forEach(t=>e.addScope(t)),t?.customParameters&&e.setCustomParameters(t.customParameters);let r=(0,t4.v0)();C(r,e)},[C,x]),S=(0,s.useCallback)(()=>{let e=new t4._O,t=x("facebook.com");t?.scopes&&t.scopes.forEach(t=>e.addScope(t)),t?.customParameters&&e.setCustomParameters(t.customParameters);let r=(0,t4.v0)();C(r,e)},[C,x]),I=(0,s.useCallback)(()=>{let e=new t4.GH,t=x("github.com");t?.scopes&&t.scopes.forEach(t=>e.addScope(t)),t?.customParameters&&e.setCustomParameters(t.customParameters);let r=(0,t4.v0)();C(r,e)},[C,x]),F=(0,s.useCallback)(()=>{let e=new t4.O4("microsoft.com"),t=x("microsoft.com");t?.scopes&&t.scopes.forEach(t=>e.addScope(t)),t?.customParameters&&e.setCustomParameters(t.customParameters);let r=(0,t4.v0)();C(r,e)},[C,x]),R=(0,s.useCallback)(()=>{let e=new t4.c4,t=x("twitter.com");t?.customParameters&&e.setCustomParameters(t.customParameters);let r=(0,t4.v0)();C(r,e)},[C,x]),Q=(0,s.useCallback)((e,t)=>{let r=(0,t4.v0)();A(!0),(0,t4.e5)(r,e,t).catch(a).then(()=>A(!1))},[]),D=(0,s.useCallback)((e,t)=>{let r=(0,t4.v0)();A(!0),(0,t4.Xb)(r,e,t).catch(a).then(()=>A(!1))},[]),P=(0,s.useCallback)(e=>{let t=(0,t4.v0)();return A(!0),(0,t4.Nr)(t,e).then(e=>(A(!1),e))},[]),M=(0,s.useCallback)(async()=>{if(!r)throw Error("User is not logged in");return r.getIdToken()},[r]);return{user:r??null,authError:n,authProviderError:l,authLoading:u,initialLoading:d,getAuthToken:M,confirmationResult:f,signOut:v,loginSkipped:p,skipLogin:b,googleLogin:w,anonymousLogin:B,appleLogin:E,facebookLogin:S,githubLogin:I,microsoftLogin:F,twitterLogin:R,emailPasswordLogin:Q,phoneLogin:k,fetchSignInMethodsForEmail:P,createUserWithEmailAndPassword:D,extra:m,setExtra:y}};function l3(e){if(!e)return e;let t=e.toDate();return t.setHours(0,0,0,0),t5.EK.fromDate(t)}function l8(e){if(null==e)return null;if(!(0,t5.AK)().isEqual(e)){if((0,t5.Bt)().isEqual(e))return null;if(e instanceof t5.EK||"function"==typeof e.toDate&&e.toDate() instanceof Date)return e.toDate();if(e instanceof Date)return e;if(e instanceof t5.F8)return new rG(e.latitude,e.longitude);if(e instanceof t5.my)return new rY(e.id,l9(e.path));if(Array.isArray(e))return e.map(l8).filter(e=>void 0!==e);if("object"==typeof e){let t={};for(let r of Object.keys(e)){let i=l8(e[r]);void 0!==i&&(t[r]=i)}return t}return e}}function l6(e,t){return void 0===e?(0,t5.AK)():Array.isArray(e)?e.map(e=>l6(e,t)):e instanceof rY?(0,t5.JU)(t,e.path,e.id):e instanceof rG?new t5.F8(e.latitude,e.longitude):e instanceof Date?t5.EK.fromDate(e):e&&"object"==typeof e?Object.entries(e).map(([e,r])=>({[e]:l6(r,t)})).reduce((e,t)=>({...e,...t}),{}):e}function l9(e){let t=e.lastIndexOf("/");return t=-1===t?e.length:t,e.substring(0,t)}let l7=`It seems like the provided Firebase config is not correct. If you 
are using the credentials provided automatically by Firebase 
Hosting, make sure you link your Firebase app to Firebase Hosting. 
`,ae=e=>(0,i.tZ)(i.HY,{children:(0,i.BX)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:32,height:32,children:[(0,i.BX)("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJb",x1:"29.401",x2:"29.401",y1:"4.064",y2:"106.734",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[(0,i.tZ)("stop",{offset:"0",stopColor:"#ff5840"}),(0,i.tZ)("stop",{offset:".007",stopColor:"#ff5840"}),(0,i.tZ)("stop",{offset:".989",stopColor:"#fa528c"}),(0,i.tZ)("stop",{offset:"1",stopColor:"#fa528c"})]}),(0,i.tZ)("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJb)",d:"M47.46,15.5l-1.37,1.48c-1.34,1.44-3.5,1.67-5.15,0.6c-2.71-1.75-6.43-3.13-11-2.37 c-4.94,0.83-9.17,3.85-11.64, 7.97l-8.03-6.08C14.99,9.82,23.2,5,32.5,5c5,0,9.94,1.56,14.27,4.46 C48.81,10.83,49.13,13.71,47.46,15.5z"}),(0,i.BX)("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJc",x1:"12.148",x2:"12.148",y1:".872",y2:"47.812",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[(0,i.tZ)("stop",{offset:"0",stopColor:"#feaa53"}),(0,i.tZ)("stop",{offset:".612",stopColor:"#ffcd49"}),(0,i.tZ)("stop",{offset:"1",stopColor:"#ffde44"})]}),(0,i.tZ)("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJc)",d:"M16.01,30.91c-0.09,2.47,0.37,4.83,1.27,6.96l-8.21,6.05c-1.35-2.51-2.3-5.28-2.75-8.22 c-1.06-6.88,0.54-13.38, 3.95-18.6l8.03,6.08C16.93,25.47,16.1,28.11,16.01,30.91z"}),(0,i.BX)("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJd",x1:"29.76",x2:"29.76",y1:"32.149",y2:"-6.939",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[(0,i.tZ)("stop",{offset:"0",stopColor:"#42d778"}),(0,i.tZ)("stop",{offset:".428",stopColor:"#3dca76"}),(0,i.tZ)("stop",{offset:"1",stopColor:"#34b171"})]}),(0,i.tZ)("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJd)",d:"M50.45,51.28c-4.55,4.07-10.61,6.57-17.36,6.71C22.91,58.2,13.66,52.53,9.07,43.92l8.21-6.05 C19.78,43.81, 25.67,48,32.5,48c3.94,0,7.52-1.28,10.33-3.44L50.45,51.28z"}),(0,i.BX)("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJe",x1:"46",x2:"46",y1:"3.638",y2:"35.593",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[(0,i.tZ)("stop",{offset:"0",stopColor:"#155cde"}),(0,i.tZ)("stop",{offset:".278",stopColor:"#1f7fe5"}),(0,i.tZ)("stop",{offset:".569",stopColor:"#279ceb"}),(0,i.tZ)("stop",{offset:".82",stopColor:"#2cafef"}),(0,i.tZ)("stop",{offset:"1",stopColor:"#2eb5f0"})]}),(0,i.tZ)("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJe)",d:`M59,31.97c0.01,7.73-3.26,14.58-8.55,19.31l-7.62-6.72c2.1-1.61,3.77-3.71,4.84-6.15
        c0.29-0.66-0.2-1.41-0.92-1.41H37c-2.21,0-4-1.79-4-4v-2c0-2.21,1.79-4,4-4h17C56.75,27,59,29.22,59,31.97z`})]})}),at=e=>(0,i.tZ)("svg",{width:32,height:32,viewBox:"0 0 56 56",style:{transform:"scale(2.8)"},version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:(0,i.tZ)("g",{stroke:"light"===e?"#424245":"white",strokeWidth:"0.5",fillRule:"evenodd",children:(0,i.tZ)("path",{d:"M28.2226562,20.3846154 C29.0546875,20.3846154 30.0976562,19.8048315 30.71875,19.0317864 C31.28125,18.3312142 31.6914062,17.352829 31.6914062,16.3744437 C31.6914062,16.2415766 31.6796875,16.1087095 31.65625,16 C30.7304687,16.0362365 29.6171875,16.640178 28.9492187,17.4494596 C28.421875,18.06548 27.9414062,19.0317864 27.9414062,20.0222505 C27.9414062,20.1671964 27.9648438,20.3121424 27.9765625,20.3604577 C28.0351562,20.3725366 28.1289062,20.3846154 28.2226562,20.3846154 Z M25.2929688,35 C26.4296875,35 26.9335938,34.214876 28.3515625,34.214876 C29.7929688,34.214876 30.109375,34.9758423 31.375,34.9758423 C32.6171875,34.9758423 33.4492188,33.792117 34.234375,32.6325493 C35.1132812,31.3038779 35.4765625,29.9993643 35.5,29.9389701 C35.4179688,29.9148125 33.0390625,28.9122695 33.0390625,26.0979021 C33.0390625,23.6579784 34.9140625,22.5588048 35.0195312,22.474253 C33.7773438,20.6382708 31.890625,20.5899555 31.375,20.5899555 C29.9804688,20.5899555 28.84375,21.4596313 28.1289062,21.4596313 C27.3554688,21.4596313 26.3359375,20.6382708 25.1289062,20.6382708 C22.8320312,20.6382708 20.5,22.5950413 20.5,26.2911634 C20.5,28.5861411 21.3671875,31.013986 22.4335938,32.5842339 C23.3476562,33.9129053 24.1445312,35 25.2929688,35 Z",fill:"light"===e?"#424245":"white",fillRule:"nonzero"})})}),ar=e=>(0,i.tZ)("svg",{fill:"light"===e?"#1c1e21":"white",role:"img",viewBox:"0 0 24 24",width:28,height:28,xmlns:"http://www.w3.org/2000/svg",children:(0,i.tZ)("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"})}),ai=e=>(0,i.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 90 90",children:(0,i.tZ)("g",{children:(0,i.tZ)("path",{d:"M90,15.001C90,7.119,82.884,0,75,0H15C7.116,0,0,7.119,0,15.001v59.998   C0,82.881,7.116,90,15.001,90H45V56H34V41h11v-5.844C45,25.077,52.568,16,61.875,16H74v15H61.875C60.548,31,59,32.611,59,35.024V41   h15v15H59v34h16c7.884,0,15-7.119,15-15.001V15.001z",fill:"light"===e?"#39569c":"white"})})}),an=e=>(0,i.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 480 480",children:(0,i.tZ)("g",{children:(0,i.tZ)("path",{d:"M0.176,224L0.001,67.963l192-26.072V224H0.176z M224.001,37.241L479.937,0v224H224.001V37.241z M479.999,256l-0.062,224   l-255.936-36.008V256H479.999z M192.001,439.918L0.157,413.621L0.147,256h191.854V439.918z",fill:"light"===e?"#00a2ed":"white"})})}),ao=e=>(0,i.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 24 24",children:(0,i.tZ)("path",{fill:"light"===e?"#00acee":"white",d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"})}),al="recaptcha-container";function aa({allowSkipLogin:e,logo:t,signInOptions:r,firebaseApp:n,authController:o,noUserComponent:l,disableSignupScreen:a=!1,disabled:d=!1,additionalComponent:u,notAllowedError:A}){let p,h,f;let g=rQ(),[m,y]=(0,s.useState)(!1),[b,Z]=(0,s.useState)(!1),v=r.map(e=>"object"==typeof e?e.provider:e),x=(0,s.useCallback)(()=>{let e=(0,t4.v0)(),t=new t4.lI("recaptcha",{size:"invisible"},e),r=(0,t4.p2)(e,o.authProviderError);if(r.hints[0].factorId===t4.ww.FACTOR_ID){let i={multiFactorHint:r.hints[0],session:r.session};new t4.RO(e).verifyPhoneNumber(i,t).then(function(e){let t=String(window.prompt("Please enter the verification code that was sent to your mobile device.")),i=t4.RO.credential(e,t),n=t4.ww.assertion(i);return r.resolveSignIn(n)})}else console.warn("Unsupported second factor.")},[o.authProviderError]);return p=t?(0,i.tZ)("img",{src:t,style:{height:"100%",width:"100%",objectFit:"cover"},alt:"Logo"}):(0,i.tZ)(lQ,{}),A&&(h="string"==typeof A?A:A instanceof Error?A.message:"It looks like you don't have access to the CMS, based on the specified Authenticator configuration"),(0,i.tZ)(eA.Z,{in:!0,timeout:800,mountOnEnter:!0,unmountOnExit:!0,children:(0,i.BX)(c.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh","@supports (minHeight: 100dvh)":{minHeight:"100dvh"},minWidth:"100vw",p:2},children:[(0,i.tZ)("div",{id:"recaptcha"}),(0,i.BX)(c.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",maxWidth:480},children:[(0,i.tZ)(c.Z,{m:1,sx:{padding:1,width:260,height:260},children:p}),h&&(0,i.tZ)(c.Z,{p:2,children:(0,i.tZ)(rz,{error:h})}),(null!=o.user||o.authProviderError&&("auth/operation-not-allowed"===o.authProviderError.code||"auth/configuration-not-found"===o.authProviderError.code?f=(0,i.BX)("div",{children:[(0,i.tZ)(c.Z,{p:1,children:(0,i.tZ)(rz,{error:"You need to enable Firebase auth and the corresponding login provider in your Firebase project"})}),n&&(0,i.tZ)(c.Z,{p:1,children:(0,i.tZ)("a",{href:`https://console.firebase.google.com/project/${n.options.projectId}/authentication/providers`,rel:"noopener noreferrer",target:"_blank",children:(0,i.tZ)(C.Z,{variant:"text",color:"primary",children:"Open Firebase configuration"})})})]}):"auth/invalid-api-key"===o.authProviderError.code?f=(0,i.tZ)("div",{children:(0,i.tZ)(c.Z,{p:1,children:(0,i.tZ)(rz,{title:"Invalid API key",error:"auth/invalid-api-key: Check that your Firebase config is set correctly in your `firebase-config.ts` file"})})}):["auth/popup-closed-by-user","auth/cancelled-popup-request"].includes(o.authProviderError.code)||("auth/multi-factor-auth-required"===o.authProviderError.code&&x(),f=(0,i.tZ)(c.Z,{p:1,children:(0,i.tZ)(rz,{error:o.authProviderError})}))),f),!m&&!b&&(0,i.BX)(i.HY,{children:[au(o,v,g.mode,d),v.includes("password")&&(0,i.tZ)(as,{disabled:d,text:"Email/password",icon:(0,i.tZ)(e9.Z,{fontSize:"large"}),onClick:()=>y(!0)}),v.includes("phone")&&(0,i.tZ)(as,{disabled:d,text:"Phone number",icon:(0,i.tZ)(eV.Z,{fontSize:"large"}),onClick:()=>Z(!0)}),v.includes("anonymous")&&(0,i.tZ)(as,{disabled:d,text:"Log in anonymously",icon:(0,i.tZ)(t7.Z,{fontSize:"large"}),onClick:o.anonymousLogin}),e&&(0,i.tZ)(c.Z,{m:1,children:(0,i.tZ)(C.Z,{disabled:d,onClick:o.skipLogin,children:"Skip login"})})]}),m&&(0,i.tZ)(ac,{authController:o,onClose:()=>y(!1),mode:g.mode,noUserComponent:l,disableSignupScreen:a}),b&&(0,i.tZ)(ad,{authController:o,onClose:()=>Z(!1)}),!m&&!b&&u]})]})})}function as({icon:e,onClick:t,text:r,disabled:n}){return(0,i.tZ)(c.Z,{m:.5,width:"100%",children:(0,i.tZ)(C.Z,{fullWidth:!0,variant:"outlined",disabled:n,onClick:t,children:(0,i.BX)(c.Z,{sx:{p:"1",display:"flex",width:"240px",height:"32px",alignItems:"center",justifyItems:"center"},children:[(0,i.tZ)(c.Z,{sx:{display:"flex",flexDirection:"column",width:"32px",alignItems:"center",justifyItems:"center"},children:e}),(0,i.tZ)(c.Z,{sx:{flexGrow:1,pl:2,textAlign:"center"},children:r})]})})})}function ad({onClose:e,authController:t}){(0,s.useEffect)(()=>{if(!window||window?.recaptchaVerifier)return;let e=(0,t4.v0)();window.recaptchaVerifier=new t4.lI(al,{size:"invisible"},e)},[]);let[r,n]=(0,s.useState)(),[o,l]=(0,s.useState)(),[a,d]=(0,s.useState)(!1);return(0,i.BX)("form",{onSubmit:async e=>{e.preventDefault(),o&&t.confirmationResult?(d(!1),t.confirmationResult.confirm(o).catch(e=>{"auth/invalid-verification-code"===e.code&&d(!0)})):r&&t.phoneLogin(r,window.recaptchaVerifier)},children:[a&&(0,i.tZ)(c.Z,{p:2,children:(0,i.tZ)(rz,{error:"Invalid confirmation code"})}),(0,i.tZ)("div",{id:al}),(0,i.BX)(Z.ZP,{container:!0,spacing:1,children:[(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.tZ)(p.Z,{onClick:e,children:(0,i.tZ)(t9.Z,{sx:{width:20,height:20}})})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,sx:{p:1,display:"flex"},children:(0,i.tZ)(u.Z,{align:"center",variant:"subtitle2",children:"Please enter your phone number"})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.tZ)(z.Z,{placeholder:"",fullWidth:!0,value:r,disabled:!!(r&&(t.authLoading||t.confirmationResult)),type:"phone",required:!0,onChange:e=>n(e.target.value)})}),!!(r&&t.confirmationResult)&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(Z.ZP,{item:!0,xs:12,sx:{mt:2,p:1,display:"flex"},children:(0,i.tZ)(u.Z,{align:"center",variant:"subtitle2",children:"Please enter the confirmation code"})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.tZ)(z.Z,{placeholder:"",fullWidth:!0,value:o,type:"text",required:!0,onChange:e=>l(e.target.value)})})]}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.BX)(c.Z,{sx:{display:"flex",justifyContent:"end",alignItems:"center",width:"100%"},children:[t.authLoading&&(0,i.tZ)(N.Z,{sx:{p:1},size:16,thickness:8}),(0,i.tZ)(C.Z,{type:"submit",children:"Ok"})]})})]})]})}function ac({onClose:e,authController:t,mode:r,noUserComponent:n,disableSignupScreen:o}){let l=(0,s.useRef)(null),[a,d]=(0,s.useState)(),[A,h]=(0,s.useState)(),[f,g]=(0,s.useState)(),m=void 0===A,y=A&&A.includes("password"),b=A&&!A.includes("password")&&A.length>0,v=A&&!A.includes("password");(0,s.useEffect)(()=>{(y||v)&&l.current&&l.current.focus()},[y,v]),(0,s.useEffect)(()=>{if(!document)return;let t=t=>{27===t.keyCode&&e()};return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}},[e]);let x=()=>{m?e():h(void 0)},w=v?"No user found with that email. Pick a password to create a new account":y?"Please enter your password":"Please enter your email",B=v?"Create account":y?"Login":"Ok";return b?(0,i.BX)(Z.ZP,{container:!0,spacing:1,children:[(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.tZ)(p.Z,{onClick:x,children:(0,i.tZ)(t9.Z,{sx:{width:20,height:20}})})}),(0,i.BX)(Z.ZP,{item:!0,xs:12,sx:{p:1},children:[(0,i.tZ)(u.Z,{align:"center",variant:"subtitle2",children:"You already have an account"}),(0,i.BX)(u.Z,{align:"center",variant:"body2",children:["You can use one of these methods to login with ",a]})]}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:A&&au(t,A,r,!1)})]}):(0,i.tZ)(ei.Z,{direction:"up",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:(0,i.tZ)("form",{onSubmit:e=>{e.preventDefault(),m?a&&t.fetchSignInMethodsForEmail(a).then(e=>{h(e)}):y?a&&f&&t.emailPasswordLogin(a,f):v&&a&&f&&t.createUserWithEmailAndPassword(a,f)},children:(0,i.BX)(Z.ZP,{container:!0,spacing:1,children:[(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.tZ)(p.Z,{onClick:x,children:(0,i.tZ)(t9.Z,{sx:{width:20,height:20}})})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,sx:{p:1,display:v&&o?"none":"flex"},children:(0,i.tZ)(u.Z,{align:"center",variant:"subtitle2",children:w})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,sx:{display:m?"inherit":"none"},children:(0,i.tZ)(z.Z,{placeholder:"Email",fullWidth:!0,autoFocus:!0,value:a??"",disabled:t.authLoading,type:"email",onChange:e=>d(e.target.value)})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:v&&n}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,sx:{display:y||v&&!o?"inherit":"none"},children:(0,i.tZ)(z.Z,{placeholder:"Password",fullWidth:!0,value:f??"",disabled:t.authLoading,inputRef:l,type:"password",onChange:e=>g(e.target.value)})}),(0,i.tZ)(Z.ZP,{item:!0,xs:12,children:(0,i.BX)(c.Z,{sx:{display:v&&o?"none":"flex",justifyContent:"end",alignItems:"center",width:"100%"},children:[t.authLoading&&(0,i.tZ)(N.Z,{sx:{p:1},size:16,thickness:8}),(0,i.tZ)(C.Z,{type:"submit",children:B})]})})]})})})}function au(e,t,r,n){return(0,i.BX)(i.HY,{children:[t.includes("google.com")&&(0,i.tZ)(as,{disabled:n,text:"Sign in with Google",icon:ae(),onClick:e.googleLogin}),t.includes("microsoft.com")&&(0,i.tZ)(as,{disabled:n,text:"Sign in with Microsoft",icon:an(r),onClick:e.microsoftLogin}),t.includes("apple.com")&&(0,i.tZ)(as,{disabled:n,text:"Sign in with Apple",icon:at(r),onClick:e.appleLogin}),t.includes("github.com")&&(0,i.tZ)(as,{disabled:n,text:"Sign in with Github",icon:ar(r),onClick:e.githubLogin}),t.includes("facebook.com")&&(0,i.tZ)(as,{disabled:n,text:"Sign in with Facebook",icon:ai(r),onClick:e.facebookLogin}),t.includes("twitter.com")&&(0,i.tZ)(as,{disabled:n,text:"Sign in with Twitter",icon:ao(r),onClick:e.twitterLogin})]})}let aA=[t4.hJ.PROVIDER_ID];function ap({name:e,logo:t,logoDark:r,toolbarExtraWidget:n,authentication:o,collectionOverrideHandler:l,collections:a,views:d,textSearchController:c,allowSkipLogin:u,signInOptions:A=aA,firebaseConfig:p,onFirebaseInit:h,appCheckOptions:f,primaryColor:g,secondaryColor:m,fontFamily:y,dateTimeFormat:b,locale:Z,HomePage:v,basePath:x,baseCollectionPath:w,LoginView:C,onAnalyticsEvent:B,fields:k={},plugins:E,autoOpenDrawer:S}){(0,s.useEffect)(()=>{if(document){document.title=`${e} - FireCMS`;let r=document.querySelector("link[rel~='icon']");r||((r=document.createElement("link")).rel="icon",document.getElementsByTagName("head")[0].appendChild(r)),r.href=t??rT}},[e,t]);let{firebaseApp:I,firebaseConfigLoading:F,configError:R}=function({firebaseConfig:e,onFirebaseInit:t,name:r,authDomain:i}){let[n,o]=s.useState(),[l,a]=s.useState(!1),[d,c]=s.useState(),u=(0,s.useCallback)(e=>{try{let t=(0,t8.ZF)(e,r??"[DEFAULT]");c(void 0),a(!1),o(t)}catch(e){console.error("Error initialising Firebase",e),c(l7+`
`+(e.message??JSON.stringify(e)))}},[r]);return(0,s.useEffect)(()=>{t&&e&&n&&t(e,n)},[n]),(0,s.useEffect)(()=>{a(!0),e?u(e):fetch("/__/firebase/init.json").then(async e=>{if(console.debug("Firebase init response",e.status),e&&e.status<300){let t=await e.json();i&&(t.authDomain=i),u(t)}}).catch(e=>{a(!1),c("Could not load Firebase configuration from Firebase hosting. If the app is not deployed in Firebase hosting, you need to specify the configuration manually"+e.toString())})},[e,u]),{firebaseApp:n,firebaseConfigLoading:l,configError:d}}({onFirebaseInit:h,firebaseConfig:p}),{appCheckLoading:Q,getAppCheckToken:D}=function({firebaseApp:e,options:t}){t?.debugToken&&Object.assign(window,{FIREBASE_APPCHECK_DEBUG_TOKEN:t?.debugToken});let[r,i]=s.useState(!1),[n,o]=s.useState(),l=(0,s.useCallback)(e=>{if(!(!n||!t))return(0,t6.LP)(n,e)},[n,t]);return(0,s.useEffect)(()=>{if(!t||!e)return;i(!0);let{providerKey:r,useEnterpriseRecaptcha:n,isTokenAutoRefreshEnabled:l}=t,a=(0,t6.yu)(e,{provider:n?new t6.o4(r):new t6.z9(r),isTokenAutoRefreshEnabled:l});o(a),i(!1)},[e,t]),{appCheckLoading:r,getAppCheckToken:t?l:void 0}}({firebaseApp:I,options:f}),P=l5({firebaseApp:I,signInOptions:A}),M=function(){let[e,t]=(0,s.useState)({}),r=(0,s.useCallback)(e=>{let t=localStorage.getItem(e);return t?JSON.parse(t):{}},[]),i=(0,s.useCallback)(t=>{let i=`collection_config::${i$(iL(t))}`;return e[i]?e[i]:r(i)},[e,r]),n=(0,s.useCallback)((e,i)=>{let n=`collection_config::${i$(iL(e))}`;localStorage.setItem(n,JSON.stringify(i)),t(t=>{let o=t[n],l=iP(o??r(e),i);return iP(t,l)})},[r]),[o,l]=(0,s.useState)([]),[a,d]=(0,s.useState)([]),[c,u]=(0,s.useState)([]);(0,s.useEffect)(()=>{l(localStorage.getItem("recently_visited_paths")?JSON.parse(localStorage.getItem("recently_visited_paths")):[]),d(localStorage.getItem("favourite_paths")?JSON.parse(localStorage.getItem("favourite_paths")):[]),u(localStorage.getItem("collapsed_groups")?JSON.parse(localStorage.getItem("collapsed_groups")):[])},[]);let A=(0,s.useCallback)(e=>{localStorage.setItem("recently_visited_paths",JSON.stringify(e)),l(e)},[]),p=(0,s.useCallback)(e=>{localStorage.setItem("favourite_paths",JSON.stringify(e)),d(e)},[]),h=(0,s.useCallback)(e=>{localStorage.setItem("collapsed_groups",JSON.stringify(e)),u(e)},[]);return{onCollectionModified:n,getCollectionConfig:i,recentlyVisitedPaths:o,setRecentlyVisitedPaths:A,favouritePaths:a,setFavouritePaths:p,collapsedGroups:c,setCollapsedGroups:h}}(),T=function({firebaseApp:e,textSearchController:t,fields:r={}}){let i=(0,s.useCallback)((e,t,r)=>{let i=l8(e.data()),n=e.data()?r.properties?(Object.entries(r.properties).forEach(([e,t])=>{i&&void 0!==i[e]?i[e]=i[e]:t.validation?.required&&(i[e]=null)}),i):e.data():void 0;return{id:e.id,path:l9(e.ref.path),values:n}},[]),n=(0,s.useCallback)((t,r,i,n,o,l,a=!1)=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let s=(0,t5.ad)(e),d=a?(0,t5.B$)(s,t):(0,t5.hJ)(s,t),c=[];return r&&Object.entries(r).filter(([e,t])=>!!t).forEach(([e,t])=>{let[r,i]=t;c.push((0,t5.ar)(e,r,l6(i,s)))}),i&&n&&c.push((0,t5.Xo)(i,n)),o&&c.push((0,t5.TQ)(o)),l&&c.push((0,t5.b9)(l)),(0,t5.IO)(d,...c)},[e]),o=(0,s.useCallback)((t,n,o)=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let l=(0,t5.ad)(e);return(0,t5.QT)((0,t5.JU)(l,t,n)).then(e=>{if(!e.exists())return;let n=nU({collection:o,path:t,entityId:e.id,values:l8(e.data()),fields:r});return i(e,t,n)})},[e]),l=(0,s.useCallback)(async(e,r,i)=>{if(!t)throw Error("Trying to make text search without specifying a FirestoreTextSearchController");let n=await t({path:e,searchString:r});if(void 0===n)throw Error("The current path is not supported by the specified FirestoreTextSearchController");let l=n.map(async t=>{try{return await o(e,t,i)}catch(e){console.error(e);return}});return Promise.all(l).then(e=>e.filter(e=>void 0!==e&&e.values))},[o]);return{fetchCollection:(0,s.useCallback)(({path:e,collection:t,filter:o,limit:a,startAfter:s,searchString:d,orderBy:c,order:u})=>{if(d)return l(e,d,t);let A=t.collectionGroup??!1;console.debug("Fetching collection",{path:e,limit:a,filter:o,startAfter:s,orderBy:c,order:u,collectionGroup:A});let p=n(e,o,c,u,s,a,A);return(0,t5.PL)(p).then(n=>n.docs.map(n=>{let o=nU({collection:t,path:e,values:l8(n.data()),fields:r});return i(n,e,o)}))},[n,l]),listenCollection:(0,s.useCallback)(({path:e,collection:t,filter:o,limit:a,startAfter:s,searchString:d,orderBy:c,order:u,onUpdate:A,onError:p})=>{let h=t.collectionGroup??!1;console.debug("Listening collection",{path:e,collectionGroup:h,limit:a,filter:o,startAfter:s,orderBy:c,order:u});let f=n(e,o,c,u,s,a,h);if(d)return l(e,d,t).then(A).catch(e=>{p&&p(e)}),()=>{};let g=nU({collection:t,path:e,fields:r});return(0,t5.cf)(f,{next:t=>{A(t.docs.map(t=>i(t,e,g)))},error:p})},[n,l]),fetchEntity:(0,s.useCallback)(({path:e,entityId:t,collection:r})=>o(e,t,r),[o]),listenEntity:(0,s.useCallback)(({path:t,entityId:n,collection:o,onUpdate:l,onError:a})=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let s=(0,t5.ad)(e);return(0,t5.cf)((0,t5.JU)(s,t,n),{next:e=>{let n=nU({collection:o,path:t,entityId:e.id,fields:r});l(i(e,t,n))},error:a})},[e]),saveEntity:(0,s.useCallback)(({path:t,entityId:i,values:n,collection:o,status:l})=>{let a;if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let s=(0,t5.ad)(e),d=nU({collection:o,path:t,entityId:i,fields:r}).properties,c=(0,t5.hJ)(s,t),u=l6(n,s),A=function({inputValues:e,properties:t,status:r,timestampNowValue:i,setDateToMidnight:n}){return function e(t,r,i){let n=Object.entries(r).map(([r,n])=>{let o=t&&t[r],l=function t(r,i,n){let o;if("map"===i.dataType&&i.properties)o=e(r,i.properties,n);else if("array"===i.dataType){if(i.of&&Array.isArray(r))o=r.map(e=>t(e,i.of,n));else if(i.oneOf&&Array.isArray(r)){let e=i.oneOf?.typeField??ib,l=i.oneOf?.valueField??iZ;o=r.map(r=>{if(null===r)return null;if("object"!=typeof r)return r;let o=r[e],a=i.oneOf?.properties[o];return o&&a?{[e]:o,[l]:t(r[l],a,n)}:r})}else o=r}else o=n(r,i);return o}(o,n,i);if(void 0!==l)return{[r]:l}}).reduce((e,t)=>({...e,...t}),{}),o={...t,...n};if(0!==Object.keys(o).length)return o}(e,t,(e,t)=>{if("date"!==t.dataType)return e;{let o;return o="existing"===r&&"on_update"===t.autoValue||("new"===r||"copy"===r)&&("on_update"===t.autoValue||"on_create"===t.autoValue)?i:e,"date"===t.mode&&(o=n(o)),o}})??{}}({inputValues:u,properties:d,status:l,timestampNowValue:(0,t5.Bt)(),setDateToMidnight:l3});return console.debug("Saving entity",t,i,A),a=i?(0,t5.JU)(c,i):(0,t5.JU)(c),(0,t5.pl)(a,A,{merge:!0}).then(()=>({id:a.id,path:t,values:l8(A)}))},[e]),deleteEntity:(0,s.useCallback)(({entity:t})=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let r=(0,t5.ad)(e);return(0,t5.oe)((0,t5.JU)(r,t.path,t.id))},[e]),checkUniqueField:(0,s.useCallback)((t,r,i,n,o)=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let l=(0,t5.ad)(e);if(console.debug("Check unique field entity",t,r,i,o),"array"===n.dataType&&console.error("checkUniqueField received an array"),null==i)return Promise.resolve(!0);let a=(0,t5.IO)((0,t5.hJ)(l,t),(0,t5.ar)(r,"==",i));return(0,t5.PL)(a).then(e=>0===e.docs.filter(e=>e.id!==o).length)},[e]),generateEntityId:(0,s.useCallback)(t=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let r=(0,t5.ad)(e);return(0,t5.JU)((0,t5.hJ)(r,t)).id},[e]),countEntities:(0,s.useCallback)(async t=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");let r=(0,t5.ad)(e),i=t.collection.collectionGroup?(0,t5.B$)(r,t.path):(0,t5.hJ)(r,t.path);return(await (0,t5.Yp)(i)).data().count},[e])}}({firebaseApp:I,textSearchController:c,fields:k}),V=function({firebaseApp:e}){let[t,r]=(0,s.useState)();(0,s.useEffect)(()=>{e&&r((0,t3.cF)(e))},[e]);let i={};return{uploadFile({file:e,fileName:r,path:i,metadata:n}){if(!t)throw Error("useFirebaseStorageSource Firebase not initialised");let o=r??e.name;return console.debug("Uploading file",o,e,i,n),(0,t3.KV)((0,t3.iH)(t,`${i}/${o}`),e,n).then(e=>({path:e.ref.fullPath}))},async getDownloadURL(e){if(!t)throw Error("useFirebaseStorageSource Firebase not initialised");if(i[e])return i[e];let r=(0,t3.iH)(t,e),[n,o]=await Promise.all([(0,t3.Jt)(r),(0,t3.sd)(r)]),l={url:n,metadata:o};return i[e]=l,l}}}({firebaseApp:I}),{authLoading:z,canAccessMainView:Y,notAllowedError:G}=function({authController:e,authentication:t,getAppCheckToken:r,appCheckForceRefresh:i=!1,storageSource:n,dataSource:o}){let l=!!t,[a,d]=(0,s.useState)(l),[c,u]=(0,s.useState)(!1),[A,p]=(0,s.useState)(!l||!!e.loginSkipped),h=A&&(!l||!!e.user||!!e.loginSkipped)&&!c;(0,s.useEffect)(()=>{e.loginSkipped&&p(!0)},[e.loginSkipped]);let f=(0,s.useRef)(),g=(0,s.useCallback)(async()=>{if(e.initialLoading)return;if(!e.user&&!e.loginSkipped){f.current=void 0,d(!1),p(!1);return}let l=e.user;if(r)try{await r(i)?console.debug("App Check success."):(u("App Check failed."),e.signOut())}catch(t){u(t.message),e.signOut()}if(t instanceof Function&&l&&!eY()(f.current,l)){d(!0);try{await t({user:l,authController:e,dataSource:o,storageSource:n})||(e.signOut(),u(!0))}catch(t){u(t),e.signOut()}d(!1),p(!0),f.current=l}else d(!1);e.initialLoading||l||p(!0)},[e,t,r,i,o,n]);return(0,s.useEffect)(()=>{g()},[g]),{canAccessMainView:h,authLoading:l&&a,notAllowedError:c,authVerified:A}}({authController:P,authentication:o,getAppCheckToken:D,appCheckForceRefresh:!!f&&!!f.forceRefresh&&f.forceRefresh,dataSource:T,storageSource:V}),O=function(){let e=(0,K.Z)("(prefers-color-scheme: dark)"),t=(null!=localStorage.getItem("prefers-dark-mode")?"true"===localStorage.getItem("prefers-dark-mode"):null)??e,[r,i]=(0,s.useState)(t?"dark":"light");(0,s.useEffect)(()=>{i(t?"dark":"light"),l(t?"dark":"light")},[t]);let n=(0,s.useCallback)(()=>{i("dark"),l("dark")},[e]),o=(0,s.useCallback)(()=>{i("light"),l("light")},[]),l=(0,s.useCallback)(e=>{document.body.style.setProperty("color-scheme",e)},[document]),a=(0,s.useCallback)(()=>{"light"===r?(e?localStorage.removeItem("prefers-dark-mode"):localStorage.setItem("prefers-dark-mode","true"),n()):(e?localStorage.setItem("prefers-dark-mode","false"):localStorage.removeItem("prefers-dark-mode"),o())},[r,e]);return{mode:r,setMode:i,toggleMode:a}}(),W=(0,s.useMemo)(()=>lJ({mode:O.mode,primaryColor:g,secondaryColor:m,fontFamily:y}),[y,O.mode,g,m]);return R?(0,i.tZ)(lD,{fullScreen:!0,children:R}):F||!I||Q?(0,i.BX)(i.HY,{children:[(0,i.tZ)(ex.ZP,{}),(0,i.tZ)(oR,{})]}):(0,i.tZ)(eB.VK,{basename:x,children:(0,i.tZ)(l4,{children:(0,i.tZ)(ri,{value:O,children:(0,i.tZ)(lX,{collections:a,views:d,authController:P,userConfigPersistence:M,collectionOverrideHandler:l,dateTimeFormat:b,dataSource:T,storageSource:V,entityLinkBuilder:({entity:e})=>`https://console.firebase.google.com/project/${I.options.projectId}/firestore/data/${e.path}/${e.id}`,locale:Z,basePath:x,baseCollectionPath:w,onAnalyticsEvent:B,plugins:E,fields:k,children:({context:o,loading:l})=>{let a;if(l||z)a=(0,i.tZ)(oR,{});else{let o="dark"===O.mode&&r?r:t;a=Y?(0,i.BX)(lT,{name:e,logo:o,toolbarExtraWidget:n,autoOpenDrawer:S,children:[(0,i.tZ)(lK,{HomePage:v}),(0,i.tZ)(lc,{})]}):(0,i.tZ)(C??aa,{logo:o,allowSkipLogin:u,signInOptions:A??aA,firebaseApp:I,authController:P,notAllowedError:G})}return(0,i.BX)(ew.Z,{theme:W,children:[(0,i.tZ)(ex.ZP,{enableColorScheme:!0}),a]})}})})})})}}}]);